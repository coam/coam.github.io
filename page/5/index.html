<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>商运物流</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description">
<meta property="og:type" content="website">
<meta property="og:title" content="商运物流">
<meta property="og:url" content="https://coam.co/page/5/index.html">
<meta property="og:site_name" content="商运物流">
<meta property="og:description">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="商运物流">
<meta name="twitter:description">
  
    <link rel="alternative" href="/atom.xml" title="商运物流" type="application/atom+xml">
  
  
    <link rel="icon" href="/img/favicon.png">
  
  
  <link rel="stylesheet" href="//cdn.bootcss.com/animate.css/3.5.0/animate.min.css" type="text/css">
  
  <link rel="stylesheet" href="/css/style.css" type="text/css">
  <link rel="stylesheet" href="/font-awesome/css/font-awesome.min.css">
  <link rel="apple-touch-icon" href="/apple-touch-icon.png">
  
    
    
  
  
      <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
  
  <script>
      var yiliaConfig = {
          fancybox: true,
          animate: true,
          isHome: true,
          isPost: false,
          isArchive: false,
          isTag: false,
          isCategory: false,
          open_in_new: false
      }
  </script>
</head>
<body>
  <div id="container">
    <div class="left-col">
    <div class="overlay"></div>
<div class="intrude-less">
    <header id="header" class="inner">
        <a href="/" class="profilepic">
            
            <img lazy-src="/img/author.jpg" class="js-avatar">
            
        </a>

        <hgroup>
          <h1 class="header-author"><a href="/">张亚飞</a></h1>
        </hgroup>

        
                


        
            <div id="switch-btn" class="switch-btn">
                <div class="icon">
                    <div class="icon-ctn">
                        <div class="icon-wrap icon-house" data-idx="0">
                            <div class="birdhouse"></div>
                            <div class="birdhouse_holes"></div>
                        </div>
                        <div class="icon-wrap icon-ribbon hide" data-idx="1">
                            <div class="ribbon"></div>
                        </div>
                        
                        <div class="icon-wrap icon-link hide" data-idx="2">
                            <div class="loopback_l"></div>
                            <div class="loopback_r"></div>
                        </div>
                        
                        
                        <div class="icon-wrap icon-me hide" data-idx="3">
                            <div class="user"></div>
                            <div class="shoulder"></div>
                        </div>
                        
                    </div>
                    
                </div>
                <div class="tips-box hide">
                    <div class="tips-arrow"></div>
                    <ul class="tips-inner">
                        <li>菜单</li>
                        <li>标签</li>
                        
                        <li>友情链接</li>
                        
                        
                        <li>关于我</li>
                        
                    </ul>
                </div>
            </div>
        

        <div id="switch-area" class="switch-area">
            <div class="switch-wrap">
                <section class="switch-part switch-part1">
                    <nav class="header-menu">
                        <ul>
                        
                            <li><a href="/">主页</a></li>
                        
                            <li><a href="/archives/">所有文章</a></li>
                        
                            <li><a href="/tags/">标签云</a></li>
                        
                            <li><a href="/about/">关于我</a></li>
                        
                        </ul>
                    </nav>
                    <nav class="header-nav">
                        <ul class="social">
                            
                                <li id="Email"><a class="Email" target="_blank" href="mailto:zyf@lonal.com" title="Email"></a></li>
                            
                                <li id="GitHub"><a class="GitHub" target="_blank" href="https://github.com/zyfmix" title="GitHub"></a></li>
                            
                                <li id="RSS"><a class="RSS" target="_blank" href="/atom.xml" title="RSS"></a></li>
                            
                        </ul>
                    </nav>
                </section>
                
                
                <section class="switch-part switch-part2">
                    <div class="widget tagcloud" id="js-tagcloud">
                        <a href="/tags/hexo/" style="font-size: 20px;">hexo</a> <a href="/tags/markdown-gfw-hexo-jekyll/" style="font-size: 10px;">markdown gfw hexo jekyll</a>
                    </div>
                </section>
                
                
                
                <section class="switch-part switch-part3">
                    <div id="js-friends">
                    
                      <a target="_blank" class="main-nav-link switch-friends-link" href="https://coam.co">商运物流</a>
                    
                      <a target="_blank" class="main-nav-link switch-friends-link" href="https://github.com/zyfmix/">GitHub</a>
                    
                      <a target="_blank" class="main-nav-link switch-friends-link" href="https://wp.iirii.com/">商运技术博客</a>
                    
                    </div>
                </section>
                

                
                
                <section class="switch-part switch-part4">
                
                    <div id="js-aboutme">专注于物流设计</div>
                </section>
                
            </div>
        </div>
    </header>                
</div>
    </div>
    <div class="mid-col">
      <nav id="mobile-nav">
      <div class="overlay">
          <div class="slider-trigger"></div>
          <h1 class="header-author js-mobile-header hide"><a href="/" title="回到主页">张亚飞</a></h1>
      </div>
    <div class="intrude-less">
        <header id="header" class="inner">
            <a href="/" class="profilepic">
                <img lazy-src="/img/author.jpg" class="js-avatar">
            </a>
            <hgroup>
              <h1 class="header-author"><a href="/" title="回到主页">张亚飞</a></h1>
            </hgroup>
            
            <nav class="header-menu">
                <ul>
                
                    <li><a href="/">主页</a></li>
                
                    <li><a href="/archives/">所有文章</a></li>
                
                    <li><a href="/tags/">标签云</a></li>
                
                    <li><a href="/about/">关于我</a></li>
                
                <div class="clearfix"></div>
                </ul>
            </nav>
            <nav class="header-nav">
                        <ul class="social">
                            
                                <li id="Email"><a class="Email" target="_blank" href="mailto:zyf@lonal.com" title="Email"></a></li>
                            
                                <li id="GitHub"><a class="GitHub" target="_blank" href="https://github.com/zyfmix" title="GitHub"></a></li>
                            
                                <li id="RSS"><a class="RSS" target="_blank" href="/atom.xml" title="RSS"></a></li>
                            
                        </ul>
            </nav>
        </header>                
    </div>
</nav>
      <div class="body-wrap">
  
    <article id="post-PHP/Composer" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2016/01/10/PHP/Composer/" class="article-date">
      <time datetime="2016-01-10T11:41:31.000Z" itemprop="datePublished">2016-01-10</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/01/10/PHP/Composer/">Title</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <h2 id="Composer"><a href="#Composer" class="headerlink" title="Composer"></a>Composer</h2><p><a href="http://www.phpcomposer.com/" target="_blank" rel="external">Composer 中文网</a><br><a href="http://rivsen.github.io/post/how-to-publish-package-to-packagist-using-github-and-composer-step-by-step/" target="_blank" rel="external">使用GitHub、Composer、Packagist管理公开的PHP包（Step By Step）</a></p>
<h3 id="Packagist_/_Composer__u4E2D_u56FD_u5168_u91CF_u955C_u50CF"><a href="#Packagist_/_Composer__u4E2D_u56FD_u5168_u91CF_u955C_u50CF" class="headerlink" title="Packagist / Composer 中国全量镜像"></a>Packagist / Composer 中国全量镜像</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">composer config -g repositories.packagist composer http://packagist.phpcomposer.com</span><br></pre></td></tr></table></figure>
<p>##</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sudo composer clearcache  <span class="comment"># 清除缓存</span></span><br><span class="line">sudo rm -r ~/.composer/cache <span class="comment"># 清除缓存</span></span><br></pre></td></tr></table></figure>
<h3 id="u4E0D_u7F16_u8F91composer-json_u7684_u60C5_u51B5_u4E0B_u5B89_u88C5_u5E93"><a href="#u4E0D_u7F16_u8F91composer-json_u7684_u60C5_u51B5_u4E0B_u5B89_u88C5_u5E93" class="headerlink" title="不编辑composer.json的情况下安装库"></a>不编辑composer.json的情况下安装库</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">composer require <span class="string">"foo/bar:1.0.0"</span></span><br></pre></td></tr></table></figure>
<h3 id="u5F3A_u5236_u4ECE_github__u514B_u9686_u6E90_u4EE3_u7801"><a href="#u5F3A_u5236_u4ECE_github__u514B_u9686_u6E90_u4EE3_u7801" class="headerlink" title="强制从 github 克隆源代码"></a>强制从 github 克隆源代码</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">composer update symfony/yaml --prefer-source</span><br></pre></td></tr></table></figure>
      
    </div>
    
    <div class="article-info article-info-index">
      
      

      
      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>








  
    <article id="post-Http/HttpNote" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2016/01/08/Http/HttpNote/" class="article-date">
      <time datetime="2016-01-08T04:28:31.000Z" itemprop="datePublished">2016-01-08</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/01/08/Http/HttpNote/">Http协议相关</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
              <h1 id="Http_u534F_u8BAE_u76F8_u5173"><a href="#Http_u534F_u8BAE_u76F8_u5173" class="headerlink" title="Http协议相关"></a>Http协议相关</h1>
          
      
    </div>
    
    <div class="article-info article-info-index">
      
      

      
      
        <p class="article-more-link">
          <a  href="/2016/01/08/Http/HttpNote/#more">more >></a>
        </p>
      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>








  
    <article id="post-Others/MarkDownNote" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2016/01/08/Others/MarkDownNote/" class="article-date">
      <time datetime="2016-01-08T02:51:31.000Z" itemprop="datePublished">2016-01-08</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/01/08/Others/MarkDownNote/">MarkDown 相关</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
              <h1 id="Markdown__u76F8_u5173_u7B14_u8BB0_u6458_u8981"><a href="#Markdown__u76F8_u5173_u7B14_u8BB0_u6458_u8981" class="headerlink" title="Markdown 相关笔记摘要"></a>Markdown 相关笔记摘要</h1><p><a href="http://www.debug4.me/%E5%B7%A5%E5%85%B7/markdown-learning/">Markdown标准语法与GitHub Flavored Markdown语法大全</a></p>
          
      
    </div>
    
    <div class="article-info article-info-index">
      
      
    <div class="article-category tagcloud">
    <a class="article-category-link" href="/categories/markdown/">markdown</a>
    </div>


      
    <div class="article-tag tagcloud">
        <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/markdown-gfw-hexo-jekyll/">markdown gfw hexo jekyll</a></li></ul>
    </div>

      
        <p class="article-more-link">
          <a  href="/2016/01/08/Others/MarkDownNote/#more">more >></a>
        </p>
      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>








  
    <article id="post-MarkDownNote" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2016/01/08/MarkDownNote/" class="article-date">
      <time datetime="2016-01-08T02:51:31.000Z" itemprop="datePublished">2016-01-08</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/01/08/MarkDownNote/">MarkDown 相关</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
              <h1 id="Markdown__u76F8_u5173_u7B14_u8BB0_u6458_u8981"><a href="#Markdown__u76F8_u5173_u7B14_u8BB0_u6458_u8981" class="headerlink" title="Markdown 相关笔记摘要"></a>Markdown 相关笔记摘要</h1><p><a href="http://www.debug4.me/%E5%B7%A5%E5%85%B7/markdown-learning/">Markdown标准语法与GitHub Flavored Markdown语法大全</a></p>
          
      
    </div>
    
    <div class="article-info article-info-index">
      
      
    <div class="article-category tagcloud">
    <a class="article-category-link" href="/categories/markdown/">markdown</a>
    </div>


      
    <div class="article-tag tagcloud">
        <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/markdown-gfw-hexo-jekyll/">markdown gfw hexo jekyll</a></li></ul>
    </div>

      
        <p class="article-more-link">
          <a  href="/2016/01/08/MarkDownNote/#more">more >></a>
        </p>
      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>








  
    <article id="post-my-blogs" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2016/01/07/my-blogs/" class="article-date">
      <time datetime="2016-01-07T12:56:16.000Z" itemprop="datePublished">2016-01-07</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/01/07/my-blogs/">my blogs</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <blockquote><p>content</p>
</blockquote>
<figure class="highlight"><figcaption><span>[title] [] [url] [link text]</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">code snippet</span><br></pre></td></tr></table></figure>
<figure class="highlight php"><figcaption><span>mycode</span><a href="https://www.coam.co" target="_blank" rel="external">coam.com</a></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span><br><span class="line"> * Build DOMDocument with standard xmpp body child node.</span><br><span class="line"> *</span><br><span class="line"> * <span class="doctag">@return</span> DOMDocument</span><br><span class="line"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">buildBody</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="variable">$xml</span> = <span class="keyword">new</span> DOMDocument(<span class="string">'1.0'</span>, <span class="string">'UTF-8'</span>);</span><br><span class="line"></span><br><span class="line">    <span class="variable">$body</span> = <span class="variable">$xml</span>-&gt;createElement(<span class="string">'body'</span>);</span><br><span class="line">    <span class="variable">$xml</span>-&gt;appendChild(<span class="variable">$body</span>);</span><br><span class="line"></span><br><span class="line">    <span class="variable">$body</span>-&gt;appendChild(<span class="keyword">self</span>::getNewTextAttribute(<span class="variable">$xml</span>, <span class="string">'xmlns'</span>, <span class="keyword">self</span>::XMLNS_BODY));</span><br><span class="line">    <span class="variable">$body</span>-&gt;appendChild(<span class="keyword">self</span>::getNewTextAttribute(<span class="variable">$xml</span>, <span class="string">'content'</span>, <span class="keyword">self</span>::CONTENT_TYPE));</span><br><span class="line">    <span class="variable">$body</span>-&gt;appendChild(<span class="keyword">self</span>::getNewTextAttribute(<span class="variable">$xml</span>, <span class="string">'rid'</span>, <span class="variable">$this</span>-&gt;getAndIncrementRid()));</span><br><span class="line">    <span class="variable">$body</span>-&gt;appendChild(<span class="keyword">self</span>::getNewTextAttribute(<span class="variable">$xml</span>, <span class="string">'xml:lang'</span>, <span class="keyword">self</span>::XML_LANG));</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (<span class="variable">$this</span>-&gt;sid != <span class="string">''</span>) &#123;</span><br><span class="line">        <span class="variable">$body</span>-&gt;appendChild(<span class="keyword">self</span>::getNewTextAttribute(<span class="variable">$xml</span>, <span class="string">'sid'</span>, <span class="variable">$this</span>-&gt;sid));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="variable">$xml</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight javascript"><figcaption><span>title</span><a href="https://app.coopens.com" target="_blank" rel="external">link</a></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">onMessage</span>(<span class="params">msg</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> to = msg.getAttribute(<span class="string">'to'</span>);</span><br><span class="line">    <span class="keyword">var</span> from = msg.getAttribute(<span class="string">'from'</span>);</span><br><span class="line">    <span class="keyword">var</span> type = msg.getAttribute(<span class="string">'type'</span>);</span><br><span class="line">    <span class="keyword">var</span> elems = msg.getElementsByTagName(<span class="string">'body'</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (type == <span class="string">"chat"</span> &amp;&amp; elems.length &gt; <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="keyword">var</span> body = elems[<span class="number">0</span>];</span><br><span class="line"></span><br><span class="line">        log(<span class="string">'ECHOBOT: I got a message from '</span> + from + <span class="string">': '</span> +</span><br><span class="line">            Strophe.getText(body));</span><br><span class="line"></span><br><span class="line">        <span class="keyword">var</span> reply = $msg(&#123;to: from, from: to, type: <span class="string">'chat'</span>&#125;)</span><br><span class="line">            .cnode(Strophe.copyElement(body));</span><br><span class="line">        connection.send(reply.tree());</span><br><span class="line"></span><br><span class="line">        log(<span class="string">'ECHOBOT: I sent '</span> + from + <span class="string">': '</span> + Strophe.getText(body));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// we must return true to keep the handler alive.  </span></span><br><span class="line">    <span class="comment">// returning false would remove it after it finishes.</span></span><br><span class="line">    <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight java"><figcaption><span>Android SDK 代码</span><a href="http://www.badu.com" target="_blank" rel="external">[link text ..]</a></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> android.content.Context;</span><br><span class="line"><span class="keyword">import</span> android.content.Intent;</span><br><span class="line"><span class="keyword">import</span> android.preference.Preference;</span><br><span class="line"><span class="keyword">import</span> android.util.AttributeSet;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> eu.siacs.conversations.utils.PhoneHelper;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">AboutPreference</span> <span class="keyword">extends</span> <span class="title">Preference</span> </span>&#123;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="title">AboutPreference</span><span class="params">(<span class="keyword">final</span> Context context, <span class="keyword">final</span> AttributeSet attrs, <span class="keyword">final</span> <span class="keyword">int</span> defStyle)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">super</span>(context, attrs, defStyle);</span><br><span class="line">		setSummary();</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="title">AboutPreference</span><span class="params">(<span class="keyword">final</span> Context context, <span class="keyword">final</span> AttributeSet attrs)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">super</span>(context, attrs);</span><br><span class="line">		setSummary();</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">    <span class="annotation">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">onClick</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>.onClick();</span><br><span class="line">        <span class="keyword">final</span> Intent intent = <span class="keyword">new</span> Intent(getContext(), AboutActivity.class);</span><br><span class="line">        getContext().startActivity(intent);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">setSummary</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		setSummary(<span class="string">"Conversations "</span> + PhoneHelper.getVersionName(getContext()));</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">happy</span><br></pre></td></tr></table></figure>
<figure class="highlight livecodeserver"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="constant">colon</span></span><br></pre></td></tr></table></figure>
<figure class="highlight java"><figcaption><span>title</span><a href="http://www.coopens.com" target="_blank" rel="external">link</a></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">setSummary</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    setSummary(<span class="string">"Conversations "</span> + PhoneHelper.getVersionName(getContext()));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
      
    </div>
    
    <div class="article-info article-info-index">
      
      

      
      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>








  
    <article id="post-Server/Config/Server/ServerDisasterBackup" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2016/01/07/Server/Config/Server/ServerDisasterBackup/" class="article-date">
      <time datetime="2016-01-07T09:59:14.229Z" itemprop="datePublished">2016-01-07</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <h2 id="u670D_u52A1_u5668_u707E_u5907_u91CD_u5EFA_u5E94_u6025_u5904_u7406_u5907_u5FD8_u5F55_-__u670D_u52A1_u5668_u65E5_u5E38_u7EF4_u62A4_u53CA_u5907_u4EFD_u4E8B_u9879"><a href="#u670D_u52A1_u5668_u707E_u5907_u91CD_u5EFA_u5E94_u6025_u5904_u7406_u5907_u5FD8_u5F55_-__u670D_u52A1_u5668_u65E5_u5E38_u7EF4_u62A4_u53CA_u5907_u4EFD_u4E8B_u9879" class="headerlink" title="服务器灾备重建应急处理备忘录 - 服务器日常维护及备份事项"></a>服务器灾备重建应急处理备忘录 - 服务器日常维护及备份事项</h2><hr>
<h3 id="u4E00_u3001_u5B89_u88C5php_u6269_u5C55_2C_u4E0D_u4EC5_u4E0D_u8981_u5728_/etc/php5/fpm__u4E0B_u5B89_u88C5_u76F8_u5E94_u7684so_2C_u4E5F_u5E94_u5728_/etc/php5/cli__u91CC_u8FB9_u6DFB_u52A0so_2C_u4E24_u8005_u90FD_u53EF_u72EC_u7ACB_u8FD0_u884C_2C_u5426_u5219_u5B89_u88C5_u4E86fpm_u7684_u6269_u5C55_2C_u8FD8_u662F_u4E0D_u80FD_u627E_u5230_u76F8_u5E94_u7684_u6269_u5C55"><a href="#u4E00_u3001_u5B89_u88C5php_u6269_u5C55_2C_u4E0D_u4EC5_u4E0D_u8981_u5728_/etc/php5/fpm__u4E0B_u5B89_u88C5_u76F8_u5E94_u7684so_2C_u4E5F_u5E94_u5728_/etc/php5/cli__u91CC_u8FB9_u6DFB_u52A0so_2C_u4E24_u8005_u90FD_u53EF_u72EC_u7ACB_u8FD0_u884C_2C_u5426_u5219_u5B89_u88C5_u4E86fpm_u7684_u6269_u5C55_2C_u8FD8_u662F_u4E0D_u80FD_u627E_u5230_u76F8_u5E94_u7684_u6269_u5C55" class="headerlink" title="一、安装php扩展,不仅不要在 /etc/php5/fpm 下安装相应的so,也应在 /etc/php5/cli 里边添加so,两者都可独立运行,否则安装了fpm的扩展,还是不能找到相应的扩展."></a>一、安装php扩展,不仅不要在 /etc/php5/fpm 下安装相应的so,也应在 /etc/php5/cli 里边添加so,两者都可独立运行,否则安装了fpm的扩展,还是不能找到相应的扩展.</h3><hr>
<h3 id="u4E8C_u3001_u66F4_u65B0php5-fpm_u540E_2Cphp_u51FA_u73B0_u9519_u8BEF"><a href="#u4E8C_u3001_u66F4_u65B0php5-fpm_u540E_2Cphp_u51FA_u73B0_u9519_u8BEF" class="headerlink" title="二、更新php5-fpm后,php出现错误"></a>二、更新php5-fpm后,php出现错误</h3><pre><code>PHP Fatal error:  Class &apos;MongoClient&apos; not found in /data/home/yzhang/www/www/applications/config/Services.php on line 146
</code></pre><p>查看phpinfo发现无mongodb 扩展,错误原因为未安装php的 mongoClient drive</p>
<p>首先执行命令依次安装以下程序:</p>
<pre><code>sudo apt-get install php-pear
sudo apt-get install php5-dev
sudo pecl install mongo
</code></pre><p>安装完成之后 将以下行添加到 php.ini:</p>
<pre><code>extension=mongo.so
</code></pre><p>重启 php5-fpm 问题解决</p>
<p>参考 <a href="http://php.net/manual/zh/mongo.installation.php" target="_blank" rel="external">http://php.net/manual/zh/mongo.installation.php</a></p>
<p>参考 <a href="http://askubuntu.com/questions/403327/install-pecl-packages-on-ubuntu" target="_blank" rel="external">http://askubuntu.com/questions/403327/install-pecl-packages-on-ubuntu</a></p>
<p>重启 nginx php5-fpm</p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      

      
      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>








  
    <article id="post-Server/Config/Nginx/Other/waf/README" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2016/01/07/Server/Config/Nginx/Other/waf/README/" class="article-date">
      <time datetime="2016-01-07T09:59:14.202Z" itemprop="datePublished">2016-01-07</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <p>##ngx_lua_waf</p>
<p>ngx_lua_waf是我刚入职趣游时候开发的一个基于ngx_lua的web应用防火墙.</p>
<p>代码很简单,开发初衷主要是使用简单,高性能和轻量级.</p>
<p>现在开源出来,遵从MIT许可协议.其中包含我们的过滤规则.如果大家有什么建议和想fa,欢迎和我一起完善.</p>
<p>###用途:</p>
<pre><code>防止sql注入,本地包含,部分溢出,fuzzing测试,xss,SSRF等web攻击
防止svn/备份之类文件泄漏
防止ApacheBench之类压力测试工具的攻击
屏蔽常见的扫描黑客工具,扫描器
屏蔽异常的网络请求
屏蔽图片附件类目录php执行权限
防止webshell上传
</code></pre><p>###推荐安装:</p>
<p>推荐使用lujit2.1做lua支持</p>
<p>ngx_lua如果是0.9.2以上版本,建议正则过滤函数改为ngx.re.find,匹配效率会提高三倍左右.</p>
<p>###使用说明:</p>
<p>nginx安装路径假设为:/usr/local/nginx/conf/</p>
<p>把ngx_lua_waf下载到conf目录下,解压命名为waf</p>
<p>在nginx.conf的http段添加</p>
<pre><code>lua_package_path &quot;/usr/local/nginx/conf/waf/?.lua&quot;;
lua_shared_dict limit 10m;
init_by_lua_file  /usr/local/nginx/conf/waf/init.lua; 
access_by_lua_file /usr/local/nginx/conf/waf/waf.lua;
</code></pre><p>配置config.lua里的waf规则目录(一般在waf/conf/目录下)</p>
<pre><code>RulePath = &quot;/usr/local/nginx/conf/waf/wafconf/&quot;
</code></pre><p>绝对路径如有变动,需对应修改</p>
<p>然后重启nginx即可</p>
<p>###配置文件详细说明:</p>
<pre><code>RulePath = &quot;/usr/local/nginx/conf/waf/wafconf/&quot;
--规则存放目录
attacklog = &quot;off&quot;
--是否开启攻击信息记录,需要配置logdir
logdir = &quot;/usr/local/nginx/logs/hack/&quot;
--log存储目录,该目录需要用户自己新建,切需要nginx用户的可写权限
UrlDeny=&quot;on&quot;
--是否拦截url访问
Redirect=&quot;on&quot;
--是否拦截后重定向
CookieMatch = &quot;on&quot;
--是否拦截cookie攻击
postMatch = &quot;on&quot; 
--是否拦截post攻击
whiteModule = &quot;on&quot; 
--是否开启URL白名单
black_fileExt={&quot;php&quot;,&quot;jsp&quot;}
--填写可上传文件后缀类型
ipWhitelist={&quot;127.0.0.1&quot;}
--ip白名单,多个ip用逗号分隔
ipBlocklist={&quot;1.0.0.1&quot;}
--ip黑名单,多个ip用逗号分隔
CCDeny=&quot;on&quot;
--是否开启拦截cc攻击(需要nginx.conf的http段增加lua_shared_dict limit 10m;)
CCrate = &quot;100/60&quot;
--设置cc攻击频率,单位为秒.
--默认1分钟同一个IP只能请求同一个地址100次
html=[[Please go away~~]]
--警告内容,可在中括号内自定义
备注:不要乱动双引号,区分大小写
</code></pre><p>###检查规则是否生效</p>
<p>部署完毕可以尝试如下命令:        </p>
<pre><code>curl http://xxxx/test.php?id=../etc/passwd
返回&quot;Please go away~~&quot;字样,说明规则生效.
</code></pre><p>注意:默认,本机在白名单不过滤,可自行调整config.lua配置</p>
<p>###效果图如下:</p>
<p><img src="http://i.imgur.com/wTgOcm2.png" alt="sec"></p>
<p><img src="http://i.imgur.com/DqU30au.png" alt="sec"></p>
<p>###规则更新:</p>
<p>考虑到正则的缓存问题,动态规则会影响性能,所以暂没用共享内存字典和redis之类东西做动态管理.</p>
<p>规则更新可以把规则文件放置到其他服务器,通过crontab任务定时下载来更新规则,nginx reload即可生效.以保障ngx lua waf的高性能.</p>
<p>只记录过滤日志,不开启过滤,在代码里在check前面加上–注释即可,如果需要过滤,反之</p>
<p>###一些说明:</p>
<pre><code>过滤规则在wafconf下,可根据需求自行调整,每条规则需换行,或者用|分割

    global是全局过滤文件,里面的规则对post和get都过滤        
    get是只在get请求过滤的规则        
    post是只在post请求过滤的规则        
    whitelist是白名单,里面的url匹配到不做过滤        
    user-agent是对user-agent的过滤规则


默认开启了get和post过滤,需要开启cookie过滤的,编辑waf.lua取消部分--注释即可

日志文件名称格式如下:虚拟主机名_sec.log
</code></pre><h2 id="Copyright"><a href="#Copyright" class="headerlink" title="Copyright"></a>Copyright</h2><table><br>  <tr><br>    <td>Weibo</td><td>神奇的魔法师</td><br>  </tr><br>  <tr><br>    <td>Forum</td><td><a href="http://bbs.linuxtone.org/" target="_blank" rel="external">http://bbs.linuxtone.org/</a></td><br>  </tr><br>  <tr><br>    <td>Copyright</td><td>Copyright (c) 2013- loveshell</td><br>  </tr><br>  <tr><br>    <td>License</td><td>MIT License</td><br>  </tr><br></table>

<p>感谢ngx_lua模块的开发者<a href="https://github.com/agentzh/" target="_blank" rel="external">@agentzh</a>,春哥是我所接触过开源精神最好的人</p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      

      
      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>








  
    <article id="post-Server/Nginx" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2016/01/07/Server/Nginx/" class="article-date">
      <time datetime="2016-01-07T09:59:14.186Z" itemprop="datePublished">2016-01-07</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <h2 id="Nginx__u5B89_u88C5_u7BA1_u7406_u76F8_u5173"><a href="#Nginx__u5B89_u88C5_u7BA1_u7406_u76F8_u5173" class="headerlink" title="Nginx 安装管理相关"></a>Nginx 安装管理相关</h2><p><a href="http://nginx.org/" target="_blank" rel="external">NGINX官网</a><br><a href="https://www.king.moe/posts/Ubuntu%20Server%20%E7%BC%96%E8%AF%91%E5%AE%89%E8%A3%85%20Nginx" target="_blank" rel="external">Ubuntu Server 编译安装 Nginx</a><br><a href="https://www.imququ.com/post/my-nginx-conf-for-wpo.html" target="_blank" rel="external">Nginx 配置之性能篇</a></p>
<p>ubuntu下使用apt方式安装、卸载nginx–更新nginx源安装最新版<br>1、添加升级源,把 nginx 团队官方的 PPA 加入到 apt-get 的源配置文件中,并更新源</p>
<pre><code>add-apt-repository ppa:nginx/stable
</code></pre><p>如果提示找不到 add-apt-repository</p>
<pre><code>apt-get install python-software-properties -y
apt-get update
</code></pre><p>2、更新nginx</p>
<pre><code>apt-get upgrade nginx -y
nginx -v
</code></pre><p>3、重启nginx</p>
<pre><code>kill -9 `pidof nginx`
/etc/init.d/nginx restart
</code></pre><p>安装nginx后,卸载不完整,使用源码安装最新nginx,一直不通过,卸载nginx的方法:</p>
<pre><code>sudo apt-get --purge remove nginx
sudo apt-get autoremove
dpkg --get-selections|grep nginx
</code></pre><p>列出与nginx相关的软件:</p>
<pre><code>nginx-common deinstall
</code></pre><p>然后</p>
<pre><code>sudo apt-get --purge remove nginx-common
</code></pre><p>这样就可以完全卸载掉nginx包括配置文件</p>
<p>///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////</p>
<pre><code>sudo apt-get remove nginx nginx-common # Removes all but config files.
sudo apt-get purge nginx nginx-common # Removes everything.
sudo apt-get autoremove # After using any of the above commands, use this in order to remove dependencies used by nginx which are no longer required.
</code></pre><p>参考 <a href="http://askubuntu.com/questions/235347/what-is-the-best-way-to-uninstall-nginx" target="_blank" rel="external">http://askubuntu.com/questions/235347/what-is-the-best-way-to-uninstall-nginx</a></p>
<p>//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////</p>
<p>Nginx 配置 SSL 证书相关</p>
<p>关于 OCSP 配置相关</p>
<pre><code>ssl_stapling on;
ssl_stapling_verify on;
ssl_trusted_certificate /you/path/to/domain.chain.pem;
resolver 8.8.8.8 8.8.4.4 valid=300s;(国外)
resolver 223.5.5.5 223.6.6.6 valid=300s;(国内)
resolver_timeout 10s;
</code></pre><p>使用如下命令测试 ocsp 状态</p>
<pre><code>openssl s_client -connect coopens.com:443 -tls1 -tlsextdebug -status
openssl ocsp -issuer chain.pem -cert cert.pem -text -url http://ocsp.int-x1.letsencrypt.org -header &quot;HOST&quot; &quot;ocsp.int-x1.letsencrypt.org&quot; -no_nonce
openssl ocsp -no_nonce \
-header Host ocsp.int-x1.letsencrypt.org \
-url http://ocsp.int-x1.letsencrypt.org/ \
-issuer chain.pem \
-CAfile chain.pem \
-cert cert.pem
</code></pre><p>关于 ocsp 根证书配置</p>
<pre><code>cat fullchain.pem /data/home/yzhang/Homg/Documents/Server/Config/Nginx/Certify/dst_root.pem &gt; rootchain.pem
</code></pre><p>其中 fullchain.pem 为当前网站的 证书链,dst_root.pem 为 letsencrypt 根证书 ,更新了 OCSP 证书之后需要测试两次,否则查看 ocsp 缓存失败<br>参考<a href="https://github.com/letsencrypt/letsencrypt/issues/1813" target="_blank" rel="external">Nginx OCSP stapling ssl_trusted_certificate #1813</a></p>
<p>ssl_trusted_certificate 是用来验证ocsp响应的各个ca证书+中级证书,和信任的ca根证书列表.当用来验证ocsp响应的时候,应该配置为你的ca根证书+和中级ca证书的列表,此处可以简单和ssl_certificate使用同一个证书列表文件.</p>
<pre><code>[[Solved] Cannot verify ocsp](https://community.letsencrypt.org/t/solved-cannot-verify-ocsp/3306)
[Unable to verify OCSP response](https://community.letsencrypt.org/t/unable-to-verify-ocsp-response/7264)
</code></pre><p>配置 ssl_dhparam 提高ssl证书加密安全系数</p>
<p>使用如下命令生成 4096 位的 dhparam.pem 加密密钥</p>
<pre><code>openssl dhparam -out dhparam.pem 4096
</code></pre><p>配置 HTTP 严格传输安全(HSTS)(HTTP Strict Transport Security)</p>
<p>nginx server{} 段添加如下响应头</p>
<pre><code>add_header Strict-Transport-Security max-age=15768000;
</code></pre><p>配置 ssl_session_ticket_key</p>
<pre><code>#ssl_session_ticket_key /etc/nginx/conf.d/tls_session_ticket.key;
ssl_session_tickets on;
</code></pre><p>其中 tls_session_ticket.key 可以按如下方式生成 (参考 <a href="https://blog.helong.info/blog/2015/05/08/https-config-optimize-in-nginx" target="_blank" rel="external">Nginx下配置高性能,高安全性的https TLS服务</a>)</p>
<pre><code>openssl rand 48 &gt; tls_session_ticket.key
</code></pre><p>使用 <a href="https://www.ssllabs.com/ssltest/analyze.html?d=coopens.com" target="_blank" rel="external">https://www.ssllabs.com/ssltest/analyze.html?d=coopens.com</a> 检测 网站证书安全性</p>
<p><a href="https://mozilla.github.io/server-side-tls/ssl-config-generator/" target="_blank" rel="external">Mozilla 查看最新推荐 Nginx 配置项</a><br><a href="https://www.pupboss.com/nginx-add-ssl/" target="_blank" rel="external">Nginx 配置上更安全的 SSL &amp; ECC 证书</a></p>
<p><a href="https://bbs.wosign.com/thread-1923-1-1.html" target="_blank" rel="external">HTTPS协议介绍—使用Nginx+SSL实现部署与性能优化</a><br><a href="http://songchenwen.com/tech/2015/09/09/nginx-configuration-with-ssl-labs-class-a-plus/" target="_blank" rel="external">SSL Labs 评分 A+ 的 nginx 配置</a><br><a href="https://blog.hinablue.me/entry/bi-ji-ssl-nginx-hsts-spdy-breach-fips-ocsp-stapling/" target="_blank" rel="external">SSL, Nginx, HSTS, SPDY, BREACH, FIPS, OCSP Stapling</a></p>
<p>//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////</p>
<p>Nginx相关</p>
<p><a href="http://seanlook.com/2015/05/17/nginx-location-rewrite/" target="_blank" rel="external">nginx配置location总结及rewrite规则写法</a><br><a href="https://www.gehaowu.com/notes/2015/08/NGINXHTTP2/" target="_blank" rel="external">为 NGINX 开启 HTTP2 功能</a><br><a href="https://imququ.com/post/nginx-http2-patch.html" target="_blank" rel="external">Nginx 开始支持 HTTP/2 了</a><br>[HTTP2 on Nginx 測試] (<a href="https://blog.hinablue.me/entry/http2-on-nginx-ce-shi/" target="_blank" rel="external">https://blog.hinablue.me/entry/http2-on-nginx-ce-shi/</a>)</p>
<p>Nginx 变量相关</p>
<p><a href="http://note.axiaoxin.com/contents/nginx-variables-note.html" target="_blank" rel="external">Nginx配置-变量笔记</a><br><a href="https://moonbingbing.gitbooks.io/openresty-best-practices/content/openresty/inline_var.html" target="_blank" rel="external">获取Nginx内置绑定变量</a><br><a href="http://www.cnphp.info/nginx-embedded-variables-lasted-version.html" target="_blank" rel="external">最新版 nginx内置变量 大全</a></p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      

      
      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>








  
    <article id="post-Server/PHP" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2016/01/07/Server/PHP/" class="article-date">
      <time datetime="2016-01-07T09:59:14.160Z" itemprop="datePublished">2016-01-07</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <h3 id="PHP__u7BA1_u7406"><a href="#PHP__u7BA1_u7406" class="headerlink" title="PHP 管理"></a>PHP 管理</h3><p><a href="http://www.php.net" target="_blank" rel="external">php.net</a></p>
<h3 id="PHP5__u5B89_u88C5_u76F8_u5173"><a href="#PHP5__u5B89_u88C5_u76F8_u5173" class="headerlink" title="PHP5 安装相关"></a>PHP5 安装相关</h3><p>安装完nginx后,可以进一步安装php</p>
<pre><code>sudo apt-get install php5-fpm
sudo apt-get install php5-cli # Makes the php5 command available to the terminal for php5 scripting
sudo apt-get install php5-common # php5-common 貌似根据依赖自动安装了
sudo apt-get install php5-dev # phpize 运行工具
sudo apt-get install php-apc # apc
sudo apt-get install php5-intl # intl php国际化支持
sudo apt-get install php5-gd # Popular image manipulation library; used extensively by Wordpress and it&apos;s plugins.
sudo apt-get install php5-curl # Allows curl (file downloading tool) to be called from PHP5
sudo apt-get install php-pear # Allows curl (file downloading tool) to be called from PHP5
sudo apt-get install php5-mcrypt # Provides encryption algorithms to PHP scripts
sudo apt-get install php5-mysql # Allows PHP5 scripts to talk to a MySQL Database
sudo apt-get install php5-readline # Allows PHP5 scripts to use the readline function
</code></pre><p>安装参考</p>
<pre><code>apt-get install nginx mysql-client mysql-server memcached php5-common php5-dev php5-cgi php5-fpm php-apc php5-mysql php5-pgsql php5-sqlite php5-curl php5-gd php5-intl php-pear php5-mcrypt php5-memcache php5-ming php5-recode php5-tidy php5-xmlrpc php5-xsl php5-mcrypt php5-imap
</code></pre><p>查看php5运行进程</p>
<pre><code>ps -waux | grep php5
</code></pre><p>打开关闭 php5 进程</p>
<pre><code>sudo service php5-fpm stop
sudo service php5-fpm start
sudo service php5-fpm restart
sudo service php5-fpm status
</code></pre><p>配置php5监听端口 /etc/php5/fpm/pool.d/www.conf 修改为</p>
<pre><code># listen = /var/run/php5-fpm.sock 
listen = 127.0.0.1:9000
</code></pre><p>重新运行php进程</p>
<p>参考列表</p>
<p><a href="http://www.cnblogs.com/Bonker/p/4252588.html" target="_blank" rel="external">ubuntu14.04 +nginx+php5-fpm</a><br><a href="http://www.xingzhewujiang.com/press/apt-get-nginx-mysql-php-on-ubuntu.html" target="_blank" rel="external">在Ubuntu上使用apt-get安装Nginx、MySQL、PHP5环境</a><br><a href="http://www.cnblogs.com/Bonker/p/4496415.html" target="_blank" rel="external">Ubuntu14.04 64bit 编译安装nginx1.7+php5.4+mysql5.6</a></p>
<hr>
<h3 id="PHP-ini__u914D_u7F6E_u76F8_u5173"><a href="#PHP-ini__u914D_u7F6E_u76F8_u5173" class="headerlink" title="PHP.ini 配置相关"></a>PHP.ini 配置相关</h3><pre><code>;listen = /run/php/php7.0-fpm.sock
listen= 127.0.0.1:9000
</code></pre><hr>
<h3 id="PHP7__u5347_u7EA7"><a href="#PHP7__u5347_u7EA7" class="headerlink" title="PHP7 升级"></a>PHP7 升级</h3><p>php5更新到最新版本 Upgrade from PHP 5.3 to PHP 5.6 on Ubuntu 12.04 LTS</p>
<p>首先确保已安装 python-software-properties 才能添加 PPA ,执行以下命令:</p>
<pre><code>sudo apt-get update
sudo apt-get install python-software-properties
</code></pre><p>添加php的最新ppa源</p>
<pre><code>sudo apt-get install -y language-pack-en-base
sudo LC_ALL=en_US.UTF-8 add-apt-repository ppa:ondrej/php-7.0
sudo apt-get update
#sudo apt-get dist-upgrade // 这步为系统全部更新,不推荐
sudo apt-get install php7.0
sudo apt-get install php7.0-common
sudo apt-get install php7.0-cli
sudo apt-get install php7.0-fpm
sudo apt-get install php7.0-curl
sudo apt-get install php7.0-sqlite3
sudo apt-get install php7.0-json
sudo apt-get install php7.0-tidy
sudo apt-get install php7.0-mysql
...
sudo apt-get install -y php7.0-common php7.0-cli php7.0-fpm php7.0-curl php7.0-sqlite3 php7.0-json php7.0-tidy php7.0-mysql
</code></pre><p>修改 /etc/nginx/sites-enabled/default 变 /var/run/php5-fpm.sock 为 /var/run/php/php7.0-fpm.sock</p>
<p>如果 nginx 监听 9000 端口,修改 /etc/php/7.0/fpm/pool.d/www.conf 为以下,并重启 服务器</p>
<pre><code>;listen = /run/php/php7.0-fpm.sock
listen= 127.0.0.1:9000
</code></pre><p>修改 /etc/php5/fpm/php.ini</p>
<pre><code>session.gc_maxlifetime = 14400
</code></pre><p>注:php7下 原来的 php5-fpm 进程已改为 php7.0-fpm</p>
<p>参考<br><a href="https://www.digitalocean.com/community/tutorials/how-to-upgrade-to-php-7-on-ubuntu-14-04" target="_blank" rel="external">How To Upgrade to PHP 7 on Ubuntu 14.04</a><br><a href="http://blog.self.li/post/134686266812/how-to-install-php-7-ubuntu-14-04-lts" target="_blank" rel="external">How to install PHP 7 on Ubuntu 14.04</a><br><a href="http://phpave.com/upgrade-php-5-3-php-5-5-ubuntu-12-04-lts/" target="_blank" rel="external">Upgrade from PHP 5.3 to PHP 5.5 on Ubuntu 12.04 LTS</a><br><a href="https://launchpad.net/~ondrej/+archive/ubuntu/php-7.0" target="_blank" rel="external">PPA for PHP 7.0 </a><br><a href="http://www.kankanews.com/ICkengine/archives/36593.shtml" target="_blank" rel="external">ubuntu下搭载LNMP环境,解决 fpm监听失败</a></p>
<hr>
<h3 id="Php__u5E38_u89C1_u95EE_u9898_u89E3_u51B3"><a href="#Php__u5E38_u89C1_u95EE_u9898_u89E3_u51B3" class="headerlink" title="Php 常见问题解决"></a>Php 常见问题解决</h3><h4 id="u670D_u52A1_u5668_u9891_u7E41_u51FA_u73B0502_u9519_u8BEF_u95EE_u9898_u5206_u6790"><a href="#u670D_u52A1_u5668_u9891_u7E41_u51FA_u73B0502_u9519_u8BEF_u95EE_u9898_u5206_u6790" class="headerlink" title="服务器频繁出现502错误问题分析"></a>服务器频繁出现502错误问题分析</h4><p><a href="http://www.we3ew.com/?p=1263" target="_blank" rel="external">参考 nginx+php-fpm出现502 bad gateway错误解决方法</a></p>
<h4 id="u5347_u7EA7_u5B8C_php__u540E_2C_u76F8_u5E94_u7684_php__u6269_u5C55_u4E5F_u5C06_u8981_u4E00_u5E76_u5B89_u88C5"><a href="#u5347_u7EA7_u5B8C_php__u540E_2C_u76F8_u5E94_u7684_php__u6269_u5C55_u4E5F_u5C06_u8981_u4E00_u5E76_u5B89_u88C5" class="headerlink" title="升级完 php 后,相应的 php 扩展也将要一并安装"></a>升级完 php 后,相应的 php 扩展也将要一并安装</h4><p>Phalcon</p>
<pre><code>git clone --depth=1 git://github.com/phalcon/cphalcon.git
cd cphalcon/build
sudo ./install
</code></pre><p>添加到 php.ini 中 </p>
<pre><code>extension=phalcon.so
</code></pre><h4 id="apt-get_install__u51FA_u73B0_u4F9D_u8D56_u9879_u95EE_u9898"><a href="#apt-get_install__u51FA_u73B0_u4F9D_u8D56_u9879_u95EE_u9898" class="headerlink" title="apt-get install 出现依赖项问题"></a>apt-get install 出现依赖项问题</h4><pre><code>$ sudo apt-get install php5-fpm
Reading package lists... Done
Building dependency tree
Reading state information... Done
Some packages could not be installed. This may mean that you have
requested an impossible situation or if you are using the unstable
distribution that some required packages have not yet been created
or been moved out of Incoming.
The following information may help to resolve the situation:

The following packages have unmet dependencies:
 php5-fpm : Depends: php5-common (= 5.6.16+dfsg-3+deb.sury.org~trusty+1) but 7.20151230+deb.sury.org~trusty+1 is to be installed
            Depends: php5-cli but it is not going to be installed
            Depends: php5-json but it is not going to be installed
E: Unable to correct problems, you have held broken packages.
</code></pre><p>使用万能的 apt-get –purge remove 删掉php的依赖项 php5-common </p>
<pre><code>sudo apt-get --purge remove php5-common
sudo apt-get autoremove
</code></pre><p>再重新执行安装即可</p>
<p>使用 apt-get install php5-fpm 后出现类似如下错误</p>
<pre><code>PHP Warning:  PHP Startup: Unable to load dynamic library &apos;/usr/lib/php5/20131226/recode.so&apos; - /usr/lib/php5/20131226/recode.so: cannot open shared object file: No such file or directory in Unknown on line 0
</code></pre><p>使用 apt-get install php5-* 依次安装即可</p>
<pre><code>apt-get install php5-recode
</code></pre>
      
    </div>
    
    <div class="article-info article-info-index">
      
      

      
      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>








  
    <article id="post-Server/MongoDB" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2016/01/07/Server/MongoDB/" class="article-date">
      <time datetime="2016-01-07T09:59:14.153Z" itemprop="datePublished">2016-01-07</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <h2 id="MongoDB__u6458_u8981"><a href="#MongoDB__u6458_u8981" class="headerlink" title="MongoDB 摘要"></a>MongoDB 摘要</h2><hr>
<h3 id="MongoDB__u7BA1_u7406"><a href="#MongoDB__u7BA1_u7406" class="headerlink" title="MongoDB 管理"></a>MongoDB 管理</h3><p>重启MongoDb</p>
<p>//sudo mongod -f /etc/mongodb.conf –storageEngine wiredTiger<br>sudo mongod -f /etc/mongod.cnf</p>
<p>设定开机自启动,将以上命令添加到 /etc/rc.local 即可</p>
<p>修改mongodb数据存储位置<br>默认mongodb数据存取位置为 /var/lib/mongodb</p>
<p>修改mongodb配置文件 /etc/mongodb.conf</p>
<p>将 dbpath=/var/lib/mongodb 修改为</p>
<pre><code>dbpath=/data/home/data/mongodb
</code></pre><p>复制数据文件到新的位置</p>
<pre><code>cp -r /var/lib/mongodb /data/home/data/mongod
</code></pre><p>重启MongoDB数据库,可正常访问新的MongoDB数据存储位置</p>
<p>关于阿里云刚安装完mongodb后,启动不了,查看日志 /var/log/mongodb/mongo.log 提示如下错误</p>
<p>mongodb的RAM不足解决方案</p>
<pre><code>Please make at least 3379MB available in /var/lib/mongodb/journal or use --smallfiles
</code></pre><p>按提示,修改mongodb.conf配置文件,取消注释</p>
<pre><code>nojournal = true
</code></pre><p>关闭,可以临时解决这个问题</p>
<p>关闭MongoDB数据库服务<br>官方文档说可以使用killall mongo或kil  -15 PID来关闭.</p>
<p>或者在Mongo Javascript Shell中</p>
<pre><code>&gt; use admin
&gt; db.shutdownServer()
</code></pre><p>mongo默认处于test,如果直接运行 db.shutdownServer() 会出现错误:</p>
<pre><code>shutdown command only works with the admin database; try &apos;use admin&apos;
</code></pre><ol>
<li><p>以admin身份启动shell命令</p>
<p> mongo 127.0.0.1:27017/admin</p>
</li>
</ol>
<p>安装 MongoDB3 参考 <a href="http://docs.mongodb.org/manual/tutorial/install-mongodb-on-ubuntu/#install-the-mongodb-packages" target="_blank" rel="external">http://docs.mongodb.org/manual/tutorial/install-mongodb-on-ubuntu/#install-the-mongodb-packages</a></p>
<p>卸载 MongoDB</p>
<pre><code>sudo apt-get purge mongodb mongodb-clients mongodb-server mongodb-dev
sudo apt-get purge mongodb-10gen
sudo apt-get autoremove
</code></pre><p>MongoDB的备份与恢复  <a href="http://weizhifeng.net/backup-and-restore-data-of-mongodb.html" target="_blank" rel="external">http://weizhifeng.net/backup-and-restore-data-of-mongodb.html</a></p>
<p>安装MongoDB的PHP扩展</p>
<pre><code>sudo pecl install mongo 
</code></pre><p>#或源码安装 <a href="https://github.com/mongodb/mongo-php-driver推荐使用以上命令安装解决相关依赖" target="_blank" rel="external">https://github.com/mongodb/mongo-php-driver推荐使用以上命令安装解决相关依赖</a></p>
<p>安装稳定版本,否则会出现连接502错误</p>
<p>参考<br><a href="http://php.net/manual/zh/mongo.installation.php#mongo.installation.nix" target="_blank" rel="external">http://php.net/manual/zh/mongo.installation.php#mongo.installation.nix</a><br><a href="http://wwsun.me/posts/mongodb-upgrade.html" target="_blank" rel="external">升级到MongoDB 3.0</a></p>
<p>———————————————————————————————————————————————————</p>
<p>MongoDB数据服务器转移</p>
<p>拷贝mongoDB的data目录 /data/home/data/mongodb 下的文件到另一服务器同一目录 /data/home/data/mongodb</p>
<p>拷贝配置文件 /etc/mongodb.conf 过去,使用同样的命令重启mongod即可</p>
<pre><code>sudo mongod -f /etc/mongodb.conf --storageEngine wiredTiger
</code></pre><p>——————————————————————————————————————-</p>
<p>使用wiredEngine需要使用新的YAML配置语法</p>
<p>创建配置文件 mongod.cnf 并添加如下配置:</p>
<pre><code>storage:
dbPath: &quot;/data/home/data/mongodb&quot;  
    engine: wiredTiger  
    wiredTiger:
        engineConfig:
            cacheSizeGB: 20
        collectionConfig:
            blockCompressor: snappy

systemLog:  
   destination: file  
   path: &quot;/var/log/mongodb/mongod.log&quot;  
   logAppend: true  

processManagement:
    fork: true

net:  
    bindIp: 127.0.0.1  
    port: 27017  
    # Enable the HTTP interface (Defaults to port 28017).  
    http:  
        enabled: false  
</code></pre><p>使用新的配置文件重启mongod</p>
<pre><code>mongod -f mongod.cnf
</code></pre><p>参考列表</p>
<p><a href="http://dba.stackexchange.com/questions/82591/sample-yaml-configuration-files-for-mongodb" target="_blank" rel="external">Sample YAML Configuration Files for MongoDB?</a><br><a href="http://www.putaor.com/?p=577" target="_blank" rel="external">MongoDB 3.0 复制集集群搭建及安全认证实践</a><br><a href="https://laike9m.com/blog/ubuntu-yun-xing-mongodb-de-zheng-que-zi-shi,64/" target="_blank" rel="external">Ubuntu 运行 mongodb 的正确姿势</a><br><a href="http://www.mongoing.com/config_3_0" target="_blank" rel="external">MongoDB 3.0 WT引擎参考配置文件</a><br><a href="http://www.codefrom.com/p/mongodb" target="_blank" rel="external">MongoDB 学习集</a></p>
<hr>
<h3 id="u91CD_u8981_u5E38_u7528_u65B9_u6CD5_u8BB0_u5F55"><a href="#u91CD_u8981_u5E38_u7528_u65B9_u6CD5_u8BB0_u5F55" class="headerlink" title="重要常用方法记录"></a>重要常用方法记录</h3><ul>
<li><p>如果mongod服务未启动,使用命令手动启动 MongoDB</p>
<p>  $ mongod -f mongod.cnf</p>
</li>
<li><p>登陆 MongoDB 服务器</p>
<p>  $ mongo -host 43.241.222.110 -port 27017</p>
</li>
<li><p>查看 mongod 服务器集群状态</p>
<blockquote>
<p>rs.status()</p>
</blockquote>
</li>
<li><p>关闭本机运行 MongoDB 服务</p>
<blockquote>
<p>use admin<br>db.shutdownServer()</p>
</blockquote>
</li>
</ul>

      
    </div>
    
    <div class="article-info article-info-index">
      
      

      
      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>








  
  
    <nav id="page-nav">
      <a class="extend prev" rel="prev" href="/page/4/">&laquo; Prev</a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/3/">3</a><a class="page-number" href="/page/4/">4</a><span class="page-number current">5</span><a class="page-number" href="/page/6/">6</a><a class="page-number" href="/page/7/">7</a><span class="space">&hellip;</span><a class="page-number" href="/page/9/">9</a><a class="extend next" rel="next" href="/page/6/">Next &raquo;</a>
    </nav>
  
</div>
      <footer id="footer">
    <div class="outer">
        <div id="footer-info">
            <div class="footer-left">
                &copy; 2016 张亚飞
            </div>
            <div class="footer-right">
                <a href="http://hexo.io/" target="_blank" title="快速、简洁且高效的静态博客框架">Hexo</a>  Theme <a href="https://github.com/MOxFIVE/hexo-theme-yelee" target="_blank" title="简而不减双栏 Hexo 博客主题">Yelee</a> by MOxFIVE
            </div>
        </div>
        <div class="visit">
            <span id="busuanzi_container_site_pv" style='display:none'>
                <span id="site-visit" >本站到访数: 
                    <span id="busuanzi_value_site_uv"></span>
                </span>
            </span>
            <span id="busuanzi_container_page_pv" style='display:none'>
                <span id="page-visit">, 本页阅读量: 
                    <span id="busuanzi_value_page_pv"></span>
                </span>
            </span>
        </div>
    </div>
</footer>
    </div>
    <script src="http://7.url.cn/edu/jslib/comb/require-2.1.6,jquery-1.9.1.min.js" type="text/javascript"></script>
<script src="/js/main.js" type="text/javascript"></script>

    <script>
        $(document).ready(function() {
            var iPad = window.navigator.userAgent.indexOf('iPad');
            if (iPad > -1 || $(".left-col").css("display") === "none") {
                var bgColorList = ["#9db3f4", "#414141", "#e5a859", "#f5dfc6", "#c084a0", "#847e72", "#cd8390", "#996731"];
                var bgColor = Math.ceil(Math.random() * (bgColorList.length - 1));
                $("body").css({"background-color": bgColorList[bgColor], "background-size": "cover"});
            }
            else {
                var backgroundnum = 5;
                var backgroundimg = "url(/background/bg-x.jpg)".replace(/x/gi, Math.ceil(Math.random() * backgroundnum));
                $("body").css({"background": backgroundimg, "background-attachment": "fixed", "background-size": "cover"});
            }
        })
    </script>




<div class="scroll" id="scroll">
    <a href="#" title="返回顶部"><i class="fa fa-arrow-up"></i></a>
    <a href="#comments" title="查看评论"><i class="fa fa-comments-o"></i></a>
    <a href="#footer" title="转到底部"><i class="fa fa-arrow-down"></i></a>
</div>

<script>
    $(document).ready(function() {
        if ($("#comments").length < 1) {
            $("#scroll > a:nth-child(2)").hide();
        };
    })
</script>

<script async src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js">
</script>
  </div>
</body>
</html>