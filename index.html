<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>商运物流</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description">
<meta property="og:type" content="website">
<meta property="og:title" content="商运物流">
<meta property="og:url" content="https://coam.co/index.html">
<meta property="og:site_name" content="商运物流">
<meta property="og:description">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="商运物流">
<meta name="twitter:description">
  
    <link rel="alternative" href="/atom.xml" title="商运物流" type="application/atom+xml">
  
  
    <link rel="icon" href="/img/favicon.png">
  
  
  <link rel="stylesheet" href="//cdn.bootcss.com/animate.css/3.5.0/animate.min.css" type="text/css">
  
  <link rel="stylesheet" href="/css/style.css" type="text/css">
  <link rel="stylesheet" href="/font-awesome/css/font-awesome.min.css">
  <link rel="apple-touch-icon" href="/apple-touch-icon.png">
  
    
    
  
  
      <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
  
  <script>
      var yiliaConfig = {
          fancybox: true,
          animate: true,
          isHome: true,
          isPost: false,
          isArchive: false,
          isTag: false,
          isCategory: false,
          open_in_new: false
      }
  </script>
</head>
<body>
  <div id="container">
    <div class="left-col">
    <div class="overlay"></div>
<div class="intrude-less">
    <header id="header" class="inner">
        <a href="/" class="profilepic">
            
            <img lazy-src="/img/author.jpg" class="js-avatar">
            
        </a>

        <hgroup>
          <h1 class="header-author"><a href="/">张亚飞</a></h1>
        </hgroup>

        
                


        
            <div id="switch-btn" class="switch-btn">
                <div class="icon">
                    <div class="icon-ctn">
                        <div class="icon-wrap icon-house" data-idx="0">
                            <div class="birdhouse"></div>
                            <div class="birdhouse_holes"></div>
                        </div>
                        <div class="icon-wrap icon-ribbon hide" data-idx="1">
                            <div class="ribbon"></div>
                        </div>
                        
                        <div class="icon-wrap icon-link hide" data-idx="2">
                            <div class="loopback_l"></div>
                            <div class="loopback_r"></div>
                        </div>
                        
                        
                        <div class="icon-wrap icon-me hide" data-idx="3">
                            <div class="user"></div>
                            <div class="shoulder"></div>
                        </div>
                        
                    </div>
                    
                </div>
                <div class="tips-box hide">
                    <div class="tips-arrow"></div>
                    <ul class="tips-inner">
                        <li>菜单</li>
                        <li>标签</li>
                        
                        <li>友情链接</li>
                        
                        
                        <li>关于我</li>
                        
                    </ul>
                </div>
            </div>
        

        <div id="switch-area" class="switch-area">
            <div class="switch-wrap">
                <section class="switch-part switch-part1">
                    <nav class="header-menu">
                        <ul>
                        
                            <li><a href="/">主页</a></li>
                        
                            <li><a href="/archives/">所有文章</a></li>
                        
                            <li><a href="/tags/">标签云</a></li>
                        
                            <li><a href="/about/">关于我</a></li>
                        
                        </ul>
                    </nav>
                    <nav class="header-nav">
                        <ul class="social">
                            
                                <li id="Email"><a class="Email" target="_blank" href="mailto:zyf@lonal.com" title="Email"></a></li>
                            
                                <li id="GitHub"><a class="GitHub" target="_blank" href="https://github.com/zyfmix" title="GitHub"></a></li>
                            
                                <li id="RSS"><a class="RSS" target="_blank" href="/atom.xml" title="RSS"></a></li>
                            
                        </ul>
                    </nav>
                </section>
                
                
                <section class="switch-part switch-part2">
                    <div class="widget tagcloud" id="js-tagcloud">
                        <a href="/tags/markdown-gfw-hexo-jekyll/" style="font-size: 10px;">markdown gfw hexo jekyll</a>
                    </div>
                </section>
                
                
                
                <section class="switch-part switch-part3">
                    <div id="js-friends">
                    
                      <a target="_blank" class="main-nav-link switch-friends-link" href="https://coam.co">商运物流</a>
                    
                      <a target="_blank" class="main-nav-link switch-friends-link" href="https://github.com/zyfmix/">GitHub</a>
                    
                      <a target="_blank" class="main-nav-link switch-friends-link" href="https://wp.iirii.com/">商运技术博客</a>
                    
                    </div>
                </section>
                

                
                
                <section class="switch-part switch-part4">
                
                    <div id="js-aboutme">专注于物流设计</div>
                </section>
                
            </div>
        </div>
    </header>                
</div>
    </div>
    <div class="mid-col">
      <nav id="mobile-nav">
      <div class="overlay">
          <div class="slider-trigger"></div>
          <h1 class="header-author js-mobile-header hide"><a href="/" title="回到主页">张亚飞</a></h1>
      </div>
    <div class="intrude-less">
        <header id="header" class="inner">
            <a href="/" class="profilepic">
                <img lazy-src="/img/author.jpg" class="js-avatar">
            </a>
            <hgroup>
              <h1 class="header-author"><a href="/" title="回到主页">张亚飞</a></h1>
            </hgroup>
            
            <nav class="header-menu">
                <ul>
                
                    <li><a href="/">主页</a></li>
                
                    <li><a href="/archives/">所有文章</a></li>
                
                    <li><a href="/tags/">标签云</a></li>
                
                    <li><a href="/about/">关于我</a></li>
                
                <div class="clearfix"></div>
                </ul>
            </nav>
            <nav class="header-nav">
                        <ul class="social">
                            
                                <li id="Email"><a class="Email" target="_blank" href="mailto:zyf@lonal.com" title="Email"></a></li>
                            
                                <li id="GitHub"><a class="GitHub" target="_blank" href="https://github.com/zyfmix" title="GitHub"></a></li>
                            
                                <li id="RSS"><a class="RSS" target="_blank" href="/atom.xml" title="RSS"></a></li>
                            
                        </ul>
            </nav>
        </header>                
    </div>
</nav>
      <div class="body-wrap">
  
    <article id="post-Server/NodeJs" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2016/01/22/Server/NodeJs/" class="article-date">
      <time datetime="2016-01-22T04:03:49.038Z" itemprop="datePublished">2016-01-22</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <h2 id="Node-js__u7BA1_u7406_u76F8_u5173"><a href="#Node-js__u7BA1_u7406_u76F8_u5173" class="headerlink" title="Node.js 管理相关"></a>Node.js 管理相关</h2><h3 id="u5728Ubuntu__u5B89_u88C5_Node-js"><a href="#u5728Ubuntu__u5B89_u88C5_Node-js" class="headerlink" title="在Ubuntu 安装 Node.js"></a>在Ubuntu 安装 Node.js</h3><h2 id="u5B89_u88DD_Node-js"><a href="#u5B89_u88DD_Node-js" class="headerlink" title="安裝 Node.js"></a>安裝 Node.js</h2><p>起始这个步骤很重要,而且如果参考大部分教学就会踩到雷.主要原因是如果用上面那篇的方法,不会自动帮你做好软连接,后续很容易出現莫名其妙的问题.</p>
<pre><code>sudo apt-get update
sudo apt-get install nodejs-legacy
</code></pre><p>直接用 nodejs-legacy 即可.這個会自动建立软连接,可以避免不少比较旧的库的问题.</p>
<p>在 安装node的时候,安装位置为 /usr/local/bin/node ,但这个位置是需要root权限的,而截图上提示的错误就是你的权限不 够,node没有安装成功.如果你用源码编译安装,记得最后安装时加sudo执行.而且你在执行nodejs的时候,截图也提示你了,你的nodejs没 有安装,但你可以使用 sudo apt-get install nodejs 这个命令来安装,这是因为你之前添加了ppa才可以这样安装.</p>
<p>另 外,我想补充的是,你所用的ppa的方法,已经是很旧的了,即使安装成功也是很老版本的,这个ppa已经很久不更新了,现在ubuntu软件仓库就已经有 node了,所以你可以先用</p>
<pre><code>sudo apt-add-repository -r ppa:chris-lea/node.js-devel
</code></pre><p>删除这个ppa,然后安装仓库里的node:</p>
<pre><code>sudo apt-get install nodejs
</code></pre><p>如果你发现仓库里的nodejs版本不够高,可以更新一下仓库和软件版本:</p>
<pre><code>sudo apt-get update
sudo apt-get upgrade
</code></pre><p>你也可以用源代码编译安装node,也很简单,下载node的源代码包,解压,进入目录执行:</p>
<pre><code>./configure &amp;&amp; make &amp;&amp; sudo make install
</code></pre><p>补充:</p>
<h4 id="u4E3A_u4EC0_u4E48_u6267_u884C_node_-v__u6CA1_u6709_u8F93_u51FA_uFF1F"><a href="#u4E3A_u4EC0_u4E48_u6267_u884C_node_-v__u6CA1_u6709_u8F93_u51FA_uFF1F" class="headerlink" title="为什么执行 node -v 没有输出？"></a>为什么执行 node -v 没有输出？</h4><blockquote>
<p>Ubuntu 的仓库里面,已经存在一个叫node的软件包了,可以执行aptitude search node`查看,这是一个先于nodejs存在的软件名,已经被用了,所以ubuntu只能把用于js开发的这个node改名叫nodejs,如果系统已 经安装此软件,执行node -v并非nodejs的node,它跟nodejs一点关系也没有,它的-v参数是不显示任何东西的.<br>node 还是 nodejs ?</p>
</blockquote>
<p>用 apt-get install nodejs 方法安装的,或是ppa方法安装的,命令都应该叫 nodejs,应该使用nodejs -v来测试.不过如果使用源代码的方式编译安装的（默认安装到 /usr/local/bin ,除非指定prefix参数）,也叫node,这个node是 真正的nodejs的node,所以为了避免与ubuntu仓库中的node引起混淆,建议安装后,把node改名为nodejs</p>
<p>windows下是 node -v;ubuntu下是 nodejs -v</p>
<hr>
<h3 id="nvm"><a href="#nvm" class="headerlink" title="nvm"></a>nvm</h3><p>参考 <a href="http://eyas.leanote.com/post/use-nvm-install-nodejs" target="_blank" rel="external">使用 nvm 安装 nodejs</a></p>
<p><a href="https://github.com/creationix/nvm" target="_blank" rel="external">建议使用版本管理工具nvm，来安装Node，因为可以自由切换版本</a></p>
<h4 id="Window__u4E0B_u5B89_u88C5_nvm"><a href="#Window__u4E0B_u5B89_u88C5_nvm" class="headerlink" title="Window 下安装 nvm"></a>Window 下安装 nvm</h4><p><a href="https://github.com/coreybutler/nvm-windows" target="_blank" rel="external">nvm-windows</a><br>下载安装文件 <a href="https://github.com/coreybutler/nvm-windows/releases/download/1.1.0/nvm-setup.zip" target="_blank" rel="external">nvm-setup.zip</a></p>
<p>nvm 将 nodejs 安装到目录 <strong>C:\Users\yafei\AppData\Roaming\nvm\v5.5.0</strong><br>使用 npm install -g <em> 将包安装到目录 <em>*C:\Users\yafei\AppData\Roaming\nvm\v5.5.0\node_modules</em></em></p>
<p>window 下 nvm 常用命令</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">nvm list</span><br><span class="line">nvm install latest</span><br><span class="line">nvm on: Enable node.js version management.</span><br><span class="line">nvm off: Disable node.js version management (does not uninstall anything).</span><br><span class="line">nvm proxy [url]: Set a proxy to use <span class="keyword">for</span> downloads. Leave [url] blank to see the current proxy. Set [url] to <span class="string">"none"</span> to remove the proxy.</span><br><span class="line">nvm uninstall &lt;version&gt;: Uninstall a specific version.</span><br><span class="line">nvm use &lt;version&gt; [arch]:</span><br></pre></td></tr></table></figure>
<h4 id="Ubuntu__u4E0B_u5B89_u88C5_nvm"><a href="#Ubuntu__u4E0B_u5B89_u88C5_nvm" class="headerlink" title="Ubuntu 下安装 nvm"></a>Ubuntu 下安装 nvm</h4><p><a href="https://github.com/creationix/nvm" target="_blank" rel="external">nvm</a><br>使用 安装脚本安装 nvm</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">curl -o- https://raw.githubusercontent.com/creationix/nvm/v0.<span class="number">30.2</span>/install.sh | bash</span><br><span class="line">. ~/.nvm/nvm.sh</span><br></pre></td></tr></table></figure>
<p>Ubuntu 下 nvm 常用命令</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">nvm ls-remote  // 列出所有可用版本</span><br><span class="line">nvm install latest</span><br></pre></td></tr></table></figure>
<hr>
<h3 id="u5B89_u88C5_npm"><a href="#u5B89_u88C5_npm" class="headerlink" title="安装 npm"></a>安装 npm</h3><pre><code>sudo apt-get install npm
</code></pre><h4 id="npm_u5E38_u7528_u547D_u4EE4"><a href="#npm_u5E38_u7528_u547D_u4EE4" class="headerlink" title="npm常用命令"></a>npm常用命令</h4><pre><code>npm install &lt;name&gt;安装nodejs的依赖包
</code></pre><p>例如 npm install express 就会默认安装express的最新版本,也可以通过在后面加版本号的方式安装指定版本,如npm install express@3.0.6</p>
<pre><code>npm install &lt;name&gt; -g  将包安装到全局环境中
</code></pre><p>但是代码中,直接通过require()的方式是没有办法调用全局安装的包的.全局的安装是供命令行使用的,就好像全局安装了vmarket后,就可以在命令行中直接运行vm命令</p>
<pre><code>npm install &lt;name&gt; --save  安装的同时,将信息写入package.json中
</code></pre><p>项目路径中如果有package.json文件时,直接使用npm install方法就可以根据dependencies配置安装所有的依赖包</p>
<p>这样代码提交到github时,就不用提交 node_modules 这个文件夹了.</p>
<figure class="highlight coffeescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">npm</span> init   会引导你创建一个package.json文件,包括名称、版本、作者这些信息等</span><br><span class="line"><span class="built_in">npm</span> remove &lt;name&gt;移除</span><br><span class="line"><span class="built_in">npm</span> update &lt;name&gt;更新</span><br><span class="line"><span class="built_in">npm</span> ls 列出当前安装的了所有包</span><br><span class="line"><span class="built_in">npm</span> root  查看当前包的安装路径</span><br><span class="line"><span class="built_in">npm</span> root -g  查看全局的包的安装路径</span><br><span class="line"><span class="built_in">npm</span> help  帮助,如果要单独查看install命令的帮助,可以使用的<span class="built_in">npm</span> help install</span><br></pre></td></tr></table></figure>
<blockquote>
<p>升级npm到最新版本,使用以下命令</p>
</blockquote>
<pre><code>npm install npm@latest -g
</code></pre><blockquote>
<p>国内npm安装nodejs modules失败的几个解决方案</p>
</blockquote>
<pre><code>npm config set proxy=&quot;http://127.0.0.1:8087&quot;//设置代理地址 http://www.xxxx.com:port格式
npm config set registry=&quot;http://registry.npmjs.org&quot;//设置npm源地址
</code></pre><p><a href="http://www.tuicool.com/articles/VNZ7Vb" target="_blank" rel="external">nodejs国内npm安装nodejs modules失败的几个解决方案 </a></p>
<p>参考列表</p>
<p><a href="http://codeblog.niwyclin.org/posts/210397-ubuntu-installed-nodejs-and-npm" target="_blank" rel="external">Ubuntu 正确安装 Node.js 和 Npm</a><br><a href="http://segmentfault.com/q/1010000003753704" target="_blank" rel="external">Ubuntu下装nodejs的问题</a></p>
<h3 id="u9519_u8BEF_u53CA_u5E38_u7528_u547D_u4EE4"><a href="#u9519_u8BEF_u53CA_u5E38_u7528_u547D_u4EE4" class="headerlink" title="错误及常用命令"></a>错误及常用命令</h3><blockquote>
<p>清除缓存重新安装<br><figure class="highlight coffeescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">rm -rf node_modules</span><br><span class="line"><span class="built_in">npm</span> cache clean</span><br><span class="line"><span class="built_in">npm</span> install</span><br></pre></td></tr></table></figure></p>
<p>在 Ubuntu 下安装 converse.js 频繁出现以下错误</p>
</blockquote>
<figure class="highlight stata"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">Please <span class="keyword">report</span> this full <span class="keyword">log</span> at https:<span class="comment">//github.com/Medium/phantomjs</span></span><br><span class="line">npm WARN This failure might be due to the <span class="keyword">use</span> of legacy binary <span class="string">"node"</span></span><br><span class="line">npm WARN <span class="keyword">For</span> further explanations, please <span class="keyword">read</span></span><br><span class="line">/usr/share/doc/nodejs/README.Debian</span><br><span class="line"></span><br><span class="line">npm <span class="keyword">ERR</span>! weird <span class="keyword">error</span> 1</span><br><span class="line">npm <span class="keyword">ERR</span>! not ok code 0</span><br><span class="line">make: *** [stamp-npm] <span class="keyword">Error</span> 1</span><br></pre></td></tr></table></figure>
<p>网友提示需要安装 nodejs<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-get install nodejs-legacy</span><br></pre></td></tr></table></figure></p>
<p>但是执行此命令提示我已安装</p>
<ul>
<li>Setup with Ubuntu</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">curl <span class="operator">-s</span>L https://deb.nodesource.com/setup_5.x | sudo -E bash -</span><br></pre></td></tr></table></figure>
<ul>
<li>Then install with Ubuntu:</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-get install --yes nodejs</span><br></pre></td></tr></table></figure>
<ul>
<li>If you get node: command not found chances are likely you need to link your binary:</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo ln <span class="operator">-s</span> /usr/bin/nodejs /usr/bin/node</span><br></pre></td></tr></table></figure>
<p>参考 <a href="https://github.com/nodejs/node-v0.x-archive/wiki/Installing-Node.js-via-package-manager" target="_blank" rel="external">Installing Node.js via package manager</a></p>
<p>重新执行命令安装出现如下错误<br><figure class="highlight crmsh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Failed at the phantomjs@<span class="number">1.9</span>.<span class="number">19</span> install script '<span class="keyword">node</span><span class="identifier"> </span><span class="title">install</span>.js'.</span><br></pre></td></tr></table></figure></p>
<p>执行命令</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm config <span class="built_in">set</span> strict-ssl <span class="literal">false</span></span><br></pre></td></tr></table></figure>
<p><a href="https://github.com/Medium/phantomjs/issues/430" target="_blank" rel="external">Failed at the phantomjs@1.9.19 install script ‘node install.js’.</a></p>
<hr>
<h3 id="u5B89_u88C5_nrm__u2013__u5FEB_u901F_u5207_u6362_NPM__u6E90__uFF08_u9644_u5E26_u6D4B_u901F_u529F_u80FD_uFF09"><a href="#u5B89_u88C5_nrm__u2013__u5FEB_u901F_u5207_u6362_NPM__u6E90__uFF08_u9644_u5E26_u6D4B_u901F_u529F_u80FD_uFF09" class="headerlink" title="安装 nrm – 快速切换 NPM 源 （附带测速功能）"></a>安装 nrm – 快速切换 NPM 源 （附带测速功能）</h3><pre><code>npm install -g nrm
</code></pre><h4 id="u5E38_u7528_u547D_u4EE4"><a href="#u5E38_u7528_u547D_u4EE4" class="headerlink" title="常用命令"></a>常用命令</h4><p>列出可选的源</p>
<pre><code>$ nrm ls
* npm ---- https://registry.npmjs.org/
  cnpm --- http://r.cnpmjs.org/
  taobao - http://registry.npm.taobao.org/
  eu ----- http://registry.npmjs.eu/
  au ----- http://registry.npmjs.org.au/
  sl ----- http://npm.strongloop.com/
  nj ----- https://registry.nodejitsu.com/
</code></pre><p>切换源到 taobao</p>
<pre><code>$ nrm use taobao
Registry has been set to: http://registry.npm.taobao.org/
</code></pre><p>增加源<br>你可以增加定制的源,特别适用于添加企业内部的私有源.私有源可以使用cnpmjs架设.</p>
<pre><code>nrm add  &lt;registry&gt; &lt;url&gt; [home]
</code></pre><p>删除源</p>
<pre><code>nrm del &lt;registry&gt;
</code></pre><p>测试速度<br>你还可以通过 nrm test 测试相应源的响应时间.</p>
<p>例如,测试官方源的响应时间:</p>
<pre><code>$ nrm test npm
npm ---- 1328ms
</code></pre><p>测试所有源的响应时间:</p>
<pre><code>$ nrm test
  npm ---- 891ms
  cnpm --- 1213ms
* taobao - 460ms
  eu ----- 3859ms
  au ----- 1073ms
  sl ----- 4150ms
  nj ----- 8008ms
</code></pre><p>注意,为了取得较准确的结果,可以考虑多次测试取平均值.</p>
<hr>
<h3 id="u5B89_u88C5_Bower__u5305_u7BA1_u7406_u5DE5_u5177"><a href="#u5B89_u88C5_Bower__u5305_u7BA1_u7406_u5DE5_u5177" class="headerlink" title="安装 Bower 包管理工具"></a>安装 Bower 包管理工具</h3><pre><code>sudo npm install bower -g
</code></pre><blockquote>
<p>bower 常用命令</p>
</blockquote>
<pre><code>bower install
bower update
</code></pre><p><a href="http://stackoverflow.com/questions/21491996/installing-bower-on-ubuntu" target="_blank" rel="external">Installing Bower on Ubuntu</a></p>
<h3 id="u5B89_u88C5_mongo-express"><a href="#u5B89_u88C5_mongo-express" class="headerlink" title="安装 mongo-express"></a>安装 mongo-express</h3><p>在安装 mongo-express 的时候,需要服务器有 nodejs 环境</p>
<blockquote>
<p>mongo-express 是一个基于 Node.js 和 express 的开源的MongoDB Web管理界面.</p>
<p>主要功能:</p>
</blockquote>
<pre><code>连接多个数据库
分别连接和认证独立的数据库
认证为管理员查看所有数据库
数据库 黑名单/白名单
集合(collections)的增删查改
文档(documents)的增删查改
在文档中使用BSON数据类型
</code></pre><blockquote>
<p>限制</p>
</blockquote>
<pre><code>被编辑的文档必须有document._id属性
无GridFS的支持（有可能成为计划功能）
二进制BSON数据类型没有经过测试
JSON文档是通过JavaScript虚拟机解析,所以可以在服务器上的Web界面执行恶意JavaScript代码.
</code></pre><blockquote>
<p>安装:</p>
</blockquote>
<pre><code>npm install mongo-express
</code></pre><blockquote>
<p>或者全局安装:</p>
</blockquote>
<pre><code>npm install -g mongo-express
</code></pre><p>或者从Github上直接拿下来解压后运行 npm install 即可</p>
<p>下载 <a href="https://github.com/andzdroid/mongo-express" target="_blank" rel="external">Mongo-express</a></p>
<p>配置:</p>
<p>复制或者把 config.default.js 改名为 config.js 的新文件.</p>
<p>在配置文件中填写 MongoDB 的连接等你想更改的信息.</p>
<p>启动运行:</p>
<pre><code>nodejs app
</code></pre><p>查看 <a href="http://localhost:8081" target="_blank" rel="external">http://localhost:8081</a> 或者你在配置中写的 URL/port .</p>
<p>在Ubuntu下执行启动命令会提示如下错误</p>
<pre><code>yzhang@coamn:~/Home/Tools/MongoDB$ node app
 The program &apos;node&apos; can be found in the following packages:
  * node
  * nodejs-legacy
Ask your administrator to install one of them
</code></pre><p>提示没有安装node程序,需要先检查是否已安装nodejs运行环境</p>
<pre><code>Thu Sep 24 12:58:16 yzhang@coam:~/Home/Tools/MongoDB$ nodejs -v
v0.10.25
</code></pre><p>然后执行命令</p>
<pre><code>nodejs app
</code></pre>
      
    </div>
    
    <div class="article-info article-info-index">
      
      

      
      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>








  
    <article id="post-NodeJs/CheerioNote" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2016/01/21/NodeJs/CheerioNote/" class="article-date">
      <time datetime="2016-01-21T08:34:31.000Z" itemprop="datePublished">2016-01-21</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/01/21/NodeJs/CheerioNote/">CheerioNote</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <a id="more"></a>
      
    </div>
    
    <div class="article-info article-info-index">
      
      

      
      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>








  
    <article id="post-NodeJs/MochaNote" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2016/01/21/NodeJs/MochaNote/" class="article-date">
      <time datetime="2016-01-21T04:07:31.000Z" itemprop="datePublished">2016-01-21</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/01/21/NodeJs/MochaNote/">MochaNote</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <a id="more"></a>
<p><a href="http://www.hubwiz.com/course/562085141bc20c980538e25a/" target="_blank" rel="external">测试利器Mocha</a></p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      

      
      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>








  
    <article id="post-NodeJs/WebpackNote" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2016/01/20/NodeJs/WebpackNote/" class="article-date">
      <time datetime="2016-01-20T13:26:31.000Z" itemprop="datePublished">2016-01-20</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/01/20/NodeJs/WebpackNote/">WebPack 自动打包工具</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
              <p><a href="http://www.hubwiz.com/course/5670d0a77e7d40946afc5e65/">webpack入门</a></p>
          
      
    </div>
    
    <div class="article-info article-info-index">
      
      

      
      
        <p class="article-more-link">
          <a  href="/2016/01/20/NodeJs/WebpackNote/#more">more >></a>
        </p>
      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>








  
    <article id="post-NodeJs/GulpNote" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2016/01/20/NodeJs/GulpNote/" class="article-date">
      <time datetime="2016-01-20T13:26:31.000Z" itemprop="datePublished">2016-01-20</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
    <div class="article-entry" itemprop="articleBody">
      
          
              <p><a href="http://www.hubwiz.com/course/562089cb1bc20c980538e25b/">自动化工具Gulp</a></p>
          
      
    </div>
    
    <div class="article-info article-info-index">
      
      

      
      
        <p class="article-more-link">
          <a  href="/2016/01/20/NodeJs/GulpNote/#more">more >></a>
        </p>
      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>








  
    <article id="post-Info/hospital" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2016/01/20/Info/hospital/" class="article-date">
      <time datetime="2016-01-20T07:20:31.000Z" itemprop="datePublished">2016-01-20</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/01/20/Info/hospital/">hospital</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <a id="more"></a>
<p>胸痛是以胸部疼痛为痛苦的一种自觉症状，为内科心、肺、肝系疾病的常见症状。<br>其基本病机是病邪壅阻心胸血脉，气血不通而疼痛，一般为实证，病邪有寒、热、痰、瘀，但也有本虚标实证。<br>临床时应分析疼痛的性质、牵连部位及伴随的症状等:<br>胸痛憋闷，有压榨感，多为气滞、痰阻;<br>胸痛如刺，夜间为甚，多为血瘀阻滞;<br>胸痛连脘腹，手不可触者，寒热结胸;<br>胸痛连胁，病在肝胆;<br>胸痛痛连左手尺侧者，为胸痹心痛;<br><em>胸痛痛引肩背，发热呕恶者，为肝胆湿热;
</em>胸痛痛连肩背，脉沉紧者，为寒凝心胸。<br>胸痛伴发热咳嗽，咳则痛甚，为肺热络伤;<br>胸痛伴咳吐脓血痰，为肺痈;<br>*胸部隐痛，咳嗽无力，多为肺气虚弱，余邪未尽的肺热病后期，也可见于肺痨;<br>胸痛伴心悸，病在心;<br>心胸卒然大痛，持续不解，面青肢冷，脉微细者，为心脉闭阻不通，特称“真心痛”以示危证。</p>
<p>在各种胸痛中需重视并快速做出判断的疾病有：急性冠脉综合症、主动脉夹层、肺栓塞、自发性气胸。<br>急性冠脉综合症：患者既往胸痛发作持续20分钟以上，心肌坏死标记物有动态演变，心电图有特异性变化。<br>主动脉夹层：经CT扫描可确诊。<br>肺栓塞：严重呼吸困难，呼吸增快，胸痛，面部紫绀，甚至出现晕厥。<br>自发性气胸：经X线片可鉴别诊断。</p>
<p>胸痛的常见原因及症状</p>
<pre><code>胸痛的原因有外伤、炎症、机械性压迫、组织缺血缺氧等。它不仅见于呼吸系统疾病，亦可发生于心血管系统、消化系统、神经系统疾病以及胸壁组织疾病。不同器官和不同疾病引起的胸痛，在部位、性质和发生时间上不尽相同。
</code></pre><p>通过详细询问病史和体格检查，辅以X线或心电图等特殊检查，可以得出正确诊断。</p>
<h2 id="u80F8_u58C1_u75C5_u53D8"><a href="#u80F8_u58C1_u75C5_u53D8" class="headerlink" title="胸壁病变"></a>胸壁病变</h2><blockquote>
<p>胸壁软组织损伤及炎症，有局限性疼痛和压痛。肋间神经炎痛沿肋间神经分布，在脊柱旁、腋部和胸骨旁常有压痛点。带状疱疹引起的胸痛可以相当剧烈，但与咳嗽和深呼吸无关。肋骨骨折，除压痛外还有骨裂声，挤压胸部时疼痛加剧。肋骨骨髓炎有局限性疼痛、周围肌肉痉挛和发热，晚期有骨坏死和脓窦。癌肿转移到肋骨，则出现剧烈难忍的胸痛和局部压痛。</p>
</blockquote>
<h2 id="u80F8_u819C_u53CA_u80BA_u90E8_u75C5_u53D8_*"><a href="#u80F8_u819C_u53CA_u80BA_u90E8_u75C5_u53D8_*" class="headerlink" title="胸膜及肺部病变 *"></a>胸膜及肺部病变 *</h2><blockquote>
<p>干性胸膜炎患者胸膜表面有纤维素渗出及附着，呼吸时两层胸膜互相摩擦发生疼痛。其性质多为刺痛，以胸廓扩张幅度较大的部位如肋部最显著，随呼吸和咳嗽而加剧。自发性气胸及胸膜腔出血均刺激胸膜引起疼痛，每伴有气急。胸膜恶性肿瘤的胸痛持续而剧烈，常合并大量血性胸水。肺部疾病，当病变影响壁层胸膜时可引起疼痛，多位于病变邻近部位，随咳嗽和深呼吸加重。</p>
</blockquote>
<h2 id="u5FC3_u8840_u7BA1_u75BE_u75C5_*"><a href="#u5FC3_u8840_u7BA1_u75BE_u75C5_*" class="headerlink" title="心血管疾病 *"></a>心血管疾病 *</h2><blockquote>
<p>常见于冠心病、心包炎、胸主动脉瘤等。冠心病的心绞痛多位于心前区或胸骨后，可向左肩及臂部放射，常因体力活动、饱食和情绪激动而诱发，休息或用硝基甘油可迅速缓解。</p>
</blockquote>
<h2 id="u7EB5_u9694_u75C5_u53D8"><a href="#u7EB5_u9694_u75C5_u53D8" class="headerlink" title="纵隔病变"></a>纵隔病变</h2><blockquote>
<p>纵隔气肿时胸骨下有强烈的疼痛，可因吞咽而加剧。急性食管炎为胸骨下灼痛，亦随吞咽而加重。</p>
</blockquote>
<h2 id="u8188_u808C_u53CA_u8188_u4E0B_u75C5_u53D8"><a href="#u8188_u808C_u53CA_u8188_u4E0B_u75C5_u53D8" class="headerlink" title="膈肌及膈下病变"></a>膈肌及膈下病变</h2><blockquote>
<p>如膈疝、隔胸膜炎、膈下脓肿、肝脏疾患等。疼痛一般位于胸骨及胸廓下部，可放射至肩背部。</p>
</blockquote>
<p>胸痛治疗首要的是治疗引起胸痛的疾病。疼痛剧烈者可选用镇痛药。若疼痛与呼吸运动有关，则可在胸廓贴以胶布固定，以减少胸廓活动，缓解疼痛。</p>
<p>胸膜及肺部病变|心血管疾病</p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      

      
      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>








  
    <article id="post-Server/Config/Ejabberd/Ali_etc_ejabberd_ejabberd" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2016/01/19/Server/Config/Ejabberd/Ali_etc_ejabberd_ejabberd/" class="article-date">
      <time datetime="2016-01-19T10:01:08.576Z" itemprop="datePublished">2016-01-19</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
    <div class="article-entry" itemprop="articleBody">
      
          
        {"loglevel":5,"log_rotate_size":10485760,"log_rotate_date":"","log_rotate_count":1,"log_rate_limit":100,"hosts":["coopens.com"],"define_macro":{"COOPENS_SSL_EJABBERD_CERT":"/etc/ejabberd/ejabberd.pem","COAM_SSL_EJABBERD_CERT":"/etc/ejabberd/ejabberd.pem","DHPARAM_LOCATION":"/data/home/yzhang/Home/Documents/Server/Config/Nginx/Certify/dhparam.pem","LOCAL_EJABBERD_SERVER_IP":"127.0.0.1","TEST_EJABBERD_SERVER_IP":"42.96.194.60","COOPENS_EJABBERD_SERVER_IP":"42.96.194.60","COAM_EJABBERD_SERVER_IP":"43.241.222.110","TLS_OPTIONS":["no_sslv2","no_sslv3"],"TLS_CIPHERS":"ECDH:DH:!CAMELLIA128:!3DES:!MD5:!RC4:!aNULL:!NULL:!EXPORT:!LOW:!MEDIUM","TRANSPORTS":["aim.coopens.com","icq.coopens.com"]},"commands_admin_access":"xmlrpc_access","listen":[{"port":4560,"ip":"TEST_EJABBERD_SERVER_IP","module":"ejabberd_xmlrpc","maxsessions":10,"timeout":5000,"access_commands":{"xmlrpc_access":{"all":{}}}},{"port":5222,"module":"ejabberd_c2s","certfile":"COOPENS_SSL_EJABBERD_CERT","starttls":true,"starttls_required":true,"protocol_options":"TLS_OPTIONS","ciphers":"TLS_CIPHERS","dhfile":"DHPARAM_LOCATION","resend_on_timeout":true,"zlib":true,"max_stanza_size":65536,"max_ack_queue":32767,"resume_timeout":1200,"shaper":"c2s_shaper","access":"c2s"},{"port":5269,"module":"ejabberd_s2s_in","shaper":"s2s_shaper","max_stanza_size":65536,"transport":"tcp","tls_compression":true},{"port":5280,"module":"ejabberd_http","tls":true,"certfile":"COOPENS_SSL_EJABBERD_CERT","dhfile":"DHPARAM_LOCATION","request_handlers":{"/websocket":"ejabberd_http_ws","/pub/archive":"mod_http_fileserver","/log":"mod_log_http","/http-bind":"mod_http_bind","/oauth":"ejabberd_oauth","/api":"mod_http_api","users":"mod_available_user","online":"mod_online_users","/custom":"mod_custom"},"web_admin":true,"http_poll":true,"http_bind":true,"register":true,"captcha":true},{"ip":"::","port":5349,"module":"ejabberd_stun","tls":true,"certfile":"COOPENS_SSL_EJABBERD_CERT","use_turn":true,"turn_ip":"TEST_EJABBERD_SERVER_IP","turn_min_port":49152,"turn_max_port":50000,"access":"local"},{"ip":"LOCAL_EJABBERD_SERVER_IP","port":5401,"module":"ejabberd_service","hosts":{"icq.coopens.com":{"password":"123456"}},"access":"local"},{"ip":"LOCAL_EJABBERD_SERVER_IP","port":5403,"module":"ejabberd_service","hosts":{"aim.coopens.com":{"password":"123456"}},"access":"locald"},{"port":5443,"module":"ejabberd_http","tls":true,"certfile":"COOPENS_SSL_EJABBERD_CERT","dhfile":"DHPARAM_LOCATION","request_handlers":{"upload":"mod_http_upload"}}],"s2s_use_starttls":"optional","s2s_certfile":"COOPENS_SSL_EJABBERD_CERT","s2s_protocol_options":"TLS_OPTIONS","s2s_ciphers":"TLS_CIPHERS","s2s_dhfile":"DHPARAM_LOCATION","s2s_access":"authenticated","outgoing_s2s_families":["ipv4","ipv6"],"outgoing_s2s_port":5269,"outgoing_s2s_timeout":10000,"auth_method":"odbc","redis_server":"COOPENS_EJABBERD_SERVER_IP","redis_db":0,"odbc_type":"mysql","odbc_server":"localhost","odbc_database":"IM_Ejabberd","odbc_username":"zhangyanxi","odbc_password":"yanxi312","odbc_port":3306,"odbc_start_interval":20,"odbc_keepalive_interval":30,"shaper":{"normal":1000,"fast":50000},"max_fsm_queue":1000,"acl":{"admin":{"user":[{"zyf":"coopens.com"}]},"loopback":{"ip":["127.0.0.0/8"]},"local":{"user_regexp":""},"trusted_servers":{"server":["coopens.com"]},"muc_admin":{"user":[{"zyf":"coopens.com"}]},"xmlrpc_users":{"user":[{"zyf":"coopens.com"}]}},"access":{"admin":{"blocked":"deny","admin":"allow"},"everybody":{"blocked":"deny","all":"allow"},"max_user_sessions":{"admin":"infinity","anon_jabber_at":1,"all":3},"max_user_offline_messages":{"admin":2000,"anon_jabber_at":0,"all":100},"local":{"blocked":"deny","anon_jabber_at":"deny","local":"allow"},"authenticated":{"blocked":"deny","anon_jabber_at":"deny","all":"allow"},"webchat":{"blocked":"deny","local":"allow","anon_jabber_at":"allow"},"max_user_mam_messages":{"admin":0,"anon_jabber_at":0,"all":100000},"c2s":{"blocked":"deny","all":"allow"},"c2s_shaper":{"admin":"none","all":"normal"},"s2s_shaper":{"all":"fast"},"proxy_shaper":{"admin":"none","local":"proxy"},"announce":{"admin":"allow"},"configure":{"blocked":"deny","admin":"allow"},"muc_admin":{"admin":"allow"},"muc_create":{"local":"allow"},"muc":{"all":"allow"},"pubsub_createnode":{"local":"allow"},"register":{"all":"deny"},"trusted_network":{"loopback":"allow"},"xmlrpc_access":{"xmlrpc_users":"allow"}},"language":"en","host_config":{"coopens.com":{"language":"zh"}},"default_db":"odbc","modules":{"mod_adhoc":{},"mod_announce":{"access":"admin","db_type":"odbc"},"mod_blocking":{},"mod_caps":{"db_type":"odbc"},"mod_carboncopy":{},"mod_client_state":{"drop_chat_states":true,"queue_presence":true},"mod_configure":{},"mod_disco":{},"mod_echo":{},"mod_irc":{"access":"authenticated","default_encoding":"utf-8"},"mod_fail2ban":{"c2s_max_auth_failures":5},"mod_http_bind":{"max_inactivity":400},"mod_last":{"db_type":"odbc"},"mod_muc":{"access":"muc","access_create":"muc_create","access_persistent":"muc_create","access_admin":"muc_admin","db_type":"odbc","history_size":20,"max_users":200},"mod_muc_log":{"access_log":"muc","cssfile":"http://coopens.com/my.css","dirtype":"plain","dirname":"room_jid","outdir":"/data/home/yzhang/Home/www/public/muclogs","timezone":"universal","spam_prevention":true,"top_link":{"http://www.jabber.ru/":"Jabber.ru"}},"mod_muc_admin":{},"mod_admin_extra":{},"mod_offline":{"access_max_user_messages":"max_user_offline_messages","db_type":"odbc"},"mod_ping":{"send_pings":true,"ping_interval":300,"timeout_action":"kill"},"mod_pres_counter":{"count":5,"interval":60},"mod_privacy":{"db_type":"odbc"},"mod_private":{"db_type":"odbc"},"mod_proxy65":{"ip":"::","name":"File Transfer Proxy.","host":"proxy.coopens.com","hostname":"TEST_EJABBERD_SERVER_IP","port":7777,"access":"all","auth_type":"anonymous","max_connections":10,"shaper":"proxy_shaper"},"mod_http_fileserver":{"docroot":"/data/home/yzhang/Home/www/public/ejabberd/www","accesslog":"/var/log/ejabberd/access.log","directory_indices":["index.html","main.htm"],"custom_headers":{"X-Powered-By":"Erlang/OTP","X-Fry":"It's a widely-believed fact!"},"content_types":{".ogg":"audio/ogg",".png":"image/png"},"default_content_type":"text/html"},"mod_http_upload":{"docroot":"/data/home/yzhang/Home/www/public/ejabberd/upload","put_url":"https://@HOST@:5443/upload","thumbnail":true,"rm_on_unregister":false},"mod_http_upload_quota":{"max_days":100},"mod_mam":{"default":"always","db_type":"odbc"},"mod_pubsub":{"db_type":"odbc","access_createnode":"pubsub_createnode","ignore_pep_from_offline":true,"last_item_cache":false,"max_items_node":1000,"pep_mapping":{"http://jabber.org/protocol/tune":"tune"},"plugins":["flat","hometree","pep"]},"mod_register":{"welcome_message":{"subject":"Welcome!","body":"Hi.\nWelcome to this XMPP server."},"ip_access":"trusted_network","access_from":"register"},"mod_roster":{"versioning":true,"db_type":"odbc","store_current_id":true},"mod_shared_roster":{"db_type":"odbc"},"mod_stats":{},"mod_time":{},"mod_vcard":{"search":true,"db_type":"odbc"},"mod_vcard_xupdate":{"db_type":"odbc"},"mod_version":{"show_os":true,"iqdisc":"parallel"}},"sm_db_type":"odbc","allow_contrib_modules":true}
      
    </div>
    
    <div class="article-info article-info-index">
      
      

      
      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>








  
    <article id="post-Java/JavaNote" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2016/01/14/Java/JavaNote/" class="article-date">
      <time datetime="2016-01-14T10:02:31.000Z" itemprop="datePublished">2016-01-14</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/01/14/Java/JavaNote/">JavaNote</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
              <h1 id="Java__u76F8_u5173_u7B14_u8BB0"><a href="#Java__u76F8_u5173_u7B14_u8BB0" class="headerlink" title="Java 相关笔记"></a>Java 相关笔记</h1>
          
      
    </div>
    
    <div class="article-info article-info-index">
      
      

      
      
        <p class="article-more-link">
          <a  href="/2016/01/14/Java/JavaNote/#more">more >></a>
        </p>
      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>








  
    <article id="post-Python/PythonNote" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2016/01/13/Python/PythonNote/" class="article-date">
      <time datetime="2016-01-13T09:11:31.000Z" itemprop="datePublished">2016-01-13</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/01/13/Python/PythonNote/">PythonNote</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
              <h1 id="Python__u7B14_u8BB0"><a href="#Python__u7B14_u8BB0" class="headerlink" title="Python 笔记"></a>Python 笔记</h1><p><a href="https://pycoders-weekly-chinese.readthedocs.org/en/latest/">PyCoder’s Weekly 中文翻译</a><br>
          
      
    </div>
    
    <div class="article-info article-info-index">
      
      

      
      
        <p class="article-more-link">
          <a  href="/2016/01/13/Python/PythonNote/#more">more >></a>
        </p>
      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>








  
    <article id="post-Server/Ejabberd" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2016/01/10/Server/Ejabberd/" class="article-date">
      <time datetime="2016-01-10T11:45:31.000Z" itemprop="datePublished">2016-01-10</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/01/10/Server/Ejabberd/">Ejabberd Install</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <h3 id="u4E00_u3001_u7F16_u8BD1_u5B89_u88C5"><a href="#u4E00_u3001_u7F16_u8BD1_u5B89_u88C5" class="headerlink" title="一、编译安装"></a>一、编译安装</h3><h5 id="1-__u9996_u5148_u5B89_u88C5_u76F8_u5173_u4F9D_u8D56"><a href="#1-__u9996_u5148_u5B89_u88C5_u76F8_u5173_u4F9D_u8D56" class="headerlink" title="1. 首先安装相关依赖"></a>1. 首先安装相关依赖</h5><p>ejabberd 需要安装 Erlang 运行环境,否则编译会出错 </p>
<p>下载 ejabberd 源码,编译安装:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">git <span class="built_in">clone</span> https://github.com/processone/ejabberd.git</span><br><span class="line">./autogen.sh</span><br><span class="line">./configure --enable-odbc --enable-mysql --enable-json</span><br><span class="line"><span class="comment"># ./configure --prefix=/Users/allran/SDK/chart/my-ejabberd --enable-mysql        //附加mysql</span></span><br><span class="line"><span class="comment"># ./configure --prefix=/Users/allran/SDK/chart/my-ejabberd --enable-all     //附加所有</span></span><br><span class="line">./rebar get-deps</span><br><span class="line">./rebar compile</span><br><span class="line">make</span><br><span class="line">sudo make install</span><br></pre></td></tr></table></figure>
<p>将会分别安装到以下相关目录:</p>
<figure class="highlight crystal"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">配置文件 /etc/ejabberd/</span><br><span class="line"><span class="constant">Install</span> ejabberd binary, header and runtime files in /<span class="class"><span class="keyword">lib</span>/<span class="title">ejabberd</span>/</span></span><br><span class="line"><span class="constant">Install</span> the administration <span class="symbol">script:</span> /sbin/ejabberdctl</span><br><span class="line">ejabberd 帮助文档 /share/doc/ejabberd/</span><br><span class="line"><span class="constant">Create</span> a spool <span class="symbol">directory:</span> /var/<span class="class"><span class="keyword">lib</span>/<span class="title">ejabberd</span>/</span></span><br><span class="line">日志文件: <span class="regexp">/var/log</span><span class="regexp">/ejabberd/</span></span><br></pre></td></tr></table></figure>
<blockquote>
<p>注:如果安装失败,清除掉痕迹: make distclean</p>
<p>编译安装中出现的错误:</p>
</blockquote>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">configure: error: libyaml <span class="tag">header</span> file yaml<span class="class">.h</span> was not found</span><br><span class="line">ERROR: Command [<span class="string">'get-deps'</span>] failed!</span><br></pre></td></tr></table></figure>
<p>需要安装 yaml 依赖</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">wget http:<span class="comment">//pyyaml.org/download/libyaml/yaml-0.1.6.tar.gz</span></span><br><span class="line">tar -xzvf yaml-<span class="number">0.1</span><span class="number">.6</span>.tar.gz</span><br><span class="line">cd yaml-<span class="number">0.1</span><span class="number">.6</span></span><br><span class="line">./configure</span><br><span class="line">make</span><br><span class="line">make install</span><br></pre></td></tr></table></figure>
<p>// 或者也可以简单方法 ,但是没试过<br>// 参考 <a href="http://stackoverflow.com/questions/25425068/ejabberd-configure-error-libyaml-library-was-not-found" target="_blank" rel="external">http://stackoverflow.com/questions/25425068/ejabberd-configure-error-libyaml-library-was-not-found</a></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-get install libyaml-dev</span><br></pre></td></tr></table></figure>
<p><a href="https://github.com/processone/ejabberd" target="_blank" rel="external">ejabberd GitHub 官方说明</a><br><a href="https://www.ejabberd.im/node/22230" target="_blank" rel="external">ERROR: Command [‘get-deps’] failed!</a></p>
<hr>
<h2 id="Ejabberd__u6DFB_u52A0_u4F9D_u8D56"><a href="#Ejabberd__u6DFB_u52A0_u4F9D_u8D56" class="headerlink" title="Ejabberd 添加依赖"></a>Ejabberd 添加依赖</h2><h3 id="emysql"><a href="#emysql" class="headerlink" title="emysql"></a>emysql</h3><blockquote>
<p>配置 rebar.config</p>
</blockquote>
<figure class="highlight erlang"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">Deps</span> = [</span><br><span class="line">    ...</span><br><span class="line">    <span class="tuple">&#123;emysql, <span class="string">".*"</span>, <span class="tuple">&#123;git, <span class="string">"git://github.com/Eonblast/Emysql.git"</span>&#125;</span>&#125;</span></span><br><span class="line">],</span><br></pre></td></tr></table></figure>
<p>加入 emaysql 编译出现错误</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Compiled src/emysql_worker.erl</span><br><span class="line">/data/home/yzhang/Home/Erlang/ejabberd/deps/emysql/include/emysql.hrl:<span class="number">38</span>: <span class="built_in">type</span> gb_tree() undefined</span><br><span class="line">/data/home/yzhang/Home/Erlang/ejabberd/deps/emysql/include/emysql.hrl:<span class="number">39</span>: <span class="built_in">type</span> queue() undefined</span><br><span class="line">ERROR: compile failed <span class="keyword">while</span> processing /data/home/yzhang/Home/Erlang/ejabberd/deps/emysql: rebar_abort</span><br><span class="line">make: *** [deps/.built] Error <span class="number">1</span></span><br></pre></td></tr></table></figure>
<p>原因是 emysql 暂时没有更新到 otp18 的支持<br>fork emysql 修改部分参见 <a href="https://github.com/deadtrickster/Emysql/commit/52b802098322aad372198b9f5fa9ae9a4c758ad1" target="_blank" rel="external">https://github.com/deadtrickster/Emysql/commit/52b802098322aad372198b9f5fa9ae9a4c758ad1</a> 修改 Deps 并重新编译 ejabberd</p>
<figure class="highlight erlang"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tuple">&#123;emysql, <span class="string">".*"</span>, <span class="tuple">&#123;git, <span class="string">"https://github.com/zyfmix/Emysql.git"</span>&#125;</span>&#125;</span></span><br></pre></td></tr></table></figure>
<hr>
<hr>
<h3 id="u4E09_u3001_u542F_u7528mysql_u652F_u6301"><a href="#u4E09_u3001_u542F_u7528mysql_u652F_u6301" class="headerlink" title="三、启用mysql支持"></a>三、启用mysql支持</h3><p>编译时使用扩展参数</p>
<figure class="highlight brainfuck"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">.</span><span class="comment">/configure</span> <span class="literal">-</span><span class="literal">-</span><span class="comment">enable</span><span class="literal">-</span><span class="comment">odbc</span> <span class="literal">-</span><span class="literal">-</span><span class="comment">enable</span><span class="literal">-</span><span class="comment">mysql</span></span><br></pre></td></tr></table></figure>
<p>如果提示以下错误:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">failed to start application <span class="string">'p1_mysql'</span>: &#123;error,</span><br><span class="line">                                         &#123;<span class="string">"no such file or directory"</span>,</span><br><span class="line">                                          <span class="string">"p1_mysql.app"</span>&#125;&#125;</span><br></pre></td></tr></table></figure>
<p>表示mysql依赖驱动未加载,修改 rebar.config.script 第88行,添加 p1_mysql 的依赖(注意 “1”为数字1,不是字母l):</p>
<p>照做会出现其他问题,后来只修改了 第 88 行,然后再执行以下命令引入依赖,没有报错.</p>
<figure class="highlight actionscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./rebar <span class="keyword">get</span>-deps</span><br></pre></td></tr></table></figure>
<p>新建数据库 IM_Ejabberd 按官方的源码,导入 /sql/mysql.sql </p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> <span class="variable">$HOME</span>/RunProject/ejabberd/sql/</span><br><span class="line">mysql -u zhangyanxi -p</span><br><span class="line">...</span><br><span class="line">mysql:&gt; use IM_Ejabberd  </span><br><span class="line">mysql:&gt;<span class="built_in">source</span> mysql.sql;</span><br></pre></td></tr></table></figure>
<p>配置文件 /etc/ejabberd/ejabberd.yml 的修改,主要包括:</p>
<figure class="highlight avrasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="preprocessor">#auth_method: internal.</span></span><br><span class="line"><span class="label">auth_method:</span> odbc.</span><br></pre></td></tr></table></figure>
<p>取消注释并设置数据库名称和密码: </p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">odbc_type</span>: <span class="string">mysql</span></span><br><span class="line"><span class="attribute">odbc_server</span>: <span class="string">"localhost"</span></span><br><span class="line"><span class="attribute">odbc_database</span>: <span class="string">"IM_Ejabberd"</span></span><br><span class="line"><span class="attribute">odbc_username</span>: <span class="string">"zhangyanxi"</span></span><br><span class="line"><span class="attribute">odbc_password</span>: <span class="string">"yanxi312"</span></span><br></pre></td></tr></table></figure>
<p>重启 </p>
<figure class="highlight crmsh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">ejabberdctl live </span><br><span class="line">...</span><br><span class="line"><span class="number">19</span>:<span class="number">17</span>:<span class="number">55.853</span> [<span class="number">inf</span>o] Application p1_mysql <span class="literal">started</span> on <span class="keyword">node</span><span class="identifier"> </span><span class="title">'ejabberd</span>@coopens.com'</span><br><span class="line">...</span><br></pre></td></tr></table></figure>
<p>没有报错,在启动日志看到上面那条 p1_mysql 记录,表示 ejabberd 服务器使用了新的数据库,这个时候数据库里边的数据全部为 0 条,使用命令</p>
<figure class="highlight gherkin"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo ejabberdctl register zyfmix coopens.com <span class="keyword">*</span><span class="keyword">*</span><span class="keyword">*</span><span class="keyword">*</span><span class="keyword">*</span><span class="keyword">*</span></span><br></pre></td></tr></table></figure>
<p>注册用户后,发现数据库表 users 已经有了新添加的用户记录:</p>
<p>根据网上介绍的配置经验:</p>
<p>新版的下面的模块配置项不用修改(添加_odbc),否则会报错</p>
<p><a href="http://allran.github.io/2015/04/15/ejabberd-install/" target="_blank" rel="external">木头人 - ejabberd install</a><br><a href="http://developerworks.github.io/2015/03/17/ejabberd-easy-installer-and-structure-for-ejabberd-contributed-modules/" target="_blank" rel="external">Ejabberd模块安装工具</a></p>
<hr>
<h4 id="Ejabberd_mnesia__u8FDC_u7A0B_u8FDE_u63A5"><a href="#Ejabberd_mnesia__u8FDC_u7A0B_u8FDE_u63A5" class="headerlink" title="Ejabberd mnesia 远程连接"></a>Ejabberd mnesia 远程连接</h4><blockquote>
<p>使用 observer 远程连接 mnesia 数据库</p>
<p>ejabberd mnesia 服务器</p>
</blockquote>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ erl -name <span class="string">'ejabberd@coopens.com'</span> -mnesia dir <span class="string">'"/var/lib/ejabberd"'</span> (ip为本机的ip,必须,否则不能ping通)</span><br><span class="line">(ejabberd@coopens.com)<span class="number">1</span>&gt; auth:get_cookie(). (获取cookie,或者 erlang:get_cookie(). )</span><br><span class="line">(ejabberd@coopens.com)<span class="number">2</span>&gt; <span class="string">'JCNBOQTVXCDZNLCRJQUI'</span></span><br></pre></td></tr></table></figure>
<blockquote>
<p>复制cookie,然后在本机上操作:</p>
</blockquote>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">$ erl -name yafei@<span class="number">192.168</span>.<span class="number">1.102</span> -setcookie JCNBOQTVXCDZNLCRJQUI</span><br><span class="line">(yafei@<span class="number">192.168</span>.<span class="number">1.102</span>)<span class="number">1</span>&gt; net_adm:ping(<span class="string">'ejabberd@coopens.com'</span>).</span><br><span class="line">(yafei@<span class="number">192.168</span>.<span class="number">1.102</span>)<span class="number">2</span>&gt; pong</span><br><span class="line">(yafei@<span class="number">192.168</span>.<span class="number">1.102</span>)<span class="number">3</span>&gt; observer:start().</span><br></pre></td></tr></table></figure>
<p>参考列表</p>
<p><a href="http://www.cnblogs.com/lovechengcheng/p/5052403.html" target="_blank" rel="external">远程连接ejabberd的mnesia数据库</a><br><a href="http://blog.csdn.net/mycwq/article/details/24738599" target="_blank" rel="external">erlang在windows下和虚拟机节点通信</a></p>
<hr>
<hr>
<h2 id="Ejabberd__u670D_u52A1_u5668_u8FD0_u8425_u5E38_u89C1_u95EE_u9898_u89E3_u51B3"><a href="#Ejabberd__u670D_u52A1_u5668_u8FD0_u8425_u5E38_u89C1_u95EE_u9898_u89E3_u51B3" class="headerlink" title="Ejabberd 服务器运营常见问题解决"></a>Ejabberd 服务器运营常见问题解决</h2><h4 id="u4F7F_u7528_u547D_u4EE4_sudo_ejabberdctl_status__u67E5_u770B_ejabberd__u8FD0_u884C_u72B6_u6001_u6216_u662F_u8FD0_u884C_u5176_u5B83_u547D_u4EE4__5Bsudo_ejabberdctl_modules_available_5D_2C_u53D1_u73B0_u8001_u662F_u63D0_u793A_u9519_u8BEF_3A"><a href="#u4F7F_u7528_u547D_u4EE4_sudo_ejabberdctl_status__u67E5_u770B_ejabberd__u8FD0_u884C_u72B6_u6001_u6216_u662F_u8FD0_u884C_u5176_u5B83_u547D_u4EE4__5Bsudo_ejabberdctl_modules_available_5D_2C_u53D1_u73B0_u8001_u662F_u63D0_u793A_u9519_u8BEF_3A" class="headerlink" title="使用命令 sudo ejabberdctl status 查看 ejabberd 运行状态或是运行其它命令 [sudo ejabberdctl modules_available],发现老是提示错误:"></a>使用命令 sudo ejabberdctl status 查看 ejabberd 运行状态或是运行其它命令 [sudo ejabberdctl modules_available],发现老是提示错误:</h4><figure class="highlight crmsh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Failed RPC connection to the <span class="keyword">node</span><span class="identifier"> </span><span class="title">'ejabberd</span>@coopens.com': nodedown</span><br></pre></td></tr></table></figure>
<p>一般是 ejabberd 服务未运行,启动 ejabberd 服务即可.</p>
<p>也有一种情况是 ejabberdctl.cfg 配置 不正确(不是 *@coopens.com ).或者 /etc/ejabberd/ejabberdctl.cfg 已经是配置的 coopens.com ,并且当前 ejabberd 服务器节点正在运行,估计未销毁之前的 ejabberd 关联 epmd 进程,检查并关闭如下端口的进程:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">sudo netstat -antup | grep epmd</span><br><span class="line">sudo <span class="built_in">kill</span> pid</span><br><span class="line">sudo netstat -antup | grep beam.smp</span><br><span class="line">sudo <span class="built_in">kill</span> pid</span><br></pre></td></tr></table></figure>
<p>其中 epmd 是 Erlang Port Mapper Daemon 的缩写,全称足够明确表达它的功能了(相比之下,OTP就是一个难以从字面理解的名字);epmd 完成 Erlang 节点和IP,端口的映射关系,比如在我的测试机上</p>
<p>再使用命令 sudo ejabberdctl restart 重启即可重新打开 ejabberd 进程服务即可</p>
<hr>

      
    </div>
    
    <div class="article-info article-info-index">
      
      

      
      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>








  
  
    <nav id="page-nav">
      <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><a class="page-number" href="/page/3/">3</a><span class="space">&hellip;</span><a class="page-number" href="/page/7/">7</a><a class="extend next" rel="next" href="/page/2/">Next &raquo;</a>
    </nav>
  
</div>
      <footer id="footer">
    <div class="outer">
        <div id="footer-info">
            <div class="footer-left">
                &copy; 2016 张亚飞
            </div>
            <div class="footer-right">
                <a href="http://hexo.io/" target="_blank" title="快速、简洁且高效的静态博客框架">Hexo</a>  Theme <a href="https://github.com/MOxFIVE/hexo-theme-yelee" target="_blank" title="简而不减双栏 Hexo 博客主题">Yelee</a> by MOxFIVE
            </div>
        </div>
        <div class="visit">
            <span id="busuanzi_container_site_pv" style='display:none'>
                <span id="site-visit" >本站到访数: 
                    <span id="busuanzi_value_site_uv"></span>
                </span>
            </span>
            <span id="busuanzi_container_page_pv" style='display:none'>
                <span id="page-visit">, 本页阅读量: 
                    <span id="busuanzi_value_page_pv"></span>
                </span>
            </span>
        </div>
    </div>
</footer>
    </div>
    <script src="http://7.url.cn/edu/jslib/comb/require-2.1.6,jquery-1.9.1.min.js" type="text/javascript"></script>
<script src="/js/main.js" type="text/javascript"></script>

    <script>
        $(document).ready(function() {
            var iPad = window.navigator.userAgent.indexOf('iPad');
            if (iPad > -1 || $(".left-col").css("display") === "none") {
                var bgColorList = ["#9db3f4", "#414141", "#e5a859", "#f5dfc6", "#c084a0", "#847e72", "#cd8390", "#996731"];
                var bgColor = Math.ceil(Math.random() * (bgColorList.length - 1));
                $("body").css({"background-color": bgColorList[bgColor], "background-size": "cover"});
            }
            else {
                var backgroundnum = 5;
                var backgroundimg = "url(/background/bg-x.jpg)".replace(/x/gi, Math.ceil(Math.random() * backgroundnum));
                $("body").css({"background": backgroundimg, "background-attachment": "fixed", "background-size": "cover"});
            }
        })
    </script>




<div class="scroll" id="scroll">
    <a href="#" title="返回顶部"><i class="fa fa-arrow-up"></i></a>
    <a href="#comments" title="查看评论"><i class="fa fa-comments-o"></i></a>
    <a href="#footer" title="转到底部"><i class="fa fa-arrow-down"></i></a>
</div>

<script>
    $(document).ready(function() {
        if ($("#comments").length < 1) {
            $("#scroll > a:nth-child(2)").hide();
        };
    })
</script>

<script async src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js">
</script>
  </div>
</body>
</html>