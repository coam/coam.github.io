<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>关于 XMPP 协议 | 商运物流</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="关于 XMPP 协议XMPP 扩展协议标准Ejabberd 中文翻译文档上面的 关于 Ejabberd 使用的协议介绍

XMPP 免费服务器列表
比较好的公共服务器
xmpp.jp
XMPP 客户端

PC端肯定要推荐一些比较经典的啦,诸如Pidgin、Empathy、Kopete、Miranda IM(只支持Windows)或Adium(只支持Mac OS X)这样的都可以很好的兼容XMPP/">
<meta property="og:type" content="article">
<meta property="og:title" content="关于 XMPP 协议">
<meta property="og:url" content="https://coam.co/2016/01/03/XMPP/index.html">
<meta property="og:site_name" content="商运物流">
<meta property="og:description" content="关于 XMPP 协议XMPP 扩展协议标准Ejabberd 中文翻译文档上面的 关于 Ejabberd 使用的协议介绍

XMPP 免费服务器列表
比较好的公共服务器
xmpp.jp
XMPP 客户端

PC端肯定要推荐一些比较经典的啦,诸如Pidgin、Empathy、Kopete、Miranda IM(只支持Windows)或Adium(只支持Mac OS X)这样的都可以很好的兼容XMPP/">
<meta property="og:updated_time" content="2016-01-07T12:38:18.640Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="关于 XMPP 协议">
<meta name="twitter:description" content="关于 XMPP 协议XMPP 扩展协议标准Ejabberd 中文翻译文档上面的 关于 Ejabberd 使用的协议介绍

XMPP 免费服务器列表
比较好的公共服务器
xmpp.jp
XMPP 客户端

PC端肯定要推荐一些比较经典的啦,诸如Pidgin、Empathy、Kopete、Miranda IM(只支持Windows)或Adium(只支持Mac OS X)这样的都可以很好的兼容XMPP/">
  
    <link rel="alternative" href="/atom.xml" title="商运物流" type="application/atom+xml">
  
  
    <link rel="icon" href="/img/favicon.png">
  
  
  <link rel="stylesheet" href="//cdn.bootcss.com/animate.css/3.5.0/animate.min.css" type="text/css">
  
  <link rel="stylesheet" href="/css/style.css" type="text/css">
  <link rel="stylesheet" href="/font-awesome/css/font-awesome.min.css">
  <link rel="apple-touch-icon" href="/apple-touch-icon.png">
  
  
      <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
  
  <script>
      var yiliaConfig = {
          fancybox: true,
          animate: true,
          isHome: false,
          isPost: true,
          isArchive: false,
          isTag: false,
          isCategory: false,
          open_in_new: false
      }
  </script>
</head>
<body>
  <div id="container">
    <div class="left-col">
    <div class="overlay"></div>
<div class="intrude-less">
    <header id="header" class="inner">
        <a href="/" class="profilepic">
            
            <img lazy-src="/img/author.jpg" class="js-avatar">
            
        </a>

        <hgroup>
          <h1 class="header-author"><a href="/">张亚飞</a></h1>
        </hgroup>

        
                


        
            <div id="switch-btn" class="switch-btn">
                <div class="icon">
                    <div class="icon-ctn">
                        <div class="icon-wrap icon-house" data-idx="0">
                            <div class="birdhouse"></div>
                            <div class="birdhouse_holes"></div>
                        </div>
                        <div class="icon-wrap icon-ribbon hide" data-idx="1">
                            <div class="ribbon"></div>
                        </div>
                        
                        <div class="icon-wrap icon-link hide" data-idx="2">
                            <div class="loopback_l"></div>
                            <div class="loopback_r"></div>
                        </div>
                        
                        
                        <div class="icon-wrap icon-me hide" data-idx="3">
                            <div class="user"></div>
                            <div class="shoulder"></div>
                        </div>
                        
                    </div>
                    
                </div>
                <div class="tips-box hide">
                    <div class="tips-arrow"></div>
                    <ul class="tips-inner">
                        <li>菜单</li>
                        <li>标签</li>
                        
                        <li>友情链接</li>
                        
                        
                        <li>关于我</li>
                        
                    </ul>
                </div>
            </div>
        

        <div id="switch-area" class="switch-area">
            <div class="switch-wrap">
                <section class="switch-part switch-part1">
                    <nav class="header-menu">
                        <ul>
                        
                            <li><a href="/">主页</a></li>
                        
                            <li><a href="/archives/">所有文章</a></li>
                        
                            <li><a href="/tags/">标签云</a></li>
                        
                            <li><a href="/about/">关于我</a></li>
                        
                        </ul>
                    </nav>
                    <nav class="header-nav">
                        <ul class="social">
                            
                                <li id="Email"><a class="Email" target="_blank" href="mailto:zyf@lonal.com" title="Email"></a></li>
                            
                                <li id="GitHub"><a class="GitHub" target="_blank" href="https://github.com/zyfmix" title="GitHub"></a></li>
                            
                                <li id="RSS"><a class="RSS" target="_blank" href="/atom.xml" title="RSS"></a></li>
                            
                        </ul>
                    </nav>
                </section>
                
                
                <section class="switch-part switch-part2">
                    <div class="widget tagcloud" id="js-tagcloud">
                        <a href="/tags/hexo/" style="font-size: 20px;">hexo</a> <a href="/tags/markdown-gfw-hexo-jekyll/" style="font-size: 10px;">markdown gfw hexo jekyll</a>
                    </div>
                </section>
                
                
                
                <section class="switch-part switch-part3">
                    <div id="js-friends">
                    
                      <a target="_blank" class="main-nav-link switch-friends-link" href="https://coam.co">商运物流</a>
                    
                      <a target="_blank" class="main-nav-link switch-friends-link" href="https://github.com/zyfmix/">GitHub</a>
                    
                      <a target="_blank" class="main-nav-link switch-friends-link" href="https://wp.iirii.com/">商运技术博客</a>
                    
                    </div>
                </section>
                

                
                
                <section class="switch-part switch-part4">
                
                    <div id="js-aboutme">专注于物流设计</div>
                </section>
                
            </div>
        </div>
    </header>                
</div>
    </div>
    <div class="mid-col">
      <nav id="mobile-nav">
      <div class="overlay">
          <div class="slider-trigger"></div>
          <h1 class="header-author js-mobile-header hide"><a href="/" title="回到主页">张亚飞</a></h1>
      </div>
    <div class="intrude-less">
        <header id="header" class="inner">
            <a href="/" class="profilepic">
                <img lazy-src="/img/author.jpg" class="js-avatar">
            </a>
            <hgroup>
              <h1 class="header-author"><a href="/" title="回到主页">张亚飞</a></h1>
            </hgroup>
            
            <nav class="header-menu">
                <ul>
                
                    <li><a href="/">主页</a></li>
                
                    <li><a href="/archives/">所有文章</a></li>
                
                    <li><a href="/tags/">标签云</a></li>
                
                    <li><a href="/about/">关于我</a></li>
                
                <div class="clearfix"></div>
                </ul>
            </nav>
            <nav class="header-nav">
                        <ul class="social">
                            
                                <li id="Email"><a class="Email" target="_blank" href="mailto:zyf@lonal.com" title="Email"></a></li>
                            
                                <li id="GitHub"><a class="GitHub" target="_blank" href="https://github.com/zyfmix" title="GitHub"></a></li>
                            
                                <li id="RSS"><a class="RSS" target="_blank" href="/atom.xml" title="RSS"></a></li>
                            
                        </ul>
            </nav>
        </header>                
    </div>
</nav>
      <div class="body-wrap"><article id="post-XMPP" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2016/01/03/XMPP/" class="article-date">
      <time datetime="2016-01-03T12:52:05.000Z" itemprop="datePublished">2016-01-03</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      关于 XMPP 协议
    </h1>
  

      </header>
      
      <div class="article-info article-info-post">
        

        
    <div class="article-tag tagcloud">
        <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/hexo/">hexo</a></li></ul>
    </div>

        <div class="clearfix"></div>
      </div>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <h3 id="u5173_u4E8E_XMPP__u534F_u8BAE"><a href="#u5173_u4E8E_XMPP__u534F_u8BAE" class="headerlink" title="关于 XMPP 协议"></a>关于 XMPP 协议</h3><p><a href="http://xmpp.org/xmpp-protocols/xmpp-extensions/" target="_blank" rel="external">XMPP 扩展协议标准</a><br><a href="http://wiki.jabbercn.org/XEP-0045" target="_blank" rel="external">Ejabberd 中文翻译文档上面的 关于 Ejabberd 使用的协议介绍</a></p>
<hr>
<p><a href="https://xmpp.net/directory.php" target="_blank" rel="external">XMPP 免费服务器列表</a></p>
<p>比较好的公共服务器</p>
<p><a href="https://www.xmpp.jp/signup" target="_blank" rel="external">xmpp.jp</a></p>
<p>XMPP 客户端</p>
<blockquote>
<p>PC端肯定要推荐一些比较经典的啦,诸如Pidgin、Empathy、Kopete、Miranda IM(只支持Windows)或Adium(只支持Mac OS X)这样的都可以很好的兼容XMPP/Jabber协议,<br>不过呢还有一些专门的客户端软件,比如 Gajim和Psi+(这是Psi的升级版,增加了更多功能)这样的XMPP专业工具.<br>类似Pidgin这样大而全的软件可以很好的支持XMPP几乎所有的功能(通过各种插件).<br>而专有的软件则可以更加专注于协议的实现,更加完善,也更加富有使用的优势,特别是需要加密聊天比如OTR和PGP这样的时候,专攻XMPP协议的这些客户端就更方便可靠了.<br>当然还有命令行下的软件,mcabber是专门设计给XMPP/Jabber使用的,可以非常方便的提供OTR和PGP加密聊天.</p>
</blockquote>
<a id="more"></a>
<h4 id="Android__u5F00_u6E90_u5BA2_u6237_u7AEF"><a href="#Android__u5F00_u6E90_u5BA2_u6237_u7AEF" class="headerlink" title="Android 开源客户端"></a>Android 开源客户端</h4><p><a href="https://github.com/siacs/Conversations" target="_blank" rel="external">Conversations</a><br><a href="https://github.com/guardianproject/ChatSecureAndroid" target="_blank" rel="external">ChatSecureAndroid</a><br><a href="https://github.com/pfleidi/yaxim" target="_blank" rel="external">yaxim</a></p>
<hr>
<h4 id="1_2CXMPP__u7684_u4E09_u79CD_u57FA_u672C_u89D2_u8272_3A_u5BA2_u6237_u7AEF_u3001_u670D_u52A1_u5668_u548C_u7F51_u5173"><a href="#1_2CXMPP__u7684_u4E09_u79CD_u57FA_u672C_u89D2_u8272_3A_u5BA2_u6237_u7AEF_u3001_u670D_u52A1_u5668_u548C_u7F51_u5173" class="headerlink" title="1,XMPP 的三种基本角色:客户端、服务器和网关"></a>1,XMPP 的三种基本角色:客户端、服务器和网关</h4><blockquote>
<p>通信能够在这三者的任意两个之间双向发生.服务器端同时承担了客户端信息记录、连接管理和信息路由的功能.网关则承担着与异构系统的互联互通功能.在 RFC 3920 XMPP Core 中对 XMPP 网络结构有一个描述:</p>
</blockquote>
<pre><code>C1----S1---S2—C3
     |
C2----+--G1===FN1===FC1
</code></pre><p>这里 C1,C2,C3 表示 XMPP 客户端;S1,S2 表示 XMPP 服务器;G1 表示网关,用来负责 XMPP 协议和外部聊天协议的转换;FN1 表示外部消息网络的服务器,FC1 表示外部网络客户端.</p>
<h5 id="u670D_u52A1_u5668__u5145_u5F53xmpp_u901A_u4FE1_u7684_u4E00_u4E2A_u667A_u80FD_u62BD_u8C61_u5C42_uFF0C_u8D1F_u8D23"><a href="#u670D_u52A1_u5668__u5145_u5F53xmpp_u901A_u4FE1_u7684_u4E00_u4E2A_u667A_u80FD_u62BD_u8C61_u5C42_uFF0C_u8D1F_u8D23" class="headerlink" title="服务器 充当xmpp通信的一个智能抽象层，负责"></a>服务器 充当xmpp通信的一个智能抽象层，负责</h5><blockquote>
<p>对受验证的客户端，服务器以及其他实体之间以xml流的形式的连接和会话进行管理。在这些实体间使用xml流对合理编址的xml节进行路由存储和处理客户端使用的数据</p>
</blockquote>
<h5 id="u5BA2_u6237_u7AEF"><a href="#u5BA2_u6237_u7AEF" class="headerlink" title="客户端"></a>客户端</h5><blockquote>
<p>通过TCP连接直接连接到服务器，并通过xmpp获得由服务器以及联合服务器所提供的全部功能。多个不同的客户端可以同时登陆并且并发的连接到一个服务器，每个不同资源的客户端通过xmpp地址的资源标识符来区分。建议的客户端和服务器连接的端口时5222</p>
</blockquote>
<h5 id="u7F51_u5173"><a href="#u7F51_u5173" class="headerlink" title="网关"></a>网关</h5><blockquote>
<p>网关是一个特殊用途的服务器端的服务，主要功能是把xmpp翻译成外部消息系统，并把返回的消息翻译成xmpp.</p>
</blockquote>
<p>大家可能会奇怪,这里为什么需要一个网关呢.这要从 XMPP 的来源说起.1996 年 Mirabilis 公司推出了世界上第一个即时通信系统 ICQ,不到 10 年,IM 就成了最流行的应用之一,MSN、Gtalk、雅虎即时通、AIM、Adium、Pidgin 等各种软件如雨后春笋般涌现,<br>但是这些服务之间没有统一的标准,不能互联互通,XMPP 的设计目的就是为了实现整个及时通信服务协议的互通,让 IM 成为继 WEB 和 Email 之后的互联网第三大服务.</p>
<h4 id="2_2CXMPP__u7684_u6D88_u606F_u683C_u5F0F"><a href="#2_2CXMPP__u7684_u6D88_u606F_u683C_u5F0F" class="headerlink" title="2,XMPP 的消息格式."></a>2,XMPP 的消息格式.</h4><blockquote>
<p>XMPP 协议的所有消息都是 XML 格式的,这是 XMPP 协议的另一个充满历史意味的选择,想当年 SOA / SOAP 一时间爆发起来,很多消息交换协议都采用了 XML 格式,但是不想 XML 很快就成了「大数据」的代名词.<br> 在 RFC 3920 XMPP Core 中定义了两个基础概念,XML Stream 和 XML Stanza,XML Stream 是两个节点之间进行数据交换的容器,它定义了顶层的XML节点 ;XML Stanza 则定义了实体消息的具体语义单元,在 XMPP 中定义了 3 个顶层消息:</p>
</blockquote>
<h5 id="2-1_Presence__u8054_u673A_u72B6_u6001"><a href="#2-1_Presence__u8054_u673A_u72B6_u6001" class="headerlink" title="2.1 Presence 联机状态"></a>2.1 Presence 联机状态</h5><blockquote>
<p>联机状态,它允许用户广播其在线状态和可用性；元素用来传递一个用户的存在状态的感知信息.用户可以是”available”,要么是”unavailable”,”Hide”等.当用户连接到即时消息服务器后,好友发给他的消息就立即被传递.<br>如果用户没有连接到服务器,好友发给他的消息将被服务器存储起来直到用户连接到服务器.<br> 用户通过即时消息客户端自己控制可用性.但是,如果用户断开了同服务器的连接,服务器将发送给订阅了这个用户的存在信息的用户通知他们用户已经不可用.还包含了两个子元素:和.包含了一个对的文本描述.<br>用于确定用户的状态.消息结构举例如下(每个 XML 的 node 还会有很多其他 attribute,为了简单起见这里省略,下同):</p>
</blockquote>
<pre><code>&lt;presence from=&quot;abc@jabber.org/contact&quot; to=&quot;def@jabber.org/contact&quot;&gt;
    &lt;status&gt;online&lt;/status&gt;
&lt;/presence&gt;
</code></pre><h5 id="2-2_Message__u6D88_u606F_u4F20_u9012"><a href="#2-2_Message__u6D88_u606F_u4F20_u9012" class="headerlink" title="2.2 Message 消息传递"></a>2.2 Message 消息传递</h5><blockquote>
<p>消息传递,其中数据在有关各方之间传输；一个即时消息系统最基本的功能就是能够在两个用户之间实时交换消息,元素就提供了这个功能.每条消息都有一个或多个属性和子元素.属性”from”和”to”分别表示了消息发送者和接收者的地址.<br> 也可以包含一个”type”属性,这给接收者一个提示,这个消息是什么样的消息.表3-1给出了”type”属性的可能取值.中也可以包含”id”属性,用来唯一的标识一个输出消息的响应.<br>用于在两个用户之间发送消息.消息结构举例如下:</p>
</blockquote>
<pre><code>&lt;message from=&quot;abc@jabber.org/contact&quot; to=&quot;def@jabber.org/contact&quot; type=&quot;chat&quot;&gt;
    &lt;body&gt;hello&lt;/body&gt;
&lt;/message&gt;
</code></pre><h5 id="2-3_IQ__u4FE1_u606F/_u67E5_u8BE2_u8BF7_u6C42"><a href="#2-3_IQ__u4FE1_u606F/_u67E5_u8BE2_u8BF7_u6C42" class="headerlink" title="2.3 IQ 信息/查询请求"></a>2.3 IQ 信息/查询请求</h5><blockquote>
<p>信息/查询请求,它允许 XMPP 实体发起请求并从另一个实体接收响应.IQ元素是Jabber/XMPP消息协议的第三个顶层元素.IQ代表”Info/Query”,用来发送和获取实体之间的信息.IQ消息是通过”请求/响应”机制在实体间进行交换的.<br> IQ元素用于不同的目的,它们之间通过不同的命名空间来加以区分.在Jabber/XMPP消息协议里有许多的命名空间,但最常用的命名空间是:”jabber:iq:register”,”jabber:iq:auth”,”jabber:iq:roster”<br>信息/请求,是一个请求－响应机制,管理XMPP服务器上两个用户的转换,允许他们通过相应的XML格式进行查询和响应.</p>
</blockquote>
<pre><code>&lt;iq from=&quot;abc@jabber.org/contact&quot; id=&quot;id11&quot; type=&quot;result&quot;&gt;
&lt;/iq&gt;
</code></pre><h4 id="3_2CXMPP__u7684_u4EA4_u4E92_u6D41_u7A0B"><a href="#3_2CXMPP__u7684_u4EA4_u4E92_u6D41_u7A0B" class="headerlink" title="3,XMPP 的交互流程."></a>3,XMPP 的交互流程.</h4><blockquote>
<p>XMPP 通过 TCP 传输了什么内容？在 QQ 里面,消息是使用二进制形式发送的,在 MSN 里面是采用纯文本指令加参数加换行符的形式发送的,<br>而 XMPP 传输的即时通讯指令与他们相仿,只是协议的形式变成了 XML 格式的纯文本,这让解析更容易,方便了开发和查错,但是也带来了数据负载过重的缺点,而被人广为诟病.</p>
</blockquote>
<p>XMPP 聊天的过程如下:</p>
<p>所有从一个 client 到另一个 client 的消息和数据都要经过 XMPP Server;</p>
<pre><code>client1 连接到Server;
server 利用本地目录系统的证书对其认证;
client1 指定 client2 目标地址,让 server 告知 client2 目标状态;
server 查找,连接并进行互相认证;
client1 和 client2 进行交互.
</code></pre><p>参考<br><a href="http://segmentfault.com/a/1190000000656509" target="_blank" rel="external">XMPP 协议适合用来做移动 IM 么</a><br><a href="http://blog.csdn.net/jessonlv/article/details/44833273" target="_blank" rel="external">XMPP——xmpp客户端、服务器、网关以及地址和消息格式详解</a><br><a href="http://blog.csdn.net/jessonlv/article/details/44811253" target="_blank" rel="external">XMPP——xmpp协议详解、优点、缺点及优化思路</a><br><a href="http://www.jianshu.com/p/af87ff15bfe3" target="_blank" rel="external">简书-xmpp协议初识</a></p>
<hr>
<h3 id="XMPP__u4F7F_u7528_BOSH__u8D8A_u8FC7_HTTP"><a href="#XMPP__u4F7F_u7528_BOSH__u8D8A_u8FC7_HTTP" class="headerlink" title="XMPP 使用 BOSH 越过 HTTP"></a>XMPP 使用 BOSH 越过 HTTP</h3><blockquote>
<p>要通过使用 JavaScript 的 XMPP 进行通信的 web 应用程序必须符合一些特殊要求.出于安全考虑,不允许 JavaScript 从 web 页面的域与不同域上的多个服务器通信.<br>如果您的 web 应用程序界面被托管在 application.mydomain.com,所有 XMPP 通信也必须发生在 application.mydomain.com.</p>
<p>防火墙是另一个问题所在.理想情况下,如果您将 XMPP 用作您的 web 界面的实时元素的基础,那么您希望它对防火墙后面的用户有效.<br>但是,公司防火墙通常只对少数几个协议开放几个端口,以便允许 web 数据、电子邮件和类似的通信通过.默认情况下,XMPP 使用端口 5222,这很可能是公司防火墙阻止的端口.</p>
<p>假设您知道您的用户前面的防火墙在端口 80 上允许 HTTP（这是用于访问 web 的默认协议和端口）.理想情况是您的 XMPP 通信能够越过该端口上的 HTTP.但是,HTTP 的设计并不针对持续连接.web 的架构不同于实时数据所需的通信架构.</p>
<p>下面我们看看 Bidirectional-streams Over Synchronous HTTP (BOSH) 的标准,该标准为双向同步数据提供一个模拟层.借助这个标准,可以与一个 XMPP 服务器建立一个较长的 HTTP 连接（时长一分钟或两分钟）.<br>如果新数据在那个期间到达,则 HTTP 请求返回数据并关闭；否则,该请求只是失效.不管是哪种情况,一旦一个请求关闭,另一个请求将重新建立.<br>尽管结果是对一个 web 服务器的一系列重复连接,但它是一个比 Ajax 轮询更有效的数量级,特别是因为连接到的是一个专业服务器而不是直接连接到 web 应用程序.</p>
<p>BOSH 上的 XMPP 允许 web 应用程序通过一个原生连接持续与 XMPP 服务器通信.客户端通过端口 80 上的 HTTP 上的一个标准 URL 连接.然后,web 服务器将这个连接代理到由 XMPP 服务器操作的一个不同端口 — 通常是 7070 — 上的 HTTP URL.<br>这样,无论何时数据被发送到 XMPP 服务器,web 应用程序只需使用一些资源,而 web 客户端可以使用通常支持的 web 标准从防火墙后操作.<br>维持 BOSH 的较长 HTTP 轮询的开销主要由 XMPP 服务器而不是 web 服务器或 web 应用程序承担.web 服务器和 XMPP 服务器都不会受到与使用 JavaScript 进行通信一样的域限制,正是因为这一点,消息才能够被发送到其他 XMPP 服务器和客户端.</p>
<p>现在,您理解了 XMPP 如何适合实时 web,可以下载并设置它,以便开始创建这个 Pingstream 应用程序.</p>
</blockquote>
<hr>
<h5 id="u53C2_u8003"><a href="#u53C2_u8003" class="headerlink" title="参考"></a>参考</h5><p><a href="https://tonghuix.io/2015/03/xmpp-chat/" target="_blank" rel="external">弃用QQ和微信！全面转向基于XMPP(Jabber)的即时聊天</a></p>

      
    </div>
    
  </div>
  
    
    <div class="copyright">
        <p><span>本文标题:</span><a href="/2016/01/03/XMPP/">关于 XMPP 协议</a></p>
        <p><span>文章作者:</span><a href="/" title="访问 张亚飞 的个人博客">张亚飞</a></p>
        <p><span>发布时间:</span>2016年01月03日 - 20时52分</p>
        <p><span>最后更新:</span>2016年01月07日 - 20时38分</p>
        <p>
            <span>原始链接:</span><a class="post-url" href="/2016/01/03/XMPP/" title="关于 XMPP 协议">https://coam.co/2016/01/03/XMPP/</a>
            <span class="copy-path" data-clipboard-text="原文: https://coam.co/2016/01/03/XMPP/　　作者: 张亚飞" title="点击复制文章链接"><i class="fa fa-clipboard"></i></span>
            <script src="/js/clipboard.min.js"></script>
            <script> var clipboard = new Clipboard('.copy-path'); </script>
        </p>
        <p>
            <span>许可协议:</span><i class="fa fa-creative-commons"></i> <a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/3.0/cn/" title="中国大陆 (CC BY-NC-SA 3.0 CN)" target = "_blank">"署名-非商用-相同方式共享 3.0"</a> 转载请保留原文链接及作者。
        </p>
    </div>



    <nav id="article-nav">
        
            <div id="article-nav-newer" class="article-nav-title">
                <a href="/2016/01/03/blog-myNewBlog/">
                    blog/myNewBloger
                </a>
            </div>
        
        
            <div id="article-nav-older" class="article-nav-title">
                <a href="/2016/01/03/EjabberdNote/">
                    Ejabberd Note
                </a>
            </div>
        
    </nav>

  
</article>

    <div id="toc" class="toc-article">
    <strong class="toc-title">文章目录</strong>
    <ol class="toc"><li class="toc-item toc-level-3"><a class="toc-link" href="#u5173_u4E8E_XMPP__u534F_u8BAE"><span class="toc-number">1.</span> <span class="toc-text">关于 XMPP 协议</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Android__u5F00_u6E90_u5BA2_u6237_u7AEF"><span class="toc-number">1.1.</span> <span class="toc-text">Android 开源客户端</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#1_2CXMPP__u7684_u4E09_u79CD_u57FA_u672C_u89D2_u8272_3A_u5BA2_u6237_u7AEF_u3001_u670D_u52A1_u5668_u548C_u7F51_u5173"><span class="toc-number">1.2.</span> <span class="toc-text">1,XMPP 的三种基本角色:客户端、服务器和网关</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#u670D_u52A1_u5668__u5145_u5F53xmpp_u901A_u4FE1_u7684_u4E00_u4E2A_u667A_u80FD_u62BD_u8C61_u5C42_uFF0C_u8D1F_u8D23"><span class="toc-number">1.2.1.</span> <span class="toc-text">服务器 充当xmpp通信的一个智能抽象层，负责</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#u5BA2_u6237_u7AEF"><span class="toc-number">1.2.2.</span> <span class="toc-text">客户端</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#u7F51_u5173"><span class="toc-number">1.2.3.</span> <span class="toc-text">网关</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2_2CXMPP__u7684_u6D88_u606F_u683C_u5F0F"><span class="toc-number">1.3.</span> <span class="toc-text">2,XMPP 的消息格式.</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#2-1_Presence__u8054_u673A_u72B6_u6001"><span class="toc-number">1.3.1.</span> <span class="toc-text">2.1 Presence 联机状态</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#2-2_Message__u6D88_u606F_u4F20_u9012"><span class="toc-number">1.3.2.</span> <span class="toc-text">2.2 Message 消息传递</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#2-3_IQ__u4FE1_u606F/_u67E5_u8BE2_u8BF7_u6C42"><span class="toc-number">1.3.3.</span> <span class="toc-text">2.3 IQ 信息/查询请求</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3_2CXMPP__u7684_u4EA4_u4E92_u6D41_u7A0B"><span class="toc-number">1.4.</span> <span class="toc-text">3,XMPP 的交互流程.</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#XMPP__u4F7F_u7528_BOSH__u8D8A_u8FC7_HTTP"><span class="toc-number">2.</span> <span class="toc-text">XMPP 使用 BOSH 越过 HTTP</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#u53C2_u8003"><span class="toc-number">2.0.1.</span> <span class="toc-text">参考</span></a></li></ol></li></ol></li></ol>
</div>
<style>
    .left-col .switch-btn {
        display: none;
    }
    .left-col .switch-area {
        display: none;
    }
</style>

<input type="button" id="tocButton" value="隐藏目录"  title="点击按钮隐藏或者显示文章目录">

<script src="http://7.url.cn/edu/jslib/comb/require-2.1.6,jquery-1.9.1.min.js" type="text/javascript"></script>
<script>
    var valueHide = "隐藏目录";
    var valueShow = "显示目录";

    if ($(".left-col").is(":hidden")) {
        $("#tocButton").attr("value", valueShow);
    }

    $("#tocButton").click(function() {
        if ($("#toc").is(":hidden")) {
            $("#tocButton").attr("value", valueHide);
            $("#toc").slideDown(320);
            $(".switch-btn, .switch-area").fadeOut(300);
        }
        else {
            $("#tocButton").attr("value", valueShow);
            $("#toc").slideUp(350);
            $(".switch-btn, .switch-area").fadeIn(500);
        }
    })

    if ($(".toc").length < 1) {
        $("#toc, #tocButton").hide();
        $(".switch-btn, .switch-area").show();
    }
</script>






    




    <div class="scroll" id="post-nav-button">
        
            <a href="/2016/01/03/blog-myNewBlog/" title="上一篇: blog/myNewBloger">
                <i class="fa fa-angle-left"></i>
            </a>
        

        <a title="文章列表"><i class="fa fa-bars"></i><i class="fa fa-times"></i></a>

        
            <a href="/2016/01/03/EjabberdNote/" title="下一篇: Ejabberd Note">
                <i class="fa fa-angle-right"></i>
            </a>
        
    </div>

    <ul class="post-list"><li class="post-list-item"><a class="post-list-link" href="/2016/01/10/AndroidPushMQTT/">ErlangNote</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/01/10/Erlang/">ErlangNote</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/01/10/Mnesia/">MnesiaNote</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/01/08/MarkDownNote/">MarkDown 相关</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/01/07/my-blogs/">my blogs</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/01/03/blog-myNewBlog/">blog/myNewBloger</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/01/03/XMPP/">关于 XMPP 协议</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/01/03/EjabberdNote/">Ejabberd Note</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/01/03/Lua/">Lua 学习摘要</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/01/03/MQTT/">关于 MQTT 协议</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/01/03/Rebar/">使用 Rebar 管理 erlang 项目</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/01/03/hello-two/">Hello tow</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/01/03/hello-world/">Hello World</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/01/03/hello-one/">Hello One</a></li></ul>
    <script src="http://7.url.cn/edu/jslib/comb/require-2.1.6,jquery-1.9.1.min.js"></script>
    <script>
        $(".post-list").addClass("toc-article");
        $(".post-list-item a").attr("target","_blank");
        $("#post-nav-button > a:nth-child(2)").click(function() {
            $(".fa-bars, .fa-times").toggle();
            $(".post-list").toggle(300);
            if ($(".toc").length > 0) {
                $("#toc, #tocButton").toggle(200, function() {
                    if ($(".switch-area").is(":visible")) {
                        $("#toc, .switch-btn, .switch-area").toggle();
                        $("#tocButton").attr("value", valueHide);
                        }
                    })
            }
            else {
                $(".switch-btn, .switch-area").fadeToggle(300);
            }
        })
    </script>




    <script>
        
    </script>
</div>
      <footer id="footer">
    <div class="outer">
        <div id="footer-info">
            <div class="footer-left">
                &copy; 2016 张亚飞
            </div>
            <div class="footer-right">
                <a href="http://hexo.io/" target="_blank" title="快速、简洁且高效的静态博客框架">Hexo</a>  Theme <a href="https://github.com/MOxFIVE/hexo-theme-yelee" target="_blank" title="简而不减双栏 Hexo 博客主题">Yelee</a> by MOxFIVE
            </div>
        </div>
        <div class="visit">
            <span id="busuanzi_container_site_pv" style='display:none'>
                <span id="site-visit" >本站到访数: 
                    <span id="busuanzi_value_site_uv"></span>
                </span>
            </span>
            <span id="busuanzi_container_page_pv" style='display:none'>
                <span id="page-visit">, 本页阅读量: 
                    <span id="busuanzi_value_page_pv"></span>
                </span>
            </span>
        </div>
    </div>
</footer>
    </div>
    <script src="http://7.url.cn/edu/jslib/comb/require-2.1.6,jquery-1.9.1.min.js" type="text/javascript"></script>
<script src="/js/main.js" type="text/javascript"></script>

    <script>
        $(document).ready(function() {
            var iPad = window.navigator.userAgent.indexOf('iPad');
            if (iPad > -1 || $(".left-col").css("display") === "none") {
                var bgColorList = ["#9db3f4", "#414141", "#e5a859", "#f5dfc6", "#c084a0", "#847e72", "#cd8390", "#996731"];
                var bgColor = Math.ceil(Math.random() * (bgColorList.length - 1));
                $("body").css({"background-color": bgColorList[bgColor], "background-size": "cover"});
            }
            else {
                var backgroundnum = 5;
                var backgroundimg = "url(/background/bg-x.jpg)".replace(/x/gi, Math.ceil(Math.random() * backgroundnum));
                $("body").css({"background": backgroundimg, "background-attachment": "fixed", "background-size": "cover"});
            }
        })
    </script>




<div class="scroll" id="scroll">
    <a href="#" title="返回顶部"><i class="fa fa-arrow-up"></i></a>
    <a href="#comments" title="查看评论"><i class="fa fa-comments-o"></i></a>
    <a href="#footer" title="转到底部"><i class="fa fa-arrow-down"></i></a>
</div>

<script>
    $(document).ready(function() {
        if ($("#comments").length < 1) {
            $("#scroll > a:nth-child(2)").hide();
        };
    })
</script>

<script async src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js">
</script>
  </div>
</body>
</html>