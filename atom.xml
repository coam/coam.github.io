<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>商运物流</title>
  
  <link href="/atom.xml" rel="self"/>
  
  <link href="https://coam.co/"/>
  <updated>2016-05-19T09:25:40.138Z</updated>
  <id>https://coam.co/</id>
  
  <author>
    <name>张亚飞</name>
    
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title>InstallOTP</title>
    <link href="https://coam.co/2016/05/19/Erlang/InstallOTP/"/>
    <id>https://coam.co/2016/05/19/Erlang/InstallOTP/</id>
    <published>2016-05-19T08:31:31.000Z</published>
    <updated>2016-05-19T09:25:40.138Z</updated>
    
    <content type="html">&lt;a id=&quot;more&quot;&gt;&lt;/a&gt;
&lt;h3 id=&quot;Erlang-之-OTP-安装管理及环境配置&quot;&gt;&lt;a href=&quot;#Erlang-之-OTP-安装管理及环境配置&quot; class=&quot;headerlink&quot; title=&quot;Erlang 之 OTP 安装管理及环境配置&quot;&gt;&lt;/a&gt;Erlang 之 OTP 安装管理及环境配置&lt;/h3&gt;&lt;p&gt;&lt;a href=&quot;http://www.erlang.org/download.html&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;OTP 官网&lt;/a&gt;&lt;/p&gt;
&lt;h3 id=&quot;Ubuntu-下安装-otp&quot;&gt;&lt;a href=&quot;#Ubuntu-下安装-otp&quot; class=&quot;headerlink&quot; title=&quot;Ubuntu 下安装 otp&quot;&gt;&lt;/a&gt;Ubuntu 下安装 otp&lt;/h3&gt;&lt;p&gt;安装依赖&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;apt-get install g++ gcc make libncurses5-dev libssl-dev&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;因为我们项目并没用Java作为NIF,所以不需要安装Java,有需要的就先安装Java；同时因为服务器只有命令行,不需要wx这个图形库.&lt;/p&gt;
&lt;p&gt;编译安装,执行失败可分步执行&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;built_in&quot;&gt;cd&lt;/span&gt; RunSoft&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;wget http://erlang.org/download/otp_src_18.&lt;span class=&quot;number&quot;&gt;3&lt;/span&gt;.tar.gz&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;tar otp_src_18.&lt;span class=&quot;number&quot;&gt;3&lt;/span&gt;.tar.gz&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; ./configure &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; make -j4 &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; sudo make install&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;这样 Erlang 就安装好了.可以输入命令 erl 测试是否安装好&lt;/p&gt;
&lt;hr&gt;
&lt;p&gt;注 实际安装不添加 &lt;em&gt;./configure –prefix=/opt/otp/&lt;/em&gt; ,将 otp 安装到默认系统位置,否则运行 rebar 或安装 Ejabberd 会出现莫名奇妙的错误,以下记录忽略&lt;/p&gt;
&lt;p&gt;指定 prefix ,是为了删除方便.同时在 ~/.bashrc 将 /opt/otp/bin 添加到 PATH.&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;built_in&quot;&gt;export&lt;/span&gt; PATH=/opt/otp/bin:&lt;span class=&quot;variable&quot;&gt;$PATH&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;使用一下命令重载配置&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;built_in&quot;&gt;source&lt;/span&gt; ~/.bashrc&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;hr&gt;
&lt;h3 id=&quot;升级&quot;&gt;&lt;a href=&quot;#升级&quot; class=&quot;headerlink&quot; title=&quot;升级&quot;&gt;&lt;/a&gt;升级&lt;/h3&gt;&lt;p&gt;升级重新下载最新版即可 &lt;em&gt;otp_src_xxx.tar.gz&lt;/em&gt; 以上步骤重新执行一遍&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id=&quot;Window-下安装及环境配置&quot;&gt;&lt;a href=&quot;#Window-下安装及环境配置&quot; class=&quot;headerlink&quot; title=&quot;Window 下安装及环境配置&quot;&gt;&lt;/a&gt;Window 下安装及环境配置&lt;/h3&gt;&lt;p&gt;下载 &lt;a href=&quot;http://www.erlang.org/download/otp_win64_18.2.1.exe&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;http://www.erlang.org/download/otp_win64_18.2.1.exe&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;安装到一个目录 &lt;em&gt;G:\Program Files\erl7.2.1\&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;添加 &lt;em&gt;G:\Program Files\erl7.2.1\bin&lt;/em&gt; 到环境变量 PATH&lt;/p&gt;
&lt;p&gt;重新打开终端 输入 erl 测试&lt;/p&gt;
&lt;hr&gt;
&lt;p&gt;###Erlang 开发工具&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;https://www.jetbrains.com/idea/features/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;IntelliJ IDEA&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;安装插件 intellij-erlang ,Plugins 搜索 erlang&lt;/p&gt;
&lt;hr&gt;
&lt;h4 id=&quot;参考列表&quot;&gt;&lt;a href=&quot;#参考列表&quot; class=&quot;headerlink&quot; title=&quot;参考列表&quot;&gt;&lt;/a&gt;参考列表&lt;/h4&gt;&lt;p&gt;&lt;a href=&quot;http://ju.outofmemory.cn/entry/131329&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;http://ju.outofmemory.cn/entry/131329&lt;/a&gt;&lt;/p&gt;
&lt;hr&gt;
&lt;hr&gt;
&lt;h4 id=&quot;错误分析&quot;&gt;&lt;a href=&quot;#错误分析&quot; class=&quot;headerlink&quot; title=&quot;错误分析&quot;&gt;&lt;/a&gt;错误分析&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;运行 rebar 出现如下错误&lt;/li&gt;
&lt;/ul&gt;
&lt;figure class=&quot;highlight elixir&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;constant&quot;&gt;Sun Dec &lt;/span&gt;&lt;span class=&quot;number&quot;&gt;20&lt;/span&gt; &lt;span class=&quot;number&quot;&gt;21&lt;/span&gt;&lt;span class=&quot;symbol&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;number&quot;&gt;15&lt;/span&gt;&lt;span class=&quot;symbol&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;number&quot;&gt;31&lt;/span&gt; yzhang&lt;span class=&quot;variable&quot;&gt;@coam&lt;/span&gt;&lt;span class=&quot;symbol&quot;&gt;:~/RunProject/ejabberd&lt;/span&gt;&lt;span class=&quot;variable&quot;&gt;$ &lt;/span&gt;sudo ./rebar get-deps&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;/usr/bin/&lt;span class=&quot;symbol&quot;&gt;env:&lt;/span&gt; &lt;span class=&quot;symbol&quot;&gt;escript:&lt;/span&gt; &lt;span class=&quot;constant&quot;&gt;No &lt;/span&gt;such file &lt;span class=&quot;keyword&quot;&gt;or&lt;/span&gt; directory&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;constant&quot;&gt;Sun Dec &lt;/span&gt;&lt;span class=&quot;number&quot;&gt;20&lt;/span&gt; &lt;span class=&quot;number&quot;&gt;21&lt;/span&gt;&lt;span class=&quot;symbol&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;number&quot;&gt;22&lt;/span&gt;&lt;span class=&quot;symbol&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;number&quot;&gt;50&lt;/span&gt; yzhang&lt;span class=&quot;variable&quot;&gt;@coam&lt;/span&gt;&lt;span class=&quot;symbol&quot;&gt;:~/RunProject&lt;/span&gt;&lt;span class=&quot;variable&quot;&gt;$ &lt;/span&gt;whereis escript&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;symbol&quot;&gt;escript:&lt;/span&gt; /opt/otp/bin/escript&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;原因是我安装 otp 时 使用命令 ./configure –prefix=/opt/otp/ 指定安装 otp 到 /opt/otp/ 下&lt;/p&gt;
&lt;p&gt;于是重新安装 otp ,并取消 ~/.bashrc 中配置的 erlang 环境变量&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# Erlang&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;#export PATH=/opt/otp/bin:$PATH&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;重启 ubuntu 后敲 erl 命令提示未找到,注释成功,重新使用默认参数安装otp&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;ejabberd 源码编译安装,执行命令 ejabberd ./configure 后出现如下错误&lt;/li&gt;
&lt;/ul&gt;
&lt;figure class=&quot;highlight java&quot;&gt;&lt;figcaption&gt;&lt;span&gt;错误分析&lt;/span&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;Sun Dec &lt;span class=&quot;number&quot;&gt;20&lt;/span&gt; &lt;span class=&quot;number&quot;&gt;21&lt;/span&gt;:&lt;span class=&quot;number&quot;&gt;21&lt;/span&gt;:&lt;span class=&quot;number&quot;&gt;26&lt;/span&gt; yzhang&lt;span class=&quot;annotation&quot;&gt;@coam&lt;/span&gt;:~/RunProject/ejabberd$ sudo ./configure&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;checking whether make sets $(MAKE)... yes&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;checking &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; a BSD-compatible install... /usr/bin/install -c&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;checking &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; a sed that does not truncate output... /bin/sed&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;checking &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; erl... no&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;checking &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; erlc... no&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;checking &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; erl... no&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;configure: error: Erlang/&lt;span class=&quot;function&quot;&gt;OTP &lt;span class=&quot;title&quot;&gt;interpreter&lt;/span&gt; &lt;span class=&quot;params&quot;&gt;(erl)&lt;/span&gt; not found but required&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;解决方案,重新安装 otp 到系统默认路径&lt;/p&gt;
&lt;p&gt;参考&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;http://stackoverflow.com/questions/12327809/why-cannot-escript-run&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;Why cannot escript run?&lt;/a&gt;&lt;/p&gt;
&lt;hr&gt;
&lt;hr&gt;
&lt;h3 id=&quot;Erlang-OTP18-API更新&quot;&gt;&lt;a href=&quot;#Erlang-OTP18-API更新&quot; class=&quot;headerlink&quot; title=&quot;Erlang OTP18 API更新&quot;&gt;&lt;/a&gt;Erlang OTP18 API更新&lt;/h3&gt;&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;/data/home/yzhang/CoamRunning/Erlang/ejabberd/deps/emysql/src/emysql_conn.erl:&lt;span class=&quot;number&quot;&gt;337&lt;/span&gt;: Warning: erlang:now/&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;: Deprecated BIF. See the &lt;span class=&quot;string&quot;&gt;&quot;Time and Time Correction in Erlang&quot;&lt;/span&gt; chapter of the ERTS User&lt;span class=&quot;string&quot;&gt;&#39;s Guide for more information.&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;使用 &lt;em&gt;erlang:timestamp()&lt;/em&gt; 代替 &lt;em&gt;erlang:now()&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;http://stackoverflow.com/questions/34023193/erlangnow-deprecated-in-v18-whats-the-best-transition/34028175&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;erlang:now() deprecated in v18, what’s the best transition&lt;/a&gt;&lt;/p&gt;
</content>
    
    <summary type="html">
    
      &lt;a id=&quot;more&quot;&gt;&lt;/a&gt;
&lt;h3 id=&quot;Erlang-之-OTP-安装管理及环境配置&quot;&gt;&lt;a href=&quot;#Erlang-之-OTP-安装管理及环境配置&quot; class=&quot;headerlink&quot; title=&quot;Erlang 之 OTP 安装管理及环境配置&quot;&gt;&lt;/a&gt;Er
    
    </summary>
    
    
  </entry>
  
  <entry>
    <title>RedisSyncNote</title>
    <link href="https://coam.co/2016/05/19/Redis/RedisSyncNote/"/>
    <id>https://coam.co/2016/05/19/Redis/RedisSyncNote/</id>
    <published>2016-05-19T08:21:31.000Z</published>
    <updated>2016-05-19T08:26:49.390Z</updated>
    
    <content type="html">&lt;h4 id=&quot;Redis-主从同步配置&quot;&gt;&lt;a href=&quot;#Redis-主从同步配置&quot; class=&quot;headerlink&quot; title=&quot;Redis 主从同步配置&quot;&gt;&lt;/a&gt;Redis 主从同步配置&lt;/h4&gt;&lt;a id=&quot;more&quot;&gt;&lt;/a&gt;
&lt;p&gt;Redis的安装,但是在生产环境中,没有人使用一台 Redis 服务器,至少也得是个主从架构,配置Redis主从其实很简单.&lt;/p&gt;
&lt;p&gt;Redis主从环境介绍&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;Redis 主: 43.241.222.110
Redis 从: 42.96.194.60
&lt;/code&gt;&lt;/pre&gt;&lt;ol&gt;
&lt;li&gt;Redis 工作原理&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;无论是初次连接还是重新连接,当建立一个从服务器时,从服务器都将向主服务器发送一个 SYNC 命令,接到 SYNC 命令的主服务器将开始执行 BGSAVE ,并在保存操作执行期间,将所有新执行的写入命令都保存到一个缓冲区里面.当 BGSAVE 执行完毕后,主服务器将执行保存操作所得的 .rdb 文件发送给从服务器,从服务器接收这个 .rdb 文件,并将文件中的数据载入到内存中.之后主服务器会以 Redis 命令协议的格式,将写命令缓冲区中积累的所有内容都发送给从服务器.如果Master和Slave之间的链接出现断连现象,Slave可以自动重连Master,但是在连接成功之后,在 Redis 2.8 版本之前,断线之后重连的从服务器总要执行一次完整重同步(full resynchronization)操作,但是从 Redis 2.8 版本开始,从服务器可以根据主服务器的情况来选择执行完整重同步还是部分重同步(partial resynchronization).&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;Redis的主从复制的特点&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;同一个Master可以同步多个Slaves.&lt;br&gt;Slave同样可以接受其它Slaves的连接和同步请求,这样可以有效的分载Master的同步压力.因此我们可以将Redis的Replication架构视为图结构.&lt;br&gt;Master Server是以非阻塞的方式为Slaves提供服务.所以在Master-Slave同步期间,客户端仍然可以提交查询或修改请求.&lt;br&gt;Slave Server同样是以非阻塞的方式完成数据同步.在同步期间,如果有客户端提交查询请求,Redis则返回同步之前的数据.&lt;br&gt;为了分载Master的读操作压力,Slave服务器可以为客户端提供只读操作的服务,写服务仍然必须由Master来完成.即便如此,系统的伸缩性还是得到了很大的提高.&lt;br&gt;Master可以将数据保存操作交给Slaves完成,从而避免了在Master中要有独立的进程来完成此操作.&lt;/p&gt;
&lt;p&gt;Redis 使用异步复制.从 Redis 2.8 开始,从服务器会以每秒一次的频率向主服务器报告复制流(replication stream)的处理进度.&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;Redis服务的安装&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;请点击 Redis 基础安装&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;主从配置&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;4.1. 修改 Redis 从服务器配置文件 &lt;em&gt;/etc/redis.conf&lt;/em&gt;  添加如下两行&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;slaveof &lt;span class=&quot;number&quot;&gt;43.241&lt;/span&gt;.&lt;span class=&quot;number&quot;&gt;222.110&lt;/span&gt; &lt;span class=&quot;number&quot;&gt;6379&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;slave-priority &lt;span class=&quot;number&quot;&gt;100&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;4.2. 启动从redis服务&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;[root@tshare365-slave redis-&lt;span class=&quot;number&quot;&gt;2.8&lt;/span&gt;.&lt;span class=&quot;number&quot;&gt;19&lt;/span&gt;]&lt;span class=&quot;comment&quot;&gt;# redis-server  /etc/redis.conf &lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;[root@tshare365-slaveredis-&lt;span class=&quot;number&quot;&gt;2.8&lt;/span&gt;.&lt;span class=&quot;number&quot;&gt;19&lt;/span&gt;]&lt;span class=&quot;comment&quot;&gt;# redis-cli -h 42.96.194.60&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;ol&gt;
&lt;li&gt;主从同步测试&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;5.1. 主redis启动并写入数据&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;[root@tshare365-master redis-&lt;span class=&quot;number&quot;&gt;2.8&lt;/span&gt;.&lt;span class=&quot;number&quot;&gt;19&lt;/span&gt;]&lt;span class=&quot;comment&quot;&gt;# redis-server  /etc/redis.conf &lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;[root@tshare365-master redis-&lt;span class=&quot;number&quot;&gt;2.8&lt;/span&gt;.&lt;span class=&quot;number&quot;&gt;19&lt;/span&gt;]&lt;span class=&quot;comment&quot;&gt;# redis-cli  -h 43.241.222.110&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;number&quot;&gt;43.241&lt;/span&gt;.&lt;span class=&quot;number&quot;&gt;222.110&lt;/span&gt;:&lt;span class=&quot;number&quot;&gt;6379&lt;/span&gt;&amp;gt; &lt;span class=&quot;built_in&quot;&gt;set&lt;/span&gt; a &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;OK&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;number&quot;&gt;43.241&lt;/span&gt;.&lt;span class=&quot;number&quot;&gt;222.110&lt;/span&gt;:&lt;span class=&quot;number&quot;&gt;6379&lt;/span&gt;&amp;gt; get a&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;string&quot;&gt;&quot;1&quot;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;number&quot;&gt;43.241&lt;/span&gt;.&lt;span class=&quot;number&quot;&gt;222.110&lt;/span&gt;:&lt;span class=&quot;number&quot;&gt;6379&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;5.2. 从Redis查看数据是否同步过来&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;[root@tshare365-slave redis-&lt;span class=&quot;number&quot;&gt;2.8&lt;/span&gt;.&lt;span class=&quot;number&quot;&gt;19&lt;/span&gt;]&lt;span class=&quot;comment&quot;&gt;# redis-cli -h 42.96.194.60&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;number&quot;&gt;42.96&lt;/span&gt;.&lt;span class=&quot;number&quot;&gt;194.60&lt;/span&gt;:&lt;span class=&quot;number&quot;&gt;6379&lt;/span&gt;&amp;gt; get a&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;string&quot;&gt;&quot;1&quot;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;number&quot;&gt;42.96&lt;/span&gt;.&lt;span class=&quot;number&quot;&gt;194.60&lt;/span&gt;:&lt;span class=&quot;number&quot;&gt;6379&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;Redis的主从复制就到此结束了&lt;/p&gt;
&lt;hr&gt;
&lt;h4 id=&quot;参考&quot;&gt;&lt;a href=&quot;#参考&quot; class=&quot;headerlink&quot; title=&quot;参考&quot;&gt;&lt;/a&gt;参考&lt;/h4&gt;&lt;p&gt;&lt;a href=&quot;http://tshare365.com/archives/709.html&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;Redis主从环境安装&lt;/a&gt;&lt;/p&gt;
</content>
    
    <summary type="html">
    
      &lt;h4 id=&quot;Redis-主从同步配置&quot;&gt;&lt;a href=&quot;#Redis-主从同步配置&quot; class=&quot;headerlink&quot; title=&quot;Redis 主从同步配置&quot;&gt;&lt;/a&gt;Redis 主从同步配置&lt;/h4&gt;
    
    </summary>
    
    
  </entry>
  
  <entry>
    <title></title>
    <link href="https://coam.co/2016/05/16/Linux/Ubuntu/"/>
    <id>https://coam.co/2016/05/16/Linux/Ubuntu/</id>
    <published>2016-05-16T14:23:33.845Z</published>
    <updated>2016-05-16T14:23:33.844Z</updated>
    
    <content type="html">&lt;h2 id=&quot;Ubuntu-Linux-服务器相关&quot;&gt;&lt;a href=&quot;#Ubuntu-Linux-服务器相关&quot; class=&quot;headerlink&quot; title=&quot;Ubuntu Linux 服务器相关&quot;&gt;&lt;/a&gt;Ubuntu Linux 服务器相关&lt;/h2&gt;&lt;h3 id=&quot;Ubuntu-桌面安装&quot;&gt;&lt;a href=&quot;#Ubuntu-桌面安装&quot; class=&quot;headerlink&quot; title=&quot;Ubuntu 桌面安装&quot;&gt;&lt;/a&gt;Ubuntu 桌面安装&lt;/h3&gt;&lt;p&gt;将 Ubuntu 安装到移动硬盘,可随时挂载使用&lt;/p&gt;
&lt;p&gt;下载最新版 Ubuntu Desktop 版 &lt;a href=&quot;http://www.ubuntu.com/download/desktop&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;Ubuntu.com&lt;/a&gt;&lt;br&gt;下载 Easybcd 系统引导 &lt;a href=&quot;http://cdn1.mydown.yesky.com/56ab0a50/43fbe043e21f5326cc4bea86d61695fb/soft/201510/EasyBCD2.3.exe&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;Easybcd&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;打开 Easybcd 选择 “NeoGrub”&lt;br&gt;&lt;img src=&quot;images/NeoGrub.jpg&quot; alt=&quot;NeoGrub.jpg&quot;&gt;&lt;br&gt;根据图示操作,以下是我的配置&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# NeoSmart NeoGrub Bootloader Configuration File&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;#&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# This is the NeoGrub configuration file, and should be located at C:\NST\menu.lst&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# Please see the EasyBCD Documentation for information on how to create/modify entries:&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# http://neosmart.net/wiki/display/EBCD/&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;title Install Ubuntu&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;root (hd0,&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;kernel (hd0,&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;)/vmlinuz.efi boot=casper iso-scan/filename=/ubuntu-&lt;span class=&quot;number&quot;&gt;15.10&lt;/span&gt;-desktop-amd64.iso locale=zh_CN.UTF-&lt;span class=&quot;number&quot;&gt;8&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;initrd (hd0,&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;)/initrd.lz&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;title reboot&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;reboot&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;title halt&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;halt&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;使用压缩工具打开Ubuntu镜像文件,将”.disk”文件夹和casper文件夹内的”initrd.lz”和”vmlinuz.efi”文件复制到C盘根目录,再将Ubuntu系统镜像文件复制到C盘根目录&lt;br&gt;&lt;img src=&quot;images/ubuntu-iso.jpg&quot; alt=&quot;NeoGrub.jpg&quot;&gt;&lt;/p&gt;
&lt;p&gt;成功进入Ubuntu试用界面后,桌面上有两个文件.&lt;br&gt;按Ctrl+Alt+T打开终端,输入”sudo umount –l /isodevice”,取消光盘驱动器挂载,否则在后面安装过程中可能会无限卡进度:&lt;/p&gt;
&lt;p&gt;在”安装类型”界面会有多个安装选项&lt;/p&gt;
&lt;p&gt;我们要将Ubuntu安装在”空闲”分区内.选择”空闲”分区,再点击左下方红线处的加号,进行分区.&lt;br&gt;关于Linux的分区挂载,很多带有定势思维的Windows用户还在理解的道路上艰难爬行,分区不是本文重点,此事应当阅读关于Linux分区的专业文章.&lt;br&gt;根目录”/“是必须存在的,可以分8G给”/“.&lt;br&gt;交换分区swap不是必须存在的,可以不给其分配空间,这同样意味着,你可以将所有空间分给”/“.&lt;br&gt;“/boot”不是必须存在的,如果你的硬盘是Ubuntu单系统,推荐为其分配空间,一般小于200M,并且将它设置为第一分区；如果你的硬盘不是单系统,而是像本文所述的双系统,不必分配空间.&lt;br&gt;“/home”用于保存用户的文件,如果你要向其中保存大量数据,需要分配较多空间.&lt;br&gt;“/usr” 主要用于保存应用程序文件,如果你要安装很多程序,需要分配较多空间.可以考虑为其分配最大空间.&lt;br&gt;分区时需要选择文件系统类型,选择”Ext4”即可.&lt;br&gt;注意:如果你的内存较小,交换分区大小应该超过物理内存大小,但要小于物理内存大小乘以2；如果你的内存足够大,交换分区分配1G到2G即可,甚至可以不分配.但如果你要安装一些强制需要交换分区的软件,则必须进行分配,如果你不确定以后安装的某款软件是否强制需要交换分区,最好进行分配,一般1G即可.&lt;/p&gt;
&lt;p&gt;** 我提前在移动硬盘 sdb 划了两个分区,一个 200G 这里设定挂载 “/“ ,另一个 16G 这里设定 swap 分区&lt;/p&gt;
&lt;p&gt;参考&lt;br&gt;&lt;a href=&quot;http://blog.csdn.net/risingwonderland/article/details/37902777&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;Windows8.1硬盘安装Ubuntu14.04双系统参考教程及多硬盘注意事项&lt;/a&gt;&lt;br&gt;&lt;a href=&quot;https://www.zhihu.com/question/20883120&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;如何把ubuntu装到移动硬盘上的同时,可以达到:1. 个人电脑系统启动菜单中同时有电脑硬盘中的Windows7 和移动硬盘的ubuntu；2. 我把移动硬盘拿到其他电脑上可以加载我的移动硬盘的ubuntu系统?&lt;/a&gt;&lt;/p&gt;
</content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;Ubuntu-Linux-服务器相关&quot;&gt;&lt;a href=&quot;#Ubuntu-Linux-服务器相关&quot; class=&quot;headerlink&quot; title=&quot;Ubuntu Linux 服务器相关&quot;&gt;&lt;/a&gt;Ubuntu Linux 服务器相关&lt;/h2&gt;&lt;h3 id=&quot;U
    
    </summary>
    
    
  </entry>
  
  <entry>
    <title></title>
    <link href="https://coam.co/2016/05/16/Linux/SystemInstall/"/>
    <id>https://coam.co/2016/05/16/Linux/SystemInstall/</id>
    <published>2016-05-16T14:12:46.559Z</published>
    <updated>2016-05-16T14:12:46.558Z</updated>
    
    <content type="html">&lt;p&gt;&lt;a href=&quot;http://www.cnblogs.com/bizhu/archive/2013/01/07/2849771.html&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;ubuntu 12.10安装后需要做的那些事&lt;/a&gt;&lt;br&gt;&lt;a href=&quot;http://blog.csdn.net/skykingf/article/details/45267517&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;安装Ubuntu 15.10后要做的事&lt;/a&gt;&lt;/p&gt;
&lt;h3 id=&quot;Ubuntu&quot;&gt;&lt;a href=&quot;#Ubuntu&quot; class=&quot;headerlink&quot; title=&quot;Ubuntu&quot;&gt;&lt;/a&gt;Ubuntu&lt;/h3&gt;&lt;h3 id=&quot;更改-Ubuntu-默认用户主目录&quot;&gt;&lt;a href=&quot;#更改-Ubuntu-默认用户主目录&quot; class=&quot;headerlink&quot; title=&quot;更改 Ubuntu 默认用户主目录&quot;&gt;&lt;/a&gt;更改 Ubuntu 默认用户主目录&lt;/h3&gt;&lt;p&gt;//默认用户 yzhang 主目录为 /home/yzhang ,需要统一更改为 /data/home/yzhang .按以下方法操作即可&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;http://askubuntu.com/questions/250862/properly-modify-home-dir&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;http://askubuntu.com/questions/250862/properly-modify-home-dir&lt;/a&gt;&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;built_in&quot;&gt;cd&lt;/span&gt; /data/home;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;sudo mkdir yzhang&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;sudo chown yzhang:yzhang yzhang&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;//sudo usermod &lt;span class=&quot;operator&quot;&gt;-d&lt;/span&gt; /data/home/yzhang -m yzhang&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;直接修改 ss /etc/passwd 用户主目录为  /data/home/yzhang&lt;/p&gt;
&lt;p&gt;××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××&lt;/p&gt;
&lt;h3 id=&quot;安装-Vim-git&quot;&gt;&lt;a href=&quot;#安装-Vim-git&quot; class=&quot;headerlink&quot; title=&quot;安装 Vim git&quot;&gt;&lt;/a&gt;安装 Vim git&lt;/h3&gt;&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;sudo apt-get install vim&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;sudo apt-get install git&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h3 id=&quot;Ubuntu-所有操作免输密码&quot;&gt;&lt;a href=&quot;#Ubuntu-所有操作免输密码&quot; class=&quot;headerlink&quot; title=&quot;Ubuntu 所有操作免输密码&quot;&gt;&lt;/a&gt;Ubuntu 所有操作免输密码&lt;/h3&gt;&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;sudo visudo&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;末尾添加一行&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;yzhang ALL=(ALL)NOPASSWD:ALL&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;参考 &lt;a href=&quot;http://www.360doc.com/content/14/0114/10/474846_345158171.shtml&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;Ubuntu sudo 免输入密码&lt;/a&gt;&lt;/p&gt;
&lt;h3 id=&quot;lnav工具是在终端界面看日志的神器-装上之后在终端里就可以用lnav彩色显示日志了&quot;&gt;&lt;a href=&quot;#lnav工具是在终端界面看日志的神器-装上之后在终端里就可以用lnav彩色显示日志了&quot; class=&quot;headerlink&quot; title=&quot;lnav工具是在终端界面看日志的神器,装上之后在终端里就可以用lnav彩色显示日志了.&quot;&gt;&lt;/a&gt;lnav工具是在终端界面看日志的神器,装上之后在终端里就可以用lnav彩色显示日志了.&lt;/h3&gt;&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;sudo apt-get install lnav&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;或者 Github 下载 &lt;a href=&quot;https://github.com/tstack/lnav&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;tstack/lnav&lt;/a&gt;&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;$ ./configure&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;$ make&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;$ sudo make install&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;Run ./autogen.sh before running any of the above commands when compiling from a cloned repository.&lt;/p&gt;
&lt;p&gt;可以运行如下命令查看日志&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;$ lnav /var/&lt;span class=&quot;built_in&quot;&gt;log&lt;/span&gt;/messages*&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××&lt;/p&gt;
&lt;h3 id=&quot;安装搜狗输入法&quot;&gt;&lt;a href=&quot;#安装搜狗输入法&quot; class=&quot;headerlink&quot; title=&quot;安装搜狗输入法&quot;&gt;&lt;/a&gt;安装搜狗输入法&lt;/h3&gt;&lt;p&gt;1:卸载fcitx&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;sudo apt-get --purge remove fcitx*&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;2:清理系统内的无用的软件包&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;sudo apt-get --purge autoremove&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;3:到搜狗官网下载搜狗拼音输入法,选择你系统对应的软件包,我系统是64位的,所以我选择了amd64的&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;http://pinyin.sogou.com/linux/?r=pinyin&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;http://pinyin.sogou.com/linux/?r=pinyin&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;4:用gdebi这个软件安装,它能够安装所有依赖关系,如果你没有安装gdebi,请先安装该软件；我用的是&lt;br&gt;这种方法,其它的方法我没试过,所以不知道行不行&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;sudo gdebi sogou_pinyin_linux_1.&lt;span class=&quot;number&quot;&gt;0.0&lt;/span&gt;.&lt;span class=&quot;number&quot;&gt;0014&lt;/span&gt;_amd64.deb&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;5:注销下系统就可以了&lt;/p&gt;
&lt;p&gt;参考 &lt;a href=&quot;http://tieba.baidu.com/p/3020246301&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;ubuntu 14.04 x64 下完美安装搜狗拼音输入法&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;在 Ubuntu 下按教程安装好 sogou 输入法后却无法调出来,参考 &lt;a href=&quot;http://jingyan.baidu.com/article/adc815134f4b92f722bf7350.html&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;在ubuntu下,把安装的中文输入法切换出来&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;×× 以下参考&lt;/p&gt;
&lt;p&gt;先添加以下源&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;sudo add-apt-repository ppa:fcitx-team/nightly&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;更新一下系统&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;sudo apt-get update&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;开始安装fcitx&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;sudo apt-get install fcitx&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;安装fcitx的配置工具&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;sudo apt-get install fcitx-config-gtk&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;安装fcitx的table-all软件包&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;sudo apt-get install fcitx-table-all&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;最后安装im-switch切换工具&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;sudo apt-get install im-switch&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;一条快捷命令&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;sudo apt-get install fcitx fcitx-config-gtk fcitx-table-all im-switch&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;其实fcitx只是一个输入法工具,本身不带资源包的,可以搜索 Fcitx-Configuraton&lt;br&gt;打开查看输入法配置,默认还是没有 搜狗输入法&lt;/p&gt;
&lt;p&gt;我们还需要下载 souguo deb 资源包 &lt;a href=&quot;http://pinyin.sogou.com/linux/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;http://pinyin.sogou.com/linux/&lt;/a&gt;&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;sudo dpkg -i sogoupinyin_2.&lt;span class=&quot;number&quot;&gt;0.0&lt;/span&gt;.&lt;span class=&quot;number&quot;&gt;0068&lt;/span&gt;_amd64.deb&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;如果提示缺少依赖,可以按系统提示先执行以下命令再安装:&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;sudo apt-get install &lt;span class=&quot;operator&quot;&gt;-f&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;注意:以上步骤安装完后需要注销一下&lt;/p&gt;
&lt;p&gt;参考 &lt;a href=&quot;http://jingyan.baidu.com/article/7f41ececec6c47593d095cf4.html&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;Ubuntu下安装搜狗输入法&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××&lt;/p&gt;
&lt;h2 id=&quot;开发环境搭建&quot;&gt;&lt;a href=&quot;#开发环境搭建&quot; class=&quot;headerlink&quot; title=&quot;开发环境搭建&quot;&gt;&lt;/a&gt;开发环境搭建&lt;/h2&gt;&lt;h3 id=&quot;安装基础C-C-编译库&quot;&gt;&lt;a href=&quot;#安装基础C-C-编译库&quot; class=&quot;headerlink&quot; title=&quot;安装基础C/C++编译库&quot;&gt;&lt;/a&gt;安装基础C/C++编译库&lt;/h3&gt;&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;sudo apt-get install vim automake make perl gcc g++&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;sudo apt-get install bison g++-multilib git flex lzop gperf libxml2-utils zlib1g-dev&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h3 id=&quot;安装CMake和Qt-Creator&quot;&gt;&lt;a href=&quot;#安装CMake和Qt-Creator&quot; class=&quot;headerlink&quot; title=&quot;安装CMake和Qt Creator&quot;&gt;&lt;/a&gt;安装CMake和Qt Creator&lt;/h3&gt;&lt;p&gt;CMake和Qt Creator是Linux下开发C++程序的神器,Ubuntu 15.04已经集成了最新版的Qt Creator (3.1.1)&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;sudo apt-get install cmake qtcreator&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;参考 &lt;a href=&quot;http://blog.csdn.net/skykingf/article/details/45370223&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;Ubuntu 15.10 搭建Android系统编译环境&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××&lt;/p&gt;
&lt;h3 id=&quot;安装-Oracle-Java&quot;&gt;&lt;a href=&quot;#安装-Oracle-Java&quot; class=&quot;headerlink&quot; title=&quot;安装 Oracle Java&quot;&gt;&lt;/a&gt;安装 Oracle Java&lt;/h3&gt;&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;sudo add-apt-repository ppa:webupd8team/java&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;sudo apt-get update&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;sudo apt-get install oracle-java8-installer&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;注意:由于系统自带的是OpenJDK,卸载OpenJDK之后会带有残留,导致运行&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;java -version&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;时第一行不是java的版本号,会是&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;Picked up JAVA_TOOL_OPTIONS: -javaagent:/usr/share/java/jayatanaag.jar&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;这个提示,导致很多检测java版本号的脚本会运行出错,因此需要手动清除残留.&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;sudo rm /usr/share/upstart/sessions/jayatana.conf&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;删除 &lt;em&gt;/usr/share/upstart/sessions/jayatana.conf&lt;/em&gt; 文件,重启之后再运行 &lt;em&gt;java -version&lt;/em&gt; 就不会再有 &lt;em&gt;Picked up JAVA_TOOL_OPTIONS: -javaagent:/usr/share/java/jayatanaag.jar&lt;/em&gt; 提示了.&lt;/p&gt;
&lt;p&gt;参考&lt;br&gt;&lt;a href=&quot;http://blog.csdn.net/skykingf/article/details/45267517&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;安装Ubuntu 15.10后要做的事&lt;/a&gt;&lt;br&gt;&lt;a href=&quot;https://launchpad.net/~webupd8team/+archive/ubuntu/java&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;Oracle Java (JDK) 7 / 8 / 9 Installer PPA&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××&lt;/p&gt;
&lt;h3 id=&quot;安装Sublime-Text-3&quot;&gt;&lt;a href=&quot;#安装Sublime-Text-3&quot; class=&quot;headerlink&quot; title=&quot;安装Sublime Text 3&quot;&gt;&lt;/a&gt;安装Sublime Text 3&lt;/h3&gt;&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;sudo add-apt-repository ppa:webupd8team/sublime-text-&lt;span class=&quot;number&quot;&gt;3&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;sudo apt-get update&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;sudo apt-get install sublime-text&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;blockquote&gt;
&lt;blockquote&gt;
&lt;p&gt;&amp;gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;/blockquote&gt;
&lt;p&gt;登入官网:&lt;a href=&quot;http://www.sublimetext.com/3&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;http://www.sublimetext.com/3&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;下载Ubuntu 64 bit 版本的,双击完成安装&lt;br&gt;注意:终端打开Sublime Text 3的方法是 在终端输入subl即可&lt;/p&gt;
&lt;p&gt;注册码:&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;—– BEGIN LICENSE —–&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;Andrew Weber&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;Single User License&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;EA7E-&lt;span class=&quot;number&quot;&gt;855605&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;number&quot;&gt;813&lt;/span&gt;A03DD &lt;span class=&quot;number&quot;&gt;5&lt;/span&gt;E4AD9E6 &lt;span class=&quot;number&quot;&gt;6&lt;/span&gt;C0EEB94 BC99798F&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;number&quot;&gt;942194&lt;/span&gt;A6 &lt;span class=&quot;number&quot;&gt;02396&lt;/span&gt;E98 E62C9979 &lt;span class=&quot;number&quot;&gt;4&lt;/span&gt;BB979FE&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;number&quot;&gt;91424&lt;/span&gt;C9D A45400BF F6747D88 &lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;FB88078&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;number&quot;&gt;90&lt;/span&gt;F5CC94 &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;CDC92DC &lt;span class=&quot;number&quot;&gt;8457107&lt;/span&gt;A F151657B&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;D22E383 A997F016 &lt;span class=&quot;number&quot;&gt;42397640&lt;/span&gt; &lt;span class=&quot;number&quot;&gt;33&lt;/span&gt;F41CFC&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;E1D0AE85 A0BBD039 &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;E9C8D55 E1B89D5D&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;number&quot;&gt;5&lt;/span&gt;CDB7036 E56DE1C0 EFCC0840 &lt;span class=&quot;number&quot;&gt;650&lt;/span&gt;CD3A6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;B98FC99C &lt;span class=&quot;number&quot;&gt;8&lt;/span&gt;FAC73EE D2B95564 DF450523&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;—— END LICENSE ——&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;安装 Package Control&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;built_in&quot;&gt;cd&lt;/span&gt; ~/.config/sublime-text-&lt;span class=&quot;number&quot;&gt;3&lt;/span&gt;/Packages/&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;git &lt;span class=&quot;built_in&quot;&gt;clone&lt;/span&gt; https://github.com/wbond/package_control_channel.git Package\ Control&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;参考&lt;br&gt;&lt;a href=&quot;http://blog.csdn.net/cywosp/article/details/32721011&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;点滴记录——Ubuntu 14.04中安装Sublime Text 3并使用SublimeClang插件&lt;/a&gt;&lt;br&gt;&lt;a href=&quot;http://www.jianshu.com/p/1f3a3e4f4e92&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;Ubuntu 14.04 LTS 64位 安装激活Sublime Text 3及解决无法输入中文问题的解决方法&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××&lt;/p&gt;
&lt;h3 id=&quot;安装-Phpstrom&quot;&gt;&lt;a href=&quot;#安装-Phpstrom&quot; class=&quot;headerlink&quot; title=&quot;安装 Phpstrom&quot;&gt;&lt;/a&gt;安装 Phpstrom&lt;/h3&gt;&lt;p&gt;&lt;a href=&quot;http://idea.lanyus.com/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;http://idea.lanyus.com/&lt;/a&gt;&lt;/p&gt;
&lt;h3 id=&quot;建立项目软连接&quot;&gt;&lt;a href=&quot;#建立项目软连接&quot; class=&quot;headerlink&quot; title=&quot;建立项目软连接&quot;&gt;&lt;/a&gt;建立项目软连接&lt;/h3&gt;&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;sudo ln &lt;span class=&quot;operator&quot;&gt;-s&lt;/span&gt; /media/yzhang/&lt;span class=&quot;number&quot;&gt;0000678400004823&lt;/span&gt;/DeveloperWorkspace/CoamServer/ ~/CoamServer&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;sudo ln &lt;span class=&quot;operator&quot;&gt;-s&lt;/span&gt; /media/yzhang/&lt;span class=&quot;number&quot;&gt;0000678400004823&lt;/span&gt;/DeveloperWorkspace/ ~/DeveloperWorkspace&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××&lt;/p&gt;
&lt;h3 id=&quot;Ubuntu-安装-ShadowSocks-客户端代理翻墙&quot;&gt;&lt;a href=&quot;#Ubuntu-安装-ShadowSocks-客户端代理翻墙&quot; class=&quot;headerlink&quot; title=&quot;Ubuntu 安装 ShadowSocks 客户端代理翻墙&quot;&gt;&lt;/a&gt;Ubuntu 安装 ShadowSocks 客户端代理翻墙&lt;/h3&gt;&lt;p&gt;安装linux客户端&lt;/p&gt;
&lt;p&gt;从 &lt;em&gt;shadowsocks-gui&lt;/em&gt; 得知,linux客户端是 &lt;em&gt;shadowsocks-qt5&lt;/em&gt; ,居然还提供中文版本的安装指南 .赞一个！&lt;/p&gt;
&lt;p&gt;按照安装指南,执行安装:&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;sudo add-apt-repository ppa:hzwhuang/ss-qt5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;sudo apt-get update&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;sudo apt-get install shadowsocks-qt5&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;安装完成后,执行命令启动:&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;ss-qt5&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;图形界面上可以找到shadowsocks-qt5的图标,或者gnome do之类的工具也可以.&lt;/p&gt;
&lt;p&gt;启动后配置和windows版本类似,区别于 Window 客户端,代理模式改 http 模式为 sock 模式&lt;/p&gt;
&lt;p&gt;Chrome 上安装的代理翻墙插件 &lt;a href=&quot;https://github.com/FelisCatus/SwitchyOmega/releases&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;FelisCatus/SwitchyOmega&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;参考&lt;br&gt;&lt;a href=&quot;http://skyao.github.io/2015/07/14/computer-fanqiang/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;使用shadowsocks实现科学上网 &lt;/a&gt;&lt;br&gt;&lt;a href=&quot;https://github.com/shadowsocks/shadowsocks-qt5/wiki/%E5%AE%89%E8%A3%85%E6%8C%87%E5%8D%97&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;ShadowSocks安装指南&lt;/a&gt;&lt;br&gt;&lt;a href=&quot;http://segmentfault.com/a/1190000002511795&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;使用Digital Ocean和shadowsocks来科学上网&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××&lt;/p&gt;
&lt;h3 id=&quot;KSnapshot-截屏工具&quot;&gt;&lt;a href=&quot;#KSnapshot-截屏工具&quot; class=&quot;headerlink&quot; title=&quot;KSnapshot 截屏工具&quot;&gt;&lt;/a&gt;KSnapshot 截屏工具&lt;/h3&gt;&lt;p&gt;系统默认 Alt + Print Screen 快捷键默认只允许截取整张屏幕&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;$ sudo apt-get install ksnapshot&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h3 id=&quot;创建-root-用户登陆密码&quot;&gt;&lt;a href=&quot;#创建-root-用户登陆密码&quot; class=&quot;headerlink&quot; title=&quot;创建 root 用户登陆密码&quot;&gt;&lt;/a&gt;创建 root 用户登陆密码&lt;/h3&gt;&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;sudo passwd root&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;默认 root 用户新建后,不能通过桌面登陆 root 账户,还需要修改以下地方&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;sudo vi /usr/share/lightdm/lightdm.conf.d/&lt;span class=&quot;number&quot;&gt;50&lt;/span&gt;-ubuntu.conf&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;[Seat:*]&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;user-session=ubuntu&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;greeter-show-manual-login=&lt;span class=&quot;literal&quot;&gt;true&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;重新登陆即可&lt;/p&gt;
&lt;p&gt;××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××&lt;/p&gt;
&lt;h3 id=&quot;删除Amazon的链接&quot;&gt;&lt;a href=&quot;#删除Amazon的链接&quot; class=&quot;headerlink&quot; title=&quot;删除Amazon的链接&quot;&gt;&lt;/a&gt;删除Amazon的链接&lt;/h3&gt;&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;sudo apt-get remove unity-webapps-common&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;删掉基本不用的自带软件(用的时候再装也来得及)&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;sudo apt-get remove thunderbird totem rhythmbox empathy brasero simple-scan gnome-mahjongg aisleriot \&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; gnome-mines cheese transmission-common gnome-orca webbrowser-app gnome-sudoku  landscape-client-ui-install&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;sudo apt-get remove onboard deja-dup&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;这样系统就基本上干净了.&lt;/p&gt;
&lt;p&gt;××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××&lt;/p&gt;
&lt;h3 id=&quot;Ubuntu-14-04-标题栏实时显示上下行网速-CPU及内存&quot;&gt;&lt;a href=&quot;#Ubuntu-14-04-标题栏实时显示上下行网速-CPU及内存&quot; class=&quot;headerlink&quot; title=&quot;Ubuntu 14.04 标题栏实时显示上下行网速. CPU及内存&quot;&gt;&lt;/a&gt;Ubuntu 14.04 标题栏实时显示上下行网速. CPU及内存&lt;/h3&gt;&lt;p&gt;先当然是用wget下载 &lt;a href=&quot;https://launchpad.net/indicator-sysmonitor&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;indicator-sysmonitor&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;wget &lt;a href=&quot;https://launchpadlibrarian.net/139475561/indicator-sysmonitor_0.4.3_all.deb&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;https://launchpadlibrarian.net/139475561/indicator-sysmonitor_0.4.3_all.deb&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;下载好后,先不要急于安装,因为软件有些依赖关系还没解决.终端执行安装依赖:&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;sudo apt-get install python python-psutil python-appindicator &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;sudo apt-get install python-gtk2&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;安装 &lt;em&gt;indicator-sysmonitor&lt;/em&gt;&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;sudo dpkg -i indicator-sysmonitor_0.&lt;span class=&quot;number&quot;&gt;4.3&lt;/span&gt;_all.deb&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;安装完成后便可以搜索 System Monitor 启动监控界面了,但默认只能显示内存和CPU使用情况,想要显示上下行网速的情况还要如下操作:&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;sudo apt-get install dstat&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;sudo apt-get install acpi&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;下载脚本&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;$ mkdir -p ~/.scripts &amp;amp;&amp;amp; &lt;span class=&quot;built_in&quot;&gt;cd&lt;/span&gt; ~/.scripts&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;$ wget http://webupd8.googlecode.com/files/sysmon_0.&lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;.tar.gz &amp;amp;&amp;amp; tar -xvf sysmon_0.&lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;.tar.gz&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;可在scripts目录下得到sysmon脚本,设置System Monitor,让它使用脚本里的配置.&lt;br&gt;下面 Alt+F2 或终端中 运行indicator-sysmonitor.在工具栏点击Indicator-Sysmonitor 并选择 “首选项” ,&lt;br&gt;选择Advanced,然后新建一个senor,在command处输入$HOME/.scripts/sysmon,&lt;br&gt;在General中勾选”Run on startup” 后保存退出&lt;/p&gt;
&lt;p&gt;参考:&lt;br&gt;&lt;a href=&quot;https://wu.nerd.moe/?p=1377&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;让Indicator-Sysmonitor在顶部面板显示上下行网速及CPU温度&lt;/a&gt;&lt;br&gt;&lt;a href=&quot;http://www.cnblogs.com/bizhu/archive/2013/01/07/2849771.html&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;ubuntu 12.10安装后需要做的那些事&lt;/a&gt;&lt;/p&gt;
&lt;h3 id=&quot;Glances-监控系统&quot;&gt;&lt;a href=&quot;#Glances-监控系统&quot; class=&quot;headerlink&quot; title=&quot;Glances 监控系统&quot;&gt;&lt;/a&gt;Glances 监控系统&lt;/h3&gt;&lt;p&gt;&lt;a href=&quot;https://pypi.python.org/pypi/Glances/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;Glances&lt;/a&gt;&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;$ sudo apt-get install glances&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;$ glances&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;&lt;a href=&quot;http://www.cnblogs.com/xred/p/3845205.html&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;借助Glances Monitor,密切关注你的系统&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××&lt;/p&gt;
&lt;h3 id=&quot;failed-to-start-session&quot;&gt;&lt;a href=&quot;#failed-to-start-session&quot; class=&quot;headerlink&quot; title=&quot;failed to start session&quot;&gt;&lt;/a&gt;failed to start session&lt;/h3&gt;&lt;p&gt;&lt;a href=&quot;http://itsfoss.com/failed-to-start-session-ubuntu-14-04/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;Fix “Failed To Start Session” At Login In Ubuntu 14.04&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;Ctrl + Alt + F1&lt;/p&gt;
&lt;p&gt;When you are at login, press Ctrl+Alt+F1. It will take you to command line interface from the GUI. In here, type your username and password. Now, you can try the following command to install Unity Desktop:&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;sudo apt-get install ubuntu-desktop&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;If it is already installed, try reinstalling:&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;sudo apt-get install --reinstall ubuntu-desktop&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;Once it is installed or reinstalled. Use the following command to reboot the system:&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;sudo reboot&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××××&lt;/p&gt;
</content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;a href=&quot;http://www.cnblogs.com/bizhu/archive/2013/01/07/2849771.html&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;ubuntu 12.10安装后需要做的那些事&lt;/a&gt;&lt;br&gt;&lt;a hr
    
    </summary>
    
    
  </entry>
  
  <entry>
    <title></title>
    <link href="https://coam.co/2016/05/16/Others/YL/"/>
    <id>https://coam.co/2016/05/16/Others/YL/</id>
    <published>2016-05-16T14:12:46.354Z</published>
    <updated>2016-05-16T14:12:46.353Z</updated>
    
    <content type="html">&lt;h2 id=&quot;海南省医疗旅游联盟合作策划书&quot;&gt;&lt;a href=&quot;#海南省医疗旅游联盟合作策划书&quot; class=&quot;headerlink&quot; title=&quot;海南省医疗旅游联盟合作策划书&quot;&gt;&lt;/a&gt;海南省医疗旅游联盟合作策划书&lt;/h2&gt;&lt;h3 id=&quot;一-医疗旅游的现状&quot;&gt;&lt;a href=&quot;#一-医疗旅游的现状&quot; class=&quot;headerlink&quot; title=&quot;一. 医疗旅游的现状&quot;&gt;&lt;/a&gt;一. 医疗旅游的现状&lt;/h3&gt;&lt;p&gt;推广医疗旅游大多数是医疗发达国家,他们都各自享誉世界的品牌,比如瑞士的羊胎素注射. 德国的干细胞应用究. 日本的癌症早期筛查. 韩国的整形美容等.且每年中国有50多万人出国治疗肿瘤.&lt;br&gt;在中国,推广这个项目的医疗机构大多是台湾,相比之下,大陆的医疗旅游市场发展并不理想.事实上,上海. 海南. 云南. 甘肃. 北京等地都有加大医疗旅游发展力度的想法.&lt;br&gt;上海和北京均在郊县建设高端医疗园区,但始终不见成效.有评论认为,旅游都有共性,差别在于医疗.中国有限的优质医疗资源过于集中在公立医院,高端医疗资源供给不足限制了医疗旅游产业发展.&lt;/p&gt;
&lt;h3 id=&quot;引起现状的原因-问题&quot;&gt;&lt;a href=&quot;#引起现状的原因-问题&quot; class=&quot;headerlink&quot; title=&quot;引起现状的原因,问题&quot;&gt;&lt;/a&gt;引起现状的原因,问题&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;1.价格偏高,上万元的医疗旅游产品只能针对小群体推广.建发国际旅行社表示:目前各大旅行社对医疗旅游都是采用高端定制的方式.&lt;/li&gt;
&lt;li&gt;2.专业程度高.春秋国际旅行社表示,体检对于旅游行业的员工来说缺乏健康专业知识,对旅客少了专业的引导.&lt;/li&gt;
&lt;li&gt;3.医疗旅游线路研发成本高,对于中低端客户不容易接受, 中高端客户对于国内的医疗品质的不信任,一般都会选择出国体检.业者缺乏足够的信心.以上原因导致很多旅行社推广体检旅游的动力不足.&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&quot;解决方法&quot;&gt;&lt;a href=&quot;#解决方法&quot; class=&quot;headerlink&quot; title=&quot;解决方法&quot;&gt;&lt;/a&gt;解决方法&lt;/h3&gt;&lt;p&gt;现在主要缺乏这种模式和领导者,我希望我们体检中心是海南的先行推动者. 先行者,将休闲旅游和健康服务完美结合运用,将我们优质的医疗资源和旅游服务整合起来推荐给国人.&lt;br&gt;首先需要得到政府的认可和支持:省政府领导听取本计划方案后高度肯定,发展海南得天独厚的旅游优势,让旅行社. 海南政府人民共同获利.这个项目就像左右手,谁也离不开谁.&lt;br&gt;我们可以利用我们的优势,做海南的先行者.依靠我们医院的强大实力. 专家. 和对肿瘤的专业性抢占这块市场,让中国人在自己的国家享受体检和治疗.&lt;/p&gt;
&lt;h3 id=&quot;二．医疗旅游的前景与优势&quot;&gt;&lt;a href=&quot;#二．医疗旅游的前景与优势&quot; class=&quot;headerlink&quot; title=&quot;二．医疗旅游的前景与优势&quot;&gt;&lt;/a&gt;二．医疗旅游的前景与优势&lt;/h3&gt;&lt;blockquote&gt;
&lt;p&gt;前景&lt;br&gt;    2015年12月25日国家旅游局发布旅游业占全球GDP10%,占就业总量9.5%.中国国内旅游. 出境旅游人数和国内旅游消费. 境外旅游消费均列世界第一.博鳌亚洲论坛2011年年会发布报告称,亚洲已经成为全球最富潜力的医疗旅游服务市场.随着人民生活水平的进一步提高,对于健康养生的相关需求也在快速增长.最近显示,有62%的受访者表示出了对健康旅游的兴趣.医疗旅游针对的市场是部分有较高经济能力的中高端客人,这一部分人在健康方面有较高投入,并且有较强的保健意识,针对这些,医疗旅游市场还是非常有潜力的.数据显示,内陆客人医疗旅游的概念比较模糊,医疗旅游意识也相对淡薄.目前而言上海是主要客源地.相关业内人士,预计未来十年上海市场的医疗旅游市场规模将逐步扩张,但是因为全球范围内顶级医疗资源的有限性,因此预估增长不会太快.业内人士表示,虽然医疗旅游市场尚不成熟,信息不透明. 代理机构鱼龙混杂,但是从长远来看,”医疗旅游”市场前景巨大,潜力无限.&lt;br&gt;优势&lt;br&gt;    竟能享受愉快的旅游时光,让自己的心灵享受最放松的状况,又能让自己的身体做一次愉快的旅行.给自己的身体放个假,在检查的过程中不紧张,不忧虑.了解自己身体的状态.让自己在未来的一年甚至下半辈子得到实实在在的全身心的放松..”不仅能欣赏美景. 放松身心,还能为身体做个检查,一举多得.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h3 id=&quot;三-合作的目的&quot;&gt;&lt;a href=&quot;#三-合作的目的&quot; class=&quot;headerlink&quot; title=&quot;三. 合作的目的&quot;&gt;&lt;/a&gt;三. 合作的目的&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;共同发展合作医疗和旅游行业,为海南的经济腾飞插上腾飞的翅膀.&lt;/li&gt;
&lt;li&gt;把海南的医疗旅游行业在最短的时间内,带到全中国,然后感染全世界,让海南成为中国唯一的医疗旅游目的地.&lt;/li&gt;
&lt;li&gt;让来到海南岛的人不仅享受旅游,还能收获健康,让中国人不出国就能享受最好的医疗服务和最好的医疗资源.&lt;/li&gt;
&lt;li&gt;根据市场研究表明,美国的肿瘤筛查分析,因为易感基因检测,癌症发病率下降了70%,所以为全国人民带来健康,我们已早期癌症筛查为目的,使全国人民的癌症等发病率降低到最低点,使全国人民正确的防癌,抗癌,使全国乃至全世界的人民的健康在旅游的带领下达到最高峰.&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id=&quot;四-发展方向目标&quot;&gt;&lt;a href=&quot;#四-发展方向目标&quot; class=&quot;headerlink&quot; title=&quot;四. 发展方向目标&quot;&gt;&lt;/a&gt;四. 发展方向目标&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;&lt;ol&gt;
&lt;li&gt;目标为中国国人,和二线国家的人群. 比如俄罗斯. 东南亚市场.&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;li&gt;&lt;ol&gt;
&lt;li&gt;重心可放在中年人身上,这部分的人年龄分别在35岁至55岁,事业高峰期,都处于公司中高管,家庭条件比较优越,同样也属于亚健康高发年龄段.根据有关体检医疗分析,这类人注重追求医疗质量. 技术,以及高质量的服务,这部分人子女大部分不在身边,大部分在外求学或以刚结婚,处于空巢期和失落期,会去旅游满足自己心理的需求,也对自身的身体状况也比较重视.体检游套餐价格可以定制中高端.这个年龄的阶段都在工作,此宣传可以放在国庆长假,年假等节假日.&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;li&gt;&lt;ol&gt;
&lt;li&gt;随着人口老龄化的严重性,也是给我们一个很好的机会,老年身上大大小小的都有些小毛病,不像年轻人,也很怕生病,我们可以在冬季大力和旅行社合作推广这个活动,价格定在中端为宜,老年人消费能力弱,可好在冬季我们海南岛拥有独特的优势,也成了很多人尽孝的好时机,让父母在寒冷的冬季过来度个假,检查一下身体,为父母解忧,天时地利人和.这个可以放在第二个重心.&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;li&gt;4.其次,放在年轻人,大部分消费能力有限,体检游价格定在中低端,可以开发一些婚前体检,白领套餐等….&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&quot;五-合作模式&quot;&gt;&lt;a href=&quot;#五-合作模式&quot; class=&quot;headerlink&quot; title=&quot;五. 合作模式&quot;&gt;&lt;/a&gt;五. 合作模式&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;&lt;ol&gt;
&lt;li&gt;旅行社和我院体检中心合作&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;li&gt;&lt;ol&gt;
&lt;li&gt;旅行社和医疗部门&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;li&gt;&lt;ol&gt;
&lt;li&gt;旅行社和我院的医生&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;li&gt;&lt;ol&gt;
&lt;li&gt;旅行社与我院签署战略框架协议&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&quot;六-合作具体措施&quot;&gt;&lt;a href=&quot;#六-合作具体措施&quot; class=&quot;headerlink&quot; title=&quot;六. 合作具体措施&quot;&gt;&lt;/a&gt;六. 合作具体措施&lt;/h3&gt;&lt;h4 id=&quot;一-旅行社和海南省肿瘤医院体检中心合作&quot;&gt;&lt;a href=&quot;#一-旅行社和海南省肿瘤医院体检中心合作&quot; class=&quot;headerlink&quot; title=&quot;(一)旅行社和海南省肿瘤医院体检中心合作&quot;&gt;&lt;/a&gt;(一)旅行社和海南省肿瘤医院体检中心合作&lt;/h4&gt;&lt;h5 id=&quot;1-我院提供体-检前-检中-检后的VIP服务模式&quot;&gt;&lt;a href=&quot;#1-我院提供体-检前-检中-检后的VIP服务模式&quot; class=&quot;headerlink&quot; title=&quot;1. 我院提供体 检前  检中  检后的VIP服务模式.&quot;&gt;&lt;/a&gt;1. 我院提供体 检前  检中  检后的VIP服务模式.&lt;/h5&gt;&lt;p&gt;(1)检前预约. 咨询等服务&lt;br&gt;(2)检中VIP一条龙特殊通道等服务&lt;br&gt;(3)检后 健康跟踪等服务.&lt;/p&gt;
&lt;h5 id=&quot;2-以健康检查为主要方向&quot;&gt;&lt;a href=&quot;#2-以健康检查为主要方向&quot; class=&quot;headerlink&quot; title=&quot;2. 以健康检查为主要方向&quot;&gt;&lt;/a&gt;2. 以健康检查为主要方向&lt;/h5&gt;&lt;p&gt;(1)从健康肿瘤筛查为重点推广对象,可分为周期性肿瘤筛查,基因检测,循环肿瘤检测. 早期肿瘤筛查,心血管疾病,宫颈癌,乳腺癌. 肺癌等肿瘤筛查体检项目.&lt;br&gt;(2)针对不同人群,年龄. 行业. 为旅游者来制定不同的体检项目.&lt;/p&gt;
&lt;h5 id=&quot;3-住院体检的实施-入院进行体检-全天候VIP服务模式-让体检者在最舒适的状态下完成体检&quot;&gt;&lt;a href=&quot;#3-住院体检的实施-入院进行体检-全天候VIP服务模式-让体检者在最舒适的状态下完成体检&quot; class=&quot;headerlink&quot; title=&quot;3. 住院体检的实施:入院进行体检,全天候VIP服务模式,让体检者在最舒适的状态下完成体检.&quot;&gt;&lt;/a&gt;3. 住院体检的实施:入院进行体检,全天候VIP服务模式,让体检者在最舒适的状态下完成体检.&lt;/h5&gt;&lt;h5 id=&quot;4-终身健康顾问-和档案管理-肿瘤观察管理等服务方式-让每一个人的档案具有完整跟踪性-我们中心健康评估的重点要不在于检测-而在于与体验医师的交流-包括营养服务和压力管理咨询等-体检结束后-也要让游客感觉到不须此行&quot;&gt;&lt;a href=&quot;#4-终身健康顾问-和档案管理-肿瘤观察管理等服务方式-让每一个人的档案具有完整跟踪性-我们中心健康评估的重点要不在于检测-而在于与体验医师的交流-包括营养服务和压力管理咨询等-体检结束后-也要让游客感觉到不须此行&quot; class=&quot;headerlink&quot; title=&quot;4. 终身健康顾问,和档案管理,肿瘤观察管理等服务方式,让每一个人的档案具有完整跟踪性.我们中心健康评估的重点要不在于检测,而在于与体验医师的交流.包括营养服务和压力管理咨询等.体检结束后,也要让游客感觉到不须此行.&quot;&gt;&lt;/a&gt;4. 终身健康顾问,和档案管理,肿瘤观察管理等服务方式,让每一个人的档案具有完整跟踪性.我们中心健康评估的重点要不在于检测,而在于与体验医师的交流.包括营养服务和压力管理咨询等.体检结束后,也要让游客感觉到不须此行.&lt;/h5&gt;&lt;h4 id=&quot;二-旅行社和海南省肿瘤医院医疗部门合作&quot;&gt;&lt;a href=&quot;#二-旅行社和海南省肿瘤医院医疗部门合作&quot; class=&quot;headerlink&quot; title=&quot;(二)旅行社和海南省肿瘤医院医疗部门合作&quot;&gt;&lt;/a&gt;(二)旅行社和海南省肿瘤医院医疗部门合作&lt;/h4&gt;&lt;blockquote&gt;
&lt;p&gt;借据海南省天时地利人和的优势,让省外人边享受大自然赐给我们最天然的环境,已最放松的状态去接受疾病的治疗,用乐观的心态去看病,使疾病达到最佳治疗状态.(三)旅行社和海南省肿瘤医院专家资源合作&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;ol&gt;
&lt;li&gt;开展肿瘤筛查宣传日,让全国所有的癌症患者来到海南省,在我院专家的帮助下,共同对抗癌症,和享受大自然的环境.&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;li&gt;&lt;ol&gt;
&lt;li&gt;专家开展课程,帮助全世界的人民一起防癌,抗癌.&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/blockquote&gt;
&lt;h4 id=&quot;四-旅行社与海南省肿瘤医院签署战略框架协议；&quot;&gt;&lt;a href=&quot;#四-旅行社与海南省肿瘤医院签署战略框架协议；&quot; class=&quot;headerlink&quot; title=&quot;(四)旅行社与海南省肿瘤医院签署战略框架协议；&quot;&gt;&lt;/a&gt;(四)旅行社与海南省肿瘤医院签署战略框架协议；&lt;/h4&gt;&lt;p&gt;经双方沟通协商后,达成一致合作,旅行社与海南省肿瘤医院签署战略框架协议,为后期双方更好的合作. 宣传. 发展奠定基础.&lt;/p&gt;
&lt;h3 id=&quot;七-实施计划及方案&quot;&gt;&lt;a href=&quot;#七-实施计划及方案&quot; class=&quot;headerlink&quot; title=&quot;七. 实施计划及方案&quot;&gt;&lt;/a&gt;七. 实施计划及方案&lt;/h3&gt;&lt;p&gt;海南省肿瘤医院拟共享本院有特色的医疗服务资源,与各大旅行社开展医疗服务项目的推广和合作,细分市场,开创创新性的医疗服务新模式.&lt;br&gt;各有意向合作的旅行社依据各自的客户群体. 地区政策及医疗推广等优势进行考察. 研究. 策划,然后出具具有创新性(独创)方案及可行性的合作模式.&lt;br&gt;本院对各大旅游集团方案进行可行性研究,筛选出优秀的合作方案并进行初期市场验证,形成行之有效并且与之单独的长期合作的可持续发展模式,然后在根据各行业的市场策划和区域等优势,确定合作的深度和广度,在进行细分化,从而规划市场的统一性,从而保证保证市场的的规则性和公平性,&lt;br&gt;也为了更好的规范海南医疗旅游市场.&lt;/p&gt;
&lt;h3 id=&quot;八-效果预估&quot;&gt;&lt;a href=&quot;#八-效果预估&quot; class=&quot;headerlink&quot; title=&quot;八. 效果预估&quot;&gt;&lt;/a&gt;八. 效果预估&lt;/h3&gt;&lt;p&gt;…&lt;/p&gt;
&lt;h3 id=&quot;九-目前的问题&quot;&gt;&lt;a href=&quot;#九-目前的问题&quot; class=&quot;headerlink&quot; title=&quot;九. 目前的问题&quot;&gt;&lt;/a&gt;九. 目前的问题&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;1.医疗保险体制问题&lt;/li&gt;
&lt;li&gt;2.国际认证问题&lt;/li&gt;
&lt;li&gt;3.医疗旅游工作管理策划团队问题&lt;/li&gt;
&lt;li&gt;4.行业的保护性问题&lt;/li&gt;
&lt;li&gt;5.行业区分,和返点的问题.&lt;/li&gt;
&lt;li&gt;6.税务问题&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&quot;计划及谈判内容&quot;&gt;&lt;a href=&quot;#计划及谈判内容&quot; class=&quot;headerlink&quot; title=&quot;计划及谈判内容:&quot;&gt;&lt;/a&gt;计划及谈判内容:&lt;/h3&gt;&lt;p&gt;海南省肿瘤医院被列入海南省”十二五”重点医疗规划和省市共建重点项目. 2015年省委省政府为民办实事十大重点项目,是非营利性的民营医院, 特殊医疗服务有肿瘤防治,国际医疗转诊.不管是医院设计,规模,专家,检验医疗设备等等,都是最独特先进优秀的,填补了海南省的空缺,我们以专科医院在筛查,治疗和肿瘤防治上是目前是海南省最专业的专科医院.&lt;br&gt;可以利用医院的环境,专家等强大背景做宣传.主打一个主角做我们的专长特色,利用我们的肿瘤专业,可以用早期癌症筛查和宣教一系列套餐做招牌,这块主要精力放在中老年,以这个为主,其它的为辅.旅客可根据自身的需求选择体检套餐,比如老年人,年轻人,糖尿病,冠心病…….,价格分几百到几万不等,根据自己的身体需求和经济条件进行选择.&lt;br&gt;冬天:以老人的常见疾病为主题进行宣传引导.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;1．旅行社负责客源和宣传,我们负责体检,车,食,住宿.合作期间我们任何时间和地点都可以负责服务和医疗技术支持:关于医疗上的问题,员工的健康问题,导游的业务上的培训,等等问题.旅游线路,和整体套餐价格由旅行社制定,我们体检价格原价给旅行社.以分成的形式结算.&lt;br&gt;2017年可把全海南省旅行社的任务量定在100万,下发每一家合作旅行社任务量,一年如完成20万及以下的指标给2成利润,20万以上3成利润.&lt;br&gt;福利:如完成合同量,免费定期停供员工的体检,培训,也可共同制作体检游的策划营销方案.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;2.我们的vip体检客户办卡赠送旅游套餐.充值Vip卡比如满1万送3天一夜旅游…..&lt;br&gt;找外省的大型公司,国企,政府部门推广体检送旅游的活动,对象也可扩展到员工的家属,家人,情侣,等.车,机票,住宿,我们负责然后跟当地的旅游公司详细制定旅游线路并给予旅游公司一定的服务报酬.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;3.跟海南各航天公司合作,让他们制定广告,如机票广告,机场条幅,官网,等进行体检游的广告宣传.谈判内容:他们一年中赠送我们免费机票,我们提供他们员工体检.互惠互利.谈判成功,制定合同.&lt;br&gt;采用健检游路线和采用治疗旅游:以旅游观光. 健康检查. 为主要内容.能享受和参观到全海南最专业的医院体检和治疗服务.&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;对旅行社的好处:可采用员工积分制:带团人数,或者金额超过多少,可提高员工工作的积极性,可免费提供员工定期体检,也可让员工的家人免费体检,体检游不仅让旅行社获利.更让员工身体健康也兼顾家庭,通过宣传更可提高旅行社的知名度和业绩等等…..&lt;/p&gt;
&lt;h3 id=&quot;市场分布&quot;&gt;&lt;a href=&quot;#市场分布&quot; class=&quot;headerlink&quot; title=&quot;市场分布&quot;&gt;&lt;/a&gt;市场分布&lt;/h3&gt;&lt;blockquote&gt;
&lt;p&gt;海南省有将近1000家左右的旅行社,可逐一推荐,分别是(如下图所示)&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;有旅游景点的&lt;br&gt;1.三亚2.五指山3.乐东4.保亭5.陵水6.三沙&lt;br&gt;7.文昌 8.定安 9 琼海  10万宁 11 炖昌 12 琼中 13 杨浦&lt;br&gt;14临高  15昌江  16儋州 17 澄迈 18东方19 昌江20 海口市区&lt;br&gt;以上地区均有旅游优美的旅游景点&lt;/p&gt;
</content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;海南省医疗旅游联盟合作策划书&quot;&gt;&lt;a href=&quot;#海南省医疗旅游联盟合作策划书&quot; class=&quot;headerlink&quot; title=&quot;海南省医疗旅游联盟合作策划书&quot;&gt;&lt;/a&gt;海南省医疗旅游联盟合作策划书&lt;/h2&gt;&lt;h3 id=&quot;一-医疗旅游的现状&quot;&gt;&lt;a hre
    
    </summary>
    
    
  </entry>
  
  <entry>
    <title>LinuxCommand</title>
    <link href="https://coam.co/2016/05/15/Linux/LinuxCommand/"/>
    <id>https://coam.co/2016/05/15/Linux/LinuxCommand/</id>
    <published>2016-05-15T09:15:31.000Z</published>
    <updated>2016-05-18T13:19:29.450Z</updated>
    
    <content type="html">&lt;a id=&quot;more&quot;&gt;&lt;/a&gt;
&lt;h3 id=&quot;Linux最常用的几个命令&quot;&gt;&lt;a href=&quot;#Linux最常用的几个命令&quot; class=&quot;headerlink&quot; title=&quot;Linux最常用的几个命令&quot;&gt;&lt;/a&gt;Linux最常用的几个命令&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;chmod命令 #后就是这个命令的说明&lt;/li&gt;
&lt;/ul&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;chmod +x /home/auto.sh &lt;span class=&quot;comment&quot;&gt;# 赋予 auto.sh 可执行权限&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;chmod -R &lt;span class=&quot;number&quot;&gt;777&lt;/span&gt; /home/wwwroot &lt;span class=&quot;comment&quot;&gt;# 赋予 /home/wwwroot 写入权限(部分网站程序安装时需要用到)&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;ul&gt;
&lt;li&gt;rm命令 删除文件&lt;/li&gt;
&lt;/ul&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;rm test.tar.gz &lt;span class=&quot;comment&quot;&gt;# 删除test.tar.gz,会有提示你确认 y即可&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;rm -rf /home/wwwroot/&lt;span class=&quot;built_in&quot;&gt;test&lt;/span&gt; &lt;span class=&quot;comment&quot;&gt;# 无提示直接删除test目录,勿乱用,切记.&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;ul&gt;
&lt;li&gt;tar命令 C打包和X解压文件&lt;/li&gt;
&lt;/ul&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;tar zcvf test.tar.gz /home/wwwroot &lt;span class=&quot;comment&quot;&gt;#把/home/wwwroot打包&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;tar zxvf tet.tar.gz &lt;span class=&quot;comment&quot;&gt;# 在当前目录解压test.tar.gz&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;ul&gt;
&lt;li&gt;zip 打包命令 unzip解压文件&lt;/li&gt;
&lt;/ul&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;zip -r tester.zip /home/wwwroot &lt;span class=&quot;comment&quot;&gt;#把/home/wwwroot打包&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;unzip teter.zip &lt;span class=&quot;comment&quot;&gt;# 在当前目录解压test.tar.gz&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;ul&gt;
&lt;li&gt;Linux SSH远程传输命令 scp&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&quot;一-scp-的用处&quot;&gt;&lt;a href=&quot;#一-scp-的用处&quot; class=&quot;headerlink&quot; title=&quot;一. scp 的用处&quot;&gt;&lt;/a&gt;一. scp 的用处&lt;/h3&gt;&lt;p&gt;如果你有几台云主机,而阿里是支持内网传输的,并且不限制带宽,正常传输文件的速度能达到35m~50m/s,这个时候我们就可以使用内网,在几台云主机之间传输命令,只要把域名处,换成内网IP即可.使用的命令是scp,这个命令linux内置,本机和目标机,只要支持ssh,无须安装设置任何软件.&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;获取远程服务器上的文件&lt;/li&gt;
&lt;/ol&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;scp -P &lt;span class=&quot;number&quot;&gt;2222&lt;/span&gt; root@www.legcloud.com:/root/test.tar.gz /home/test.tar.gz&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;上端口大写P 为参数,2222 表示更改SSH端口后的端口,如果没有更改SSH端口可以不用添加该参数. root@www.legcloud.com 表示使用root用户登录远程服务器www.legcloud.com,:/root/test.tar.gz 表示远程服务器上的文件,最后面的/home/test.tar.gz表示保存在本地上的路径和文件名.&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;获取远程服务器上的目录&lt;/li&gt;
&lt;/ol&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;scp -P &lt;span class=&quot;number&quot;&gt;2222&lt;/span&gt; -r root@www.legcloud.com:/root/dirname/ /home/dirname/&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;ol&gt;
&lt;li&gt;将本地文件上传到服务器上&lt;/li&gt;
&lt;/ol&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;scp -P &lt;span class=&quot;number&quot;&gt;2222&lt;/span&gt; /home/test.tar.gz root@www.legcloud.com:/root/test.tar.gz&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;ol&gt;
&lt;li&gt;将本地目录上传到服务器上&lt;/li&gt;
&lt;/ol&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;scp -P &lt;span class=&quot;number&quot;&gt;2222&lt;/span&gt; -r /home/dirname/ root@www.legcloud.com:/root/dirname/&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;&lt;a href=&quot;https://wiki.vpsmm.com/scp/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;Linux SSH远程传输命令 scp&lt;/a&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;使用 iftop 查看实时使用带宽&lt;/li&gt;
&lt;/ul&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;20&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# 如果你是 centos 系统,执行:&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;yum install iftop&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# 如果你是 debian/ubuntu 系统,执行:&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;apt-get install iftop&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# 使用 ifconfig ,查看所有网络配置,使用 -i 参数选择相关网络.&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;ifconfig&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# 阿里云默认的 iftop ,执行查看的是第一个,即内网的IP,以下二个命令效果相同&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;iftop&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;iftop -i eth0&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# 如果查看外网带宽,则需要选择外网配置的eth,默认命令&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;iftop -i eth1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
</content>
    
    <summary type="html">
    
      &lt;a id=&quot;more&quot;&gt;&lt;/a&gt;
&lt;h3 id=&quot;Linux最常用的几个命令&quot;&gt;&lt;a href=&quot;#Linux最常用的几个命令&quot; class=&quot;headerlink&quot; title=&quot;Linux最常用的几个命令&quot;&gt;&lt;/a&gt;Linux最常用的几个命令&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;ch
    
    </summary>
    
    
  </entry>
  
  <entry>
    <title>MysqlSyncNote</title>
    <link href="https://coam.co/2016/05/14/Mysql/MysqlSyncNote/"/>
    <id>https://coam.co/2016/05/14/Mysql/MysqlSyncNote/</id>
    <published>2016-05-14T09:03:31.000Z</published>
    <updated>2016-05-19T08:26:49.403Z</updated>
    
    <content type="html">&lt;h3 id=&quot;Mysql双机热备份&quot;&gt;&lt;a href=&quot;#Mysql双机热备份&quot; class=&quot;headerlink&quot; title=&quot;Mysql双机热备份&quot;&gt;&lt;/a&gt;Mysql双机热备份&lt;/h3&gt;&lt;h4 id=&quot;Mysql-主从同步配置&quot;&gt;&lt;a href=&quot;#Mysql-主从同步配置&quot; class=&quot;headerlink&quot; title=&quot;Mysql 主从同步配置&quot;&gt;&lt;/a&gt;Mysql 主从同步配置&lt;/h4&gt;&lt;p&gt;概述 首先主服务器把数据变化记录到主日志,然后从服务器通过I/O线程读取主服务器上的主日志,并且把它写入到从服务器的中继日志中,接着SQL线程读取中继日志,并且在从服务器上重放,从而实现MySQL复制.具体如下图所示:&lt;/p&gt;
&lt;p&gt;replication&lt;/p&gt;
&lt;p&gt;整个过程反映到从服务器上,对应三套日志信息,可在从服务器上用如下命令查看:&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;mysql&amp;gt; SHOW SLAVE STATUS;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;pre&gt;&lt;code&gt;Master_Log_File &amp;amp; Read_Master_Log_Pos:下一个传输的主日志信息.
Relay_Master_Log_File &amp;amp; Exec_Master_Log_Pos:下一个执行的主日志信息.
Relay_Log_File &amp;amp; Relay_Log_Pos:下一个执行的中继日志信息.
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;理解这些日志信息的含义对于解决故障至关重要&lt;/p&gt;
&lt;p&gt;两台服务器搭建Mysql双机热备份 mysql 版本最好一致&lt;/p&gt;
&lt;hr&gt;
&lt;h4 id=&quot;一-A主B从&quot;&gt;&lt;a href=&quot;#一-A主B从&quot; class=&quot;headerlink&quot; title=&quot;一. A主B从&quot;&gt;&lt;/a&gt;一. A主B从&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;主服务器 A: 43.241.222.110&lt;/li&gt;
&lt;li&gt;从服务器 B: 42.96.194.60&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;在主A服务器(master)下创建给从B服务器 (slave)登录用的用户名密码&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;GRANT REPLICATION SLAVE ON *.* TO &lt;span class=&quot;string&quot;&gt;&#39;syBackup&#39;&lt;/span&gt;@&lt;span class=&quot;string&quot;&gt;&#39;42.96.194.60&#39;&lt;/span&gt; IDENTIFIED BY &lt;span class=&quot;string&quot;&gt;&#39;******&#39;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;ol&gt;
&lt;li&gt;设置主服务器 A 需要复制的数据库&lt;br&gt;打开主服务器 A 的Mysql配置文件 &lt;em&gt;/etc/mysql/my.cnf&lt;/em&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;28&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;29&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;#################################################&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;server-id=&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt; &lt;span class=&quot;comment&quot;&gt;#主机id,整数&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;#开启二进制日志,并且名称为 /var/lib/mysql/mysql-bin.***&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# 如果是个路径则,保存到该路径下(log-bin=/var/log/mysql-bin.log -&amp;gt; /var/log/mysql-bin.***)&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;built_in&quot;&gt;log&lt;/span&gt;-bin=mysql-bin&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;### as master ###&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;built_in&quot;&gt;read&lt;/span&gt;-only=&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt; &lt;span class=&quot;comment&quot;&gt;#主机读写权限,读写都可以&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;binlog-do-db=CoamDatabase &lt;span class=&quot;comment&quot;&gt;#记录日志的数据库:需要的备份数据,多个写多行&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;binlog-do-db=CoamInfo&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;binlog-do-db=CoamSNS&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;binlog-do-db=form&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;binlog-do-db=CommonData&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;binlog-do-db=Wordpress&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;binlog-do-db=IM_Ejabberd&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;binlog-ignore-db=mysql &lt;span class=&quot;comment&quot;&gt;#不记录日志的数据库:不需要备份的数据库,多个写多行&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;binlog-ignore-db=&lt;span class=&quot;built_in&quot;&gt;test&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;binlog-ignore-db=information_schema&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;binlog-ignore-db=performance_schema&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# 自增字段奇数递增,防止冲突(1, 11, 21, ...,)&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;auto-increment-increment = &lt;span class=&quot;number&quot;&gt;10&lt;/span&gt; &lt;span class=&quot;comment&quot;&gt;# 每次递增的步长&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;auto-increment-offset = &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt; &lt;span class=&quot;comment&quot;&gt;# 初始值&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;### as slave ###&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;###&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;###############################################################&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;重启 Mysql 是配置生效,可以看到主(43.241.222.110) Mysql  增加了两个文件 mysql-bin.000001 和 mysql-bin.index &lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;Tue May &lt;span class=&quot;number&quot;&gt;17&lt;/span&gt; &lt;span class=&quot;number&quot;&gt;10&lt;/span&gt;:&lt;span class=&quot;number&quot;&gt;31&lt;/span&gt;:&lt;span class=&quot;number&quot;&gt;52&lt;/span&gt; yzhang@coam:/data/home/data/mysql$ ls&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;auto.cnf         client-key.pem  coam.pid    ib_buffer_pool  ibtmp1           performance_schema  server-key.pem&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;ca-key.pem       CoamDatabase    CoamSNS     ibdata1         IM_Ejabberd      private_key.pem     sys&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;ca.pem           coam.err        CommonData  ib_logfile0     mysql            public_key.pem      &lt;span class=&quot;built_in&quot;&gt;test&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;client-cert.pem  CoamInfo        forum       ib_logfile1     mysqld_safe.pid  server-cert.pem     Wordpress&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;Tue May &lt;span class=&quot;number&quot;&gt;17&lt;/span&gt; &lt;span class=&quot;number&quot;&gt;10&lt;/span&gt;:&lt;span class=&quot;number&quot;&gt;31&lt;/span&gt;:&lt;span class=&quot;number&quot;&gt;52&lt;/span&gt; yzhang@coam:/data/home/data/mysql$ sudo service mysql restart       ======&amp;gt; 重启 Mysql 数据库服务&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;Tue May &lt;span class=&quot;number&quot;&gt;17&lt;/span&gt; &lt;span class=&quot;number&quot;&gt;10&lt;/span&gt;:&lt;span class=&quot;number&quot;&gt;31&lt;/span&gt;:&lt;span class=&quot;number&quot;&gt;52&lt;/span&gt; yzhang@coam:/data/home/data/mysql$ ls&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;auto.cnf         CoamDatabase  CommonData      ib_logfile1       mysql-bin.&lt;span class=&quot;number&quot;&gt;000002&lt;/span&gt;  performance_schema  sys&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;ca-key.pem       coam.err      forum           ibtmp1            mysql-bin.&lt;span class=&quot;number&quot;&gt;000003&lt;/span&gt;  private_key.pem     &lt;span class=&quot;built_in&quot;&gt;test&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;ca.pem           CoamInfo      ib_buffer_pool  IM_Ejabberd       mysql-bin.&lt;span class=&quot;number&quot;&gt;000004&lt;/span&gt;  public_key.pem      Wordpress&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;client-cert.pem  coam.pid      ibdata1         mysql             mysql-bin.index   server-cert.pem&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;client-key.pem   CoamSNS       ib_logfile0     mysql-bin.&lt;span class=&quot;number&quot;&gt;000001&lt;/span&gt;  mysqld_safe.pid   server-key.pem&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;– 注意,这里因为配置有问题重启过几次 mysql 导致生成 [mysql-bin.000001 mysql-bin.000002 mysql-bin.000003 mysql-bin.000004] 等几个文件,不过不影响后续步骤执行&lt;/p&gt;
&lt;p&gt;先锁定 (hello) 数据库 - 不要退出 mysql shell&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;mysql&amp;gt; FLUSH TABLES WITH READ LOCK;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;然后新开一个终端,导出数据库,我这里只需要导出 hello 数据库, 如果你有多个数据库作为初态的话, 需要导出所有这些数据库:( 这里为了便于测试,我先不导出 forum 数据库,后续测试单独补加同步数据库)&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;mysqldump --master-data -uroot -p hello &amp;gt; hello.sql&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;mysqldump -u username -p password --databases CoamDatabase CoamInfo CoamSNS CommonData Wordpress IM_Ejabberd &amp;gt;backup.sql&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;查看主服务器的状态&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;mysql&amp;gt; show master status\G;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;*************************** &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;. row ***************************&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;             File: mysql-bin.&lt;span class=&quot;number&quot;&gt;000005&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;         Position: &lt;span class=&quot;number&quot;&gt;154&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;     Binlog_Do_DB: CoamDatabase,CoamInfo,CoamSNS,forum,CommonData,Wordpress,IM_Ejabberd&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; Binlog_Ignore_DB: mysql,&lt;span class=&quot;built_in&quot;&gt;test&lt;/span&gt;,information_schema,performance_schema&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;Executed_Gtid_Set:&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt; row &lt;span class=&quot;keyword&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;built_in&quot;&gt;set&lt;/span&gt; (&lt;span class=&quot;number&quot;&gt;0.00&lt;/span&gt; sec)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;ERROR:&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;No query specified&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;然后查看A服务器的 binary 日志位置,记下 Position 和 File 的值.&lt;/p&gt;
&lt;p&gt;主服务器已经做完了, 可以解除锁定了&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;UNLOCK TABLES;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;ol&gt;
&lt;li&gt;设置从服务器 B 需要复制的数据库&lt;br&gt;打开从服务器 B 的 Mysql 配置文件 &lt;em&gt;/etc/mysql/my.cnf&lt;/em&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;28&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;[mysqld]&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;####################################################################&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;server-id=&lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;built_in&quot;&gt;log&lt;/span&gt;-bin=mysql-bin&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;### as master ###&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;### as slave ###&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;replicate-do-db=CoamDatabase &lt;span class=&quot;comment&quot;&gt;#只复制某个库,多个写多行&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;replicate-do-db=CoamInfo&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;replicate-do-db=CoamSNS&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;replicate-do-db=form&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;replicate-do-db=CommonData&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;replicate-do-db=Wordpress&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;replicate-do-db=IM_Ejabberd&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;replicate-ignore-db=mysql &lt;span class=&quot;comment&quot;&gt;#不复制某个库&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;replicate-ignore-db=&lt;span class=&quot;built_in&quot;&gt;test&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;replicate-ignore-db=information_schema&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;replicate-ignore-db=performance_schema&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;relay-log=mysqld-relay-bin &lt;span class=&quot;comment&quot;&gt;# 开启日志中继&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;built_in&quot;&gt;log&lt;/span&gt;-slave-updates &lt;span class=&quot;comment&quot;&gt;# slave 将复制事件写进自己的二进制日志&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;#5.5&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;#log-slave-updates = ON&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;#5.1&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;#log-slave-updates = 1&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;###############################################################&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;重启 Mysql 是配置生效,可以看到从(42.96.194.60) Mysql  也相应的增加了两个文件 mysql-bin.000001 和 mysql-bin.index &lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;Tue May &lt;span class=&quot;number&quot;&gt;17&lt;/span&gt; &lt;span class=&quot;number&quot;&gt;11&lt;/span&gt;:&lt;span class=&quot;number&quot;&gt;07&lt;/span&gt;:&lt;span class=&quot;number&quot;&gt;14&lt;/span&gt; yzhang@coam:/data/home/data/mysql$ ls&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;auto.cnf    client-cert.pem  coam.pid        ib_logfile0  mysql               private_key.pem  server-key.pem&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;ca-key.pem  client-key.pem   ib_buffer_pool  ib_logfile1  mysqld_safe.pid     public_key.pem   sys&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;ca.pem      coam.err         ibdata1         ibtmp1       performance_schema  server-cert.pem&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;Tue May &lt;span class=&quot;number&quot;&gt;17&lt;/span&gt; &lt;span class=&quot;number&quot;&gt;10&lt;/span&gt;:&lt;span class=&quot;number&quot;&gt;31&lt;/span&gt;:&lt;span class=&quot;number&quot;&gt;52&lt;/span&gt; yzhang@coam:/data/home/data/mysql$ sudo service mysql restart       ======&amp;gt; 重启 Mysql 数据库服务&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;Tue May &lt;span class=&quot;number&quot;&gt;17&lt;/span&gt; &lt;span class=&quot;number&quot;&gt;11&lt;/span&gt;:&lt;span class=&quot;number&quot;&gt;08&lt;/span&gt;:&lt;span class=&quot;number&quot;&gt;40&lt;/span&gt; yzhang@coam:/data/home/data/mysql$ ls&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;auto.cnf    client-cert.pem  coam.pid        ib_logfile0  mysql             mysqld_safe.pid     public_key.pem   sys&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;ca-key.pem  client-key.pem   ib_buffer_pool  ib_logfile1  mysql-bin.&lt;span class=&quot;number&quot;&gt;000001&lt;/span&gt;  performance_schema  server-cert.pem&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;ca.pem      coam.err         ibdata1         ibtmp1       mysql-bin.index   private_key.pem     server-key.pem&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;导入从主服务器导出的数据库 hello,然后&lt;/p&gt;
&lt;p&gt;导入 master 导出的数据库:&lt;/p&gt;
&lt;p&gt;分别创建需要导入的数据库&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;mysql&amp;gt; CREATE DATABASE CoamDatabase DEFAULT CHARACTER SET utf8 DEFAULT COLLATE utf8_general_ci;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;mysql&amp;gt; CREATE DATABASE CoamInfo DEFAULT CHARACTER SET utf8 DEFAULT COLLATE utf8_general_ci;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;mysql&amp;gt; CREATE DATABASE CoamSNS DEFAULT CHARACTER SET utf8 DEFAULT COLLATE utf8_general_ci;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;mysql&amp;gt; CREATE DATABASE CommonData DEFAULT CHARACTER SET utf8 DEFAULT COLLATE utf8_general_ci;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;mysql&amp;gt; CREATE DATABASE Wordpress DEFAULT CHARACTER SET utf8 DEFAULT COLLATE utf8_general_ci;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;mysql&amp;gt; CREATE DATABASE IM_Ejabberd DEFAULT CHARACTER SET utf8 DEFAULT COLLATE utf8_general_ci;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;mysql&amp;gt; &lt;span class=&quot;built_in&quot;&gt;source&lt;/span&gt; backup.sql;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# 以下方式分别导入数据库&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;mysql -uroot -p CoamDatabase &amp;lt; backup.sql&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;mysql -uroot -p CoamInfo &amp;lt; backup.sql&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;mysql -uroot -p CoamSNS &amp;lt; backup.sql&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;mysql -uroot -p CommonData &amp;lt; backup.sql&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;mysql -uroot -p Wordpress &amp;lt; backup.sql&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;mysql -uroot -p IM_Ejabberd &amp;lt; backup.sql&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;ol&gt;
&lt;li&gt;在从 slave 服务器配置连接 master 信息:&lt;/li&gt;
&lt;/ol&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;mysql&amp;gt; slave stop;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;mysql&amp;gt; CHANGE MASTER TO&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;-&amp;gt; MASTER_HOST=&lt;span class=&quot;string&quot;&gt;&#39;43.241.222.110&#39;&lt;/span&gt;, //主服务器的IP地址&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;-&amp;gt; MASTER_USER=&lt;span class=&quot;string&quot;&gt;&#39;syBackup&#39;&lt;/span&gt;, //同步数据库的用户&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;-&amp;gt; MASTER_PASSWORD=&lt;span class=&quot;string&quot;&gt;&#39;******&#39;&lt;/span&gt;, //同步数据库的密码&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;-&amp;gt; MASTER_CONNECT_RETRY=&lt;span class=&quot;number&quot;&gt;60&lt;/span&gt;,  // 如果从服务器发现主服务器断掉,重新连接的时间差(秒)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;-&amp;gt; MASTER_LOG_FILE=&lt;span class=&quot;string&quot;&gt;&#39;mysql-bin.000001&#39;&lt;/span&gt;, //主服务器二进制日志的文件名(前面要求记住的 File 参数)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;-&amp;gt; MASTER_LOG_POS=&lt;span class=&quot;number&quot;&gt;98&lt;/span&gt;; //日志文件的开始位置(前面要求记住的 Position 参数)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;mysql&amp;gt; CHANGE MASTER TO MASTER_HOST=&lt;span class=&quot;string&quot;&gt;&#39;43.241.222.110&#39;&lt;/span&gt;, MASTER_USER=&lt;span class=&quot;string&quot;&gt;&#39;syBackup&#39;&lt;/span&gt;, MASTER_PASSWORD=&lt;span class=&quot;string&quot;&gt;&#39;******&#39;&lt;/span&gt;, MASTER_CONNECT_RETRY=&lt;span class=&quot;number&quot;&gt;60&lt;/span&gt;, MASTER_LOG_FILE=&lt;span class=&quot;string&quot;&gt;&#39;mysql-bin.000005&#39;&lt;/span&gt;, MASTER_LOG_POS=&lt;span class=&quot;number&quot;&gt;154&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;mysql &amp;gt; slave start;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;重启 master, slave:  &lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;service mysqld restart&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;查看 slave 状态:&lt;/p&gt;
&lt;p&gt;进入从服务器 slave mysql:&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;22&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;mysql&amp;gt; show slave status\G;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;*************************** &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;. row ***************************&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            Slave_IO_State: Connecting to master&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                Master_Host: &lt;span class=&quot;number&quot;&gt;43.241&lt;/span&gt;.&lt;span class=&quot;number&quot;&gt;222.110&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                Master_User: syBackup&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                Master_Port: &lt;span class=&quot;number&quot;&gt;3306&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            Connect_Retry: &lt;span class=&quot;number&quot;&gt;60&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            Master_Log_File: mysql-bin.&lt;span class=&quot;number&quot;&gt;000001&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        Read_Master_Log_Pos: &lt;span class=&quot;number&quot;&gt;98&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            Relay_Log_File: mysqld-relay-bin.&lt;span class=&quot;number&quot;&gt;000001&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            Relay_Log_Pos: &lt;span class=&quot;number&quot;&gt;98&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    Relay_Master_Log_File: mysql-bin.&lt;span class=&quot;number&quot;&gt;000001&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        Slave_IO_Running: Yes&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        Slave_SQL_Running: Yes&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            Replicate_Do_DB: CoamDatabase,CoamInfo,CoamSNS,form,CommonData,Wordpress,IM_Ejabberd&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; Replicate_Ignore_DB: mysql,&lt;span class=&quot;built_in&quot;&gt;test&lt;/span&gt;,information_schema,performance_schema,collie,ding,inotseeyou_com,pi&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;wik,trac,wzjp_net&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        Exec_Master_Log_Pos: &lt;span class=&quot;number&quot;&gt;98&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            Relay_Log_Space: &lt;span class=&quot;number&quot;&gt;98&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            Until_Log_Pos: &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    Seconds_Behind_Master: NULL&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt; row &lt;span class=&quot;keyword&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;built_in&quot;&gt;set&lt;/span&gt; (&lt;span class=&quot;number&quot;&gt;0.00&lt;/span&gt; sec)&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;注意一定要有下面两项(IO线程和SQL线程),没有的话查看错误日志(less /var/log/mysqld.log):&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;Slave_IO_Running: Yes&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;Slave_SQL_Running: Yes&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;如果显示这个状态 则稍等一会儿&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;Slave_IO_State: Waiting &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; master to send event&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;测试 master 服务器&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;mysql&amp;gt; use hello;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;Database changed&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;mysql&amp;gt; create table &lt;span class=&quot;built_in&quot;&gt;test&lt;/span&gt;(id int);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;mysql&amp;gt; insert int &lt;span class=&quot;built_in&quot;&gt;test&lt;/span&gt; &lt;span class=&quot;built_in&quot;&gt;set&lt;/span&gt; id=&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;mysql&amp;gt; show master status\G;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;*************************** &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;. row ***************************&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            File: mysql-bin.&lt;span class=&quot;number&quot;&gt;000002&lt;/span&gt;  &lt;span class=&quot;comment&quot;&gt;# 注意这里&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        Position: &lt;span class=&quot;number&quot;&gt;276&lt;/span&gt;    &lt;span class=&quot;comment&quot;&gt;# 注意这里&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    Binlog_Do_DB:&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;CoamDatabase,CoamInfo,CoamSNS,form,CommonData,Wordpress,IM_Ejabberd&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;Binlog_Ignore_DB: mysql,&lt;span class=&quot;built_in&quot;&gt;test&lt;/span&gt;,information_schema,performance_schema,collie,ding,inotseeyou_com,pi&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;wik,trac,wzjp_net&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt; row &lt;span class=&quot;keyword&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;built_in&quot;&gt;set&lt;/span&gt; (&lt;span class=&quot;number&quot;&gt;0.00&lt;/span&gt; sec)&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;测试 slave 服务器&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;28&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;29&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;30&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;31&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;32&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;33&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;34&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;35&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;36&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;37&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;38&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;39&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;40&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;41&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;mysql&amp;gt; use hello;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;mysql&amp;gt; show tables;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;+-----------------+&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;| Tables_&lt;span class=&quot;keyword&quot;&gt;in&lt;/span&gt;_hello |&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;+-----------------+&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;| &lt;span class=&quot;built_in&quot;&gt;test&lt;/span&gt;            | &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;+-----------------+&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt; row &lt;span class=&quot;keyword&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;built_in&quot;&gt;set&lt;/span&gt; (&lt;span class=&quot;number&quot;&gt;0.00&lt;/span&gt; sec)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;mysql&amp;gt; select * from &lt;span class=&quot;built_in&quot;&gt;test&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;+------+&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;| id   |&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;+------+&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;|    &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt; | &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;+------+&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt; row &lt;span class=&quot;keyword&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;built_in&quot;&gt;set&lt;/span&gt; (&lt;span class=&quot;number&quot;&gt;0.00&lt;/span&gt; sec)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;mysql&amp;gt; show slave status\G;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;*************************** &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;. row ***************************&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            Slave_IO_State: Waiting &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; master to send event&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                Master_Host: &lt;span class=&quot;number&quot;&gt;43.241&lt;/span&gt;.&lt;span class=&quot;number&quot;&gt;222.110&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                Master_User: syBackup&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                Master_Port: &lt;span class=&quot;number&quot;&gt;3306&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            Connect_Retry: &lt;span class=&quot;number&quot;&gt;60&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            Master_Log_File: mysql-bin.&lt;span class=&quot;number&quot;&gt;000002&lt;/span&gt;  &lt;span class=&quot;comment&quot;&gt;# 跟 master 一样&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        Read_Master_Log_Pos: &lt;span class=&quot;number&quot;&gt;276&lt;/span&gt;  &lt;span class=&quot;comment&quot;&gt;# 跟 master 一样&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            Relay_Log_File: mysqld-relay-bin.&lt;span class=&quot;number&quot;&gt;000003&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            Relay_Log_Pos: &lt;span class=&quot;number&quot;&gt;413&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    Relay_Master_Log_File: mysql-bin.&lt;span class=&quot;number&quot;&gt;000002&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        Slave_IO_Running: Yes&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        Slave_SQL_Running: Yes&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            Replicate_Do_DB: CoamDatabase,CoamInfo,CoamSNS,form,CommonData,Wordpress,IM_Ejabberd&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; Replicate_Ignore_DB: mysql,&lt;span class=&quot;built_in&quot;&gt;test&lt;/span&gt;,information_schema,performance_schema,collie,ding,inotseeyou_com,pi&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;wik,trac,wzjp_net&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                Last_Errno: &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                Last_Error: &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            Skip_Counter: &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        Exec_Master_Log_Pos: &lt;span class=&quot;number&quot;&gt;276&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            Relay_Log_Space: &lt;span class=&quot;number&quot;&gt;413&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    Seconds_Behind_Master: &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt; row &lt;span class=&quot;keyword&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;built_in&quot;&gt;set&lt;/span&gt; (&lt;span class=&quot;number&quot;&gt;0.00&lt;/span&gt; sec)&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;主A服务器从B服务器配置就已经顺利完成了 –A从B主&lt;/p&gt;
&lt;hr&gt;
&lt;h4 id=&quot;二-下面开始配置从A服务器主B服务器&quot;&gt;&lt;a href=&quot;#二-下面开始配置从A服务器主B服务器&quot; class=&quot;headerlink&quot; title=&quot;二. 下面开始配置从A服务器主B服务器&quot;&gt;&lt;/a&gt;二. 下面开始配置从A服务器主B服务器&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;从服务器 A: 43.241.222.110&lt;/li&gt;
&lt;li&gt;主服务器 B: 42.96.194.60&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;一、设置主服务器 A 需要复制的数据库&lt;br&gt;打开主服务器 B 的 Mysql 配置文件 &lt;em&gt;/etc/mysql/my.cnf&lt;/em&gt; 并添加以下配置项&lt;/p&gt;
&lt;figure class=&quot;highlight ini&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;26&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;###############################################################&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;setting&quot;&gt;server-id=&lt;span class=&quot;value&quot;&gt;&lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;setting&quot;&gt;log-bin=&lt;span class=&quot;value&quot;&gt;mysql-bin&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;### as master ###&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;setting&quot;&gt;read-only=&lt;span class=&quot;value&quot;&gt;&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt; #主机读写权限,读写都可&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;setting&quot;&gt;binlog-do-db=&lt;span class=&quot;value&quot;&gt;CoamDatabase #记录日志的数据库:需要的备份数据,多个写多行&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;setting&quot;&gt;binlog-do-db=&lt;span class=&quot;value&quot;&gt;CoamInfo&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;setting&quot;&gt;binlog-do-db=&lt;span class=&quot;value&quot;&gt;CoamSNS&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;setting&quot;&gt;binlog-do-db=&lt;span class=&quot;value&quot;&gt;form&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;setting&quot;&gt;binlog-do-db=&lt;span class=&quot;value&quot;&gt;CommonData&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;setting&quot;&gt;binlog-do-db=&lt;span class=&quot;value&quot;&gt;Wordpress&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;setting&quot;&gt;binlog-do-db=&lt;span class=&quot;value&quot;&gt;IM_Ejabberd&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;setting&quot;&gt;binlog-ignore-db=&lt;span class=&quot;value&quot;&gt;mysql #不记录日志的数据库:不需要备份的数据库,多个写多行&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;setting&quot;&gt;binlog-ignore-db=&lt;span class=&quot;value&quot;&gt;test&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;setting&quot;&gt;binlog-ignore-db=&lt;span class=&quot;value&quot;&gt;information_schema&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;setting&quot;&gt;binlog-ignore-db=&lt;span class=&quot;value&quot;&gt;performance_schema&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# 自增字段奇数递增,防止冲突(1, 3, 5, ...,)&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;setting&quot;&gt;auto-increment-increment = &lt;span class=&quot;value&quot;&gt;&lt;span class=&quot;number&quot;&gt;10&lt;/span&gt; # 每次递增的步长&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;setting&quot;&gt;auto-increment-offset = &lt;span class=&quot;value&quot;&gt;&lt;span class=&quot;number&quot;&gt;2&lt;/span&gt; # 初始值&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;### as slave ###&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# 之前配置过,这里保持不变&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;#######################################################################&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;重启 mysql: &lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;serivce mysqld restart&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;在主 B 服务器(master)下创建给从A服务器 (slave)登录用的用户名密码&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;mysql&amp;gt; GRANT REPLICATION SLAVE ON *.* TO &lt;span class=&quot;string&quot;&gt;&#39;syBackup&#39;&lt;/span&gt;@&lt;span class=&quot;string&quot;&gt;&#39;43.241.222.110&#39;&lt;/span&gt; IDENTIFIED BY &lt;span class=&quot;string&quot;&gt;&#39;******&#39;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;mysql&amp;gt; FLUSH TABLES WITH READ LOCK;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;mysql&amp;gt; show master status\G;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;*************************** &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;. row ***************************&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;         File: mysql-bin.&lt;span class=&quot;number&quot;&gt;000003&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;         Position: &lt;span class=&quot;number&quot;&gt;468&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;     Binlog_Do_DB: CoamDatabase,CoamInfo,CoamSNS,forum,CommonData,Wordpress,IM_Ejabberd&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; Binlog_Ignore_DB: mysql,&lt;span class=&quot;built_in&quot;&gt;test&lt;/span&gt;,information_schema,performance_schema&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;Executed_Gtid_Set:&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt; row &lt;span class=&quot;keyword&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;built_in&quot;&gt;set&lt;/span&gt; (&lt;span class=&quot;number&quot;&gt;0.01&lt;/span&gt; sec)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;mysql&amp;gt; UNLOCK TABLES;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;hr&gt;
&lt;p&gt;在从服务器 A 的服务器配置登陆主服务器 B 中创建的复制用户登陆&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;mysql&amp;gt; slave stop;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;mysql&amp;gt;  CHANGE MASTER TO MASTER_HOST=&lt;span class=&quot;string&quot;&gt;&#39;42.96.194.60&#39;&lt;/span&gt;, MASTER_USER=&lt;span class=&quot;string&quot;&gt;&#39;syBackup&#39;&lt;/span&gt;, MASTER_PASSWORD=&lt;span class=&quot;string&quot;&gt;&#39;yafei312&#39;&lt;/span&gt;, MASTER_CONNECT_RETRY=&lt;span class=&quot;number&quot;&gt;60&lt;/span&gt;, MASTER_LOG_FILE=&lt;span class=&quot;string&quot;&gt;&#39;mysql-bin.000004, MASTER_LOG_POS=46702&#39;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;mysql&amp;gt; slave start;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;修改从服务器A的 Mysql 配置文件 &lt;em&gt;/etc/mysql/my.cnf&lt;/em&gt; 从配置信息&lt;/p&gt;
&lt;p&gt;打开从服务器 A 的 Mysql 配置文件 &lt;em&gt;/etc/mysql/my.cnf&lt;/em&gt; 并添加以下配置项&lt;/p&gt;
&lt;figure class=&quot;highlight&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;19&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;### as master ###&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;### as slave ###&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;replicate-do-db=CoamDatabase #只复制某个库,多个写多行&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;replicate-do-db=CoamInfo&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;replicate-do-db=CoamSNS&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;replicate-do-db=form&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;replicate-do-db=CommonData&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;replicate-do-db=Wordpress&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;replicate-do-db=IM_Ejabberd&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;replicate-ignore-db=mysql #不复制某个库&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;replicate-ignore-db=test&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;replicate-ignore-db=information_schema&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;replicate-ignore-db=performance_schema&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;relay-log=mysqld-relay-bin # 开启日志中继&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;log-slave-updates # slave将复制事件写进自己的二进制日志&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;######################################################################&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;重启主服务器A、B并测试插入测试更新数据&lt;/p&gt;
&lt;p&gt;从 A 服务器 43.241.222.110&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;mysql&amp;gt; show slave status\G;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;hr&gt;
&lt;p&gt;最后的 A 服务器 配置文件 &lt;em&gt;/etc/mysql/my.cnf&lt;/em&gt;&lt;/p&gt;
&lt;figure class=&quot;highlight&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;28&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;29&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;30&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;31&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;32&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;33&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;34&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;35&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;36&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;37&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;38&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;39&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;40&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;41&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;42&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;43&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;44&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;45&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;46&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;47&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;#######################################################&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;server-id=1 #主机id,整数&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;#开启二进制日志,并且名称为 /var/lib/mysql/mysql-bin.***&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;# 如果是个路径则,保存到该路径下(log-bin=/var/log/mysql-bin.log -&amp;gt; /var/log/mysql-bin.***)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;log-bin=mysql-bin&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;### as master ###&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;read-only=0 #主机读写权限,读写都可以&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;binlog-do-db=CoamDatabase #记录日志的数据库:需要的备份数据,多个写多行&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;binlog-do-db=CoamInfo&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;binlog-do-db=CoamSNS&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;binlog-do-db=form&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;binlog-do-db=CommonData&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;binlog-do-db=Wordpress&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;binlog-do-db=IM_Ejabberd&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;binlog-ignore-db=mysql #不记录日志的数据库:不需要备份的数据库,多个写多行&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;binlog-ignore-db=test&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;binlog-ignore-db=information_schema&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;binlog-ignore-db=performance_schema&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;# 自增字段奇数递增,防止冲突(1, 11, 21, ...,)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;auto-increment-increment = 10 # 每次递增的步长&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;auto-increment-offset = 1 # 初始值&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;### as slave ###&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;replicate-do-db=CoamDatabase #只复制某个库,多个写多行&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;replicate-do-db=CoamInfo&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;replicate-do-db=CoamSNS&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;replicate-do-db=form&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;replicate-do-db=CommonData&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;replicate-do-db=Wordpress&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;replicate-do-db=IM_Ejabberd&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;replicate-ignore-db=mysql #不复制某个库&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;replicate-ignore-db=test&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;replicate-ignore-db=information_schema&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;replicate-ignore-db=performance_schema&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;relay-log=mysqld-relay-bin # 开启日志中继&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;log-slave-updates # slave将复制事件写进自己的二进制日志&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;#5.5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;#log-slave-updates = ON&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;#5.1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;#log-slave-updates = 1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;#######################################################&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;最后的 B 服务器配置文件 &lt;em&gt;/etc/mysql/my.cnf&lt;/em&gt;&lt;/p&gt;
&lt;figure class=&quot;highlight&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;28&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;29&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;30&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;31&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;32&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;33&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;34&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;35&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;36&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;37&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;38&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;39&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;40&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;41&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;42&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;43&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;44&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;###############################################################&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;server-id=2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;log-bin=mysql-bin&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;### as master ###&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;read-only=0 #主机读写权限,读写都可以&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;binlog-do-db=CoamDatabase #记录日志的数据库:需要的备份数据,多个写多行&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;binlog-do-db=CoamInfo&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;binlog-do-db=CoamSNS&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;binlog-do-db=form&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;binlog-do-db=CommonData&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;binlog-do-db=Wordpress&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;binlog-do-db=IM_Ejabberd&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;binlog-ignore-db=mysql #不记录日志的数据库:不需要备份的数据库,多个写多行&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;binlog-ignore-db=test&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;binlog-ignore-db=information_schema&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;binlog-ignore-db=performance_schema&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;# 自增字段奇数递增,防止冲突(2, 12, 22, ...,)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;auto-increment-increment = 10 # 每次递增的步长&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;auto-increment-offset = 2 # 初始值&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;### as slave ###&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;replicate-do-db=CoamDatabase #只复制某个库,多个写多行&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;replicate-do-db=CoamInfo&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;replicate-do-db=CoamSNS&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;replicate-do-db=form&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;replicate-do-db=CommonData&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;replicate-do-db=Wordpress&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;replicate-do-db=IM_Ejabberd&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;replicate-ignore-db=mysql #不复制某个库&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;replicate-ignore-db=test&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;replicate-ignore-db=information_schema&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;replicate-ignore-db=performance_schema&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;relay-log=mysqld-relay-bin # 开启日志中继&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;log-slave-updates # slave将复制事件写进自己的二进制日志&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;#5.5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;#log-slave-updates = ON&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;#5.1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;#log-slave-updates = 1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;###############################################################&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;hr&gt;
&lt;h3 id=&quot;其它&quot;&gt;&lt;a href=&quot;#其它&quot; class=&quot;headerlink&quot; title=&quot;其它&quot;&gt;&lt;/a&gt;其它&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;安装MySQL.首先要在两台服务器上安装MySQL,完成之后应该确认能否两台服务器能否互相访问. 这是因为缺省的 my.cnf 设置有 bind-address = 127.0.0.1,这条语句应该被注释掉.&lt;/li&gt;
&lt;li&gt;创建账号.数据库中缺省的帐户的host值是localhost,所以应该创建一个可以远端访问的帐号.比如:&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;root@’%’ or root@10.x.x.x&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id=&quot;Mysql双机热备份日常维护及问题分析&quot;&gt;&lt;a href=&quot;#Mysql双机热备份日常维护及问题分析&quot; class=&quot;headerlink&quot; title=&quot;Mysql双机热备份日常维护及问题分析&quot;&gt;&lt;/a&gt;Mysql双机热备份日常维护及问题分析&lt;/h3&gt;&lt;a id=&quot;more&quot;&gt;&lt;/a&gt;
&lt;p&gt;好不容易搭建了Mysql服务器双机热备份后,在 phpMyAdmin 管理后台更新数据,出现如下错误:&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;mysql Unsafe statement written to the binary &lt;span class=&quot;built_in&quot;&gt;log&lt;/span&gt; using statement format since BINLOG_FORMAT = STATEMENT. Statement is unsafe because it uses a UDF &lt;span class=&quot;built_in&quot;&gt;which&lt;/span&gt; may not &lt;span class=&quot;built_in&quot;&gt;return&lt;/span&gt; the same value on the slave.&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;因为我使用mysql2redis和udf搭建了Mysql自动同步到Redis数据库缓存,双机热备份后,在本地服务器可以及时更新当前主机的Redis数据,但是从服务器不能自动触发udf更新操作导致出现上面的错误&lt;/p&gt;
&lt;p&gt;首先需要使用命令 show slave status\G; 检查两个数据库的的同步状态是否正确,保证没有 插入. 更新. 打开临时表 等操作,在两个服务器执行以下命令&lt;/p&gt;
&lt;p&gt;在两个服务器上停止从服务的任务:&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;stop slave;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;flush tables with &lt;span class=&quot;built_in&quot;&gt;read&lt;/span&gt; lock;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;在两个主服务器上执行锁表并修改日志记录方式:&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;flush tables with &lt;span class=&quot;built_in&quot;&gt;read&lt;/span&gt; lock;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;built_in&quot;&gt;set&lt;/span&gt; global binlog_format=&lt;span class=&quot;string&quot;&gt;&#39;MIXED&#39;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;unlock tables;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;最后在两个服务器执行以下命令启动从服务&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;unlock tables;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;start slave;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;重新修改,发现没有出现以上错误 参考 &lt;a href=&quot;http://serverfault.com/questions/316691/mysql-binlog-format-dilemma&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;MySQL binlog format dilemma?&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;Statement 【基于SQL语句的复制(statement-based replication, SBR)】&lt;/p&gt;
&lt;p&gt;Row 【基于行的复制(row-based replication, RBR)】 方式不会出现某些特定情况下的存储过程,或function,以及trigger的调用和触发无法被正确复制的问题.&lt;/p&gt;
&lt;p&gt;MIXED 【混合模式复制 (mixed-based replication, MBR)】是以上(Statement和Row)两者的综合.在Mixed模式下,MySQL会根据执行的每一条具体的sql语句来区分对待记录的日志形式,也就是在Statement和Row之间选择一种.新版本中的Statment level还是和以前一样,仅仅记录执行的语句.而新版本的MySQL中队row level模式也被做了优化,并不是所有的修改都会以row level来记录,像遇到表结构变更的时候就会以statement模式来记录,如果sql语句确实就是update或者delete等修改数据的语句,那么还是会记录所有行的变更.&lt;br&gt;参考 MYSQL复制参数 binlog_format&lt;br&gt;由于将 binlog_format 改成 MIXED 或者 ROW 不会导致出错,但是不会再从服务器执行 udf 配置的redis复制命令(测试可以触发执行在当前数据库中的表的修改操作),所以考虑将双主机的Mysql服务器的Redis修改操作统一提交到一台主Redis服务器,搭建Redis主从同步机制&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id=&quot;日常问题分析&quot;&gt;&lt;a href=&quot;#日常问题分析&quot; class=&quot;headerlink&quot; title=&quot;日常问题分析&quot;&gt;&lt;/a&gt;日常问题分析&lt;/h3&gt;&lt;p&gt;某次不小心改了B服务器的一条数据后,A服务器一直没有更新过来,反过来A服务器修改B服务器没有更新,为了保持数据一致,于是各种折腾,清空表. 删除表再重建仍是没有解决问题并导致其他数据库的表也不能顺利同步&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;在 A 服务器上查看 A的从服务同步状态,提示如下错误&lt;/li&gt;
&lt;/ul&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;28&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;29&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;30&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;31&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;32&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;33&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;34&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;35&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;36&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;37&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;38&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;39&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;40&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;41&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;42&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;43&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;44&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;45&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;46&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;47&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;48&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;49&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;50&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;51&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;52&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;53&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;54&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;55&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;56&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;57&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;58&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;59&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;60&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;mysql&amp;gt; show slave status\G;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; *************************** &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;. row ***************************&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; Slave_IO_State: Waiting &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; master to send event&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; Master_Host: &lt;span class=&quot;number&quot;&gt;42.96&lt;/span&gt;.&lt;span class=&quot;number&quot;&gt;194.60&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; Master_User: syBackup&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; Master_Port: &lt;span class=&quot;number&quot;&gt;3306&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; Connect_Retry: &lt;span class=&quot;number&quot;&gt;60&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; Master_Log_File: mysql-bin.&lt;span class=&quot;number&quot;&gt;000028&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; Read_Master_Log_Pos: &lt;span class=&quot;number&quot;&gt;31876&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; Relay_Log_File: mysqld-relay-bin.&lt;span class=&quot;number&quot;&gt;000063&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; Relay_Log_Pos: &lt;span class=&quot;number&quot;&gt;26437&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; Relay_Master_Log_File: mysql-bin.&lt;span class=&quot;number&quot;&gt;000028&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; Slave_IO_Running: Yes&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; Slave_SQL_Running: No&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; Replicate_Do_DB: CoamDatabase,CoamInfo,CoamSNS,form,CommonData,Wordpress,IM_Ejabberd&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; Replicate_Ignore_DB: mysql,&lt;span class=&quot;built_in&quot;&gt;test&lt;/span&gt;,information_schema,performance_schema,collie,ding,inotseeyou_com,pi&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; wik,trac,wzjp_net Replicate_Do_Table:&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; Replicate_Ignore_Table:&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; Replicate_Wild_Do_Table:&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; Replicate_Wild_Ignore_Table:&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; Last_Errno: &lt;span class=&quot;number&quot;&gt;1062&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; Last_Error: Error &lt;span class=&quot;string&quot;&gt;&#39;Duplicate entry &#39;&lt;/span&gt;&lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;string&quot;&gt;&#39; for key &#39;&lt;/span&gt;PRIMARY&lt;span class=&quot;string&quot;&gt;&#39;&#39;&lt;/span&gt; on query. Default database: &lt;span class=&quot;string&quot;&gt;&#39;Com&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; monData&#39;&lt;/span&gt;. Query: &lt;span class=&quot;string&quot;&gt;&#39;INSERT INTO `CommonData`.`Sarah_PictureManager` (`pictureId`, `pictureImgShow`, `pictureGroup`, `pictureTitle`, `pictureSubTitle`, `picturePostil`, `pubTime`) VALUES (NULL, &#39;&lt;/span&gt;&lt;span class=&quot;string&quot;&gt;&#39;, &#39;&lt;/span&gt;&lt;span class=&quot;string&quot;&gt;&#39;, &#39;&lt;/span&gt;尚无标注&lt;span class=&quot;string&quot;&gt;&#39;, &#39;&lt;/span&gt;尚无子标注&lt;span class=&quot;string&quot;&gt;&#39;, &#39;&lt;/span&gt;尚未批注&lt;span class=&quot;string&quot;&gt;&#39;, CURRENT_TIMESTAMP)&#39;&lt;/span&gt; Skip_Counter: &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; Exec_Master_Log_Pos: &lt;span class=&quot;number&quot;&gt;30844&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; Relay_Log_Space: &lt;span class=&quot;number&quot;&gt;27806&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; Until_Condition: None&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; Until_Log_File:&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; Until_Log_Pos: &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; Master_SSL_Allowed: No&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; Master_SSL_CA_File:&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; Master_SSL_CA_Path:&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; Master_SSL_Cert:&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; Master_SSL_Cipher:&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; Master_SSL_Key:&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; Seconds_Behind_Master: NULL&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; Master_SSL_Verify_Server_Cert: No&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; Last_IO_Errno: &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; Last_IO_Error:&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; Last_SQL_Errno: &lt;span class=&quot;number&quot;&gt;1062&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; Last_SQL_Error: Error &lt;span class=&quot;string&quot;&gt;&#39;Duplicate entry &#39;&lt;/span&gt;&lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;string&quot;&gt;&#39; for key &#39;&lt;/span&gt;PRIMARY&lt;span class=&quot;string&quot;&gt;&#39;&#39;&lt;/span&gt; on query. Default database: &lt;span class=&quot;string&quot;&gt;&#39;Com&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; monData&#39;&lt;/span&gt;. Query: &lt;span class=&quot;string&quot;&gt;&#39;INSERT INTO `CommonData`.`Sarah_PictureManager` (`pictureId`, `pictureImgShow`, `pictureGroup`, `pictureTitle`, `pictureSubTitle`, `picturePostil`, `pubTime`) VALUES (NULL, &#39;&lt;/span&gt;&lt;span class=&quot;string&quot;&gt;&#39;, &#39;&lt;/span&gt;&lt;span class=&quot;string&quot;&gt;&#39;, &#39;&lt;/span&gt;尚无标注&lt;span class=&quot;string&quot;&gt;&#39;, &#39;&lt;/span&gt;尚无子标注&lt;span class=&quot;string&quot;&gt;&#39;, &#39;&lt;/span&gt;尚未批注&lt;span class=&quot;string&quot;&gt;&#39;, CURRENT_TIMESTAMP)&#39;&lt;/span&gt; Replicate_Ignore_Server_Ids:&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; Master_Server_Id: &lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; Master_UUID: &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;c0ea40b-&lt;span class=&quot;number&quot;&gt;56&lt;/span&gt;be-&lt;span class=&quot;number&quot;&gt;11&lt;/span&gt;e5-&lt;span class=&quot;number&quot;&gt;8329&lt;/span&gt;-&lt;span class=&quot;number&quot;&gt;00163&lt;/span&gt;e043c4f&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; Master_Info_File: /data/home/data/mysql/master.info&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; SQL_Delay: &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; SQL_Remaining_Delay: NULL&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; Slave_SQL_Running_State:&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; Master_Retry_Count: &lt;span class=&quot;number&quot;&gt;86400&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; Master_Bind:&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; Last_IO_Error_Timestamp:&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; Last_SQL_Error_Timestamp: &lt;span class=&quot;number&quot;&gt;150922&lt;/span&gt; &lt;span class=&quot;number&quot;&gt;17&lt;/span&gt;:&lt;span class=&quot;number&quot;&gt;36&lt;/span&gt;:&lt;span class=&quot;number&quot;&gt;35&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; Master_SSL_Crl:&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; Master_SSL_Crlpath:&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; Retrieved_Gtid_Set:&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; Executed_Gtid_Set:&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; Auto_Position: &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt; row &lt;span class=&quot;keyword&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;built_in&quot;&gt;set&lt;/span&gt; (&lt;span class=&quot;number&quot;&gt;0.00&lt;/span&gt; sec)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;ERROR:&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; No query specified&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;ul&gt;
&lt;li&gt;在 B 的服务器同样查看B服务器的从服务器同步状态&lt;/li&gt;
&lt;/ul&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;28&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;29&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;30&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;31&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;32&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;33&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;34&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;35&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;36&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;37&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;38&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;39&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;40&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;41&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;42&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;43&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;44&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;45&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;46&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;47&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;48&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;49&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;50&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;51&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;52&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;53&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;54&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;55&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;56&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;57&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;58&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;59&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;60&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;61&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;62&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;mysql&amp;gt; show slave status\G;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; *************************** &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;. row ***************************&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; Slave_IO_State: Waiting &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; master to send event&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; Master_Host: &lt;span class=&quot;number&quot;&gt;43.241&lt;/span&gt;.&lt;span class=&quot;number&quot;&gt;222.110&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; Master_User: syBackup&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; Master_Port: &lt;span class=&quot;number&quot;&gt;3306&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; Connect_Retry: &lt;span class=&quot;number&quot;&gt;60&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; Master_Log_File: mysql-bin.&lt;span class=&quot;number&quot;&gt;000022&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; Read_Master_Log_Pos: &lt;span class=&quot;number&quot;&gt;52902&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; Relay_Log_File: mysqld-relay-bin.&lt;span class=&quot;number&quot;&gt;000065&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; Relay_Log_Pos: &lt;span class=&quot;number&quot;&gt;283&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; Relay_Master_Log_File: mysql-bin.&lt;span class=&quot;number&quot;&gt;000017&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; Slave_IO_Running: Yes&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; Slave_SQL_Running: No&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; Replicate_Do_DB: CoamDatabase,CoamInfo,CoamSNS,form,CommonData,Wordpress,IM_Ejabberd&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; Replicate_Ignore_DB: mysql,&lt;span class=&quot;built_in&quot;&gt;test&lt;/span&gt;,information_schema,performance_schema,collie,ding,inotseeyou_com,pi&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; wik,trac,wzjp_net Replicate_Do_Table:&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; Replicate_Ignore_Table:&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; Replicate_Wild_Do_Table:&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; Replicate_Wild_Ignore_Table:&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; Last_Errno: &lt;span class=&quot;number&quot;&gt;1050&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; Last_Error: Error &lt;span class=&quot;string&quot;&gt;&#39;Table &#39;&lt;/span&gt;Sarah_PictureManager&lt;span class=&quot;string&quot;&gt;&#39; already exists&#39;&lt;/span&gt; on query. Default database&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; : &lt;span class=&quot;string&quot;&gt;&#39;CommonData&#39;&lt;/span&gt;. Query: &lt;span class=&quot;string&quot;&gt;&#39;RENAME TABLE `CommonData`.`Sarah_PictureManager` TO `test`.`Sarah_PictureManager`&#39;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; Skip_Counter: &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; Exec_Master_Log_Pos: &lt;span class=&quot;number&quot;&gt;120&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; Relay_Log_Space: &lt;span class=&quot;number&quot;&gt;12643&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; Until_Condition: None&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; Until_Log_File:&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; Until_Log_Pos: &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; Master_SSL_Allowed: No&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; Master_SSL_CA_File:&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; Master_SSL_CA_Path:&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; Master_SSL_Cert:&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; Master_SSL_Cipher:&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; Master_SSL_Key:&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; Seconds_Behind_Master: NULL&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; Master_SSL_Verify_Server_Cert: No&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; Last_IO_Errno: &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; Last_IO_Error:&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; Last_SQL_Errno: &lt;span class=&quot;number&quot;&gt;1050&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; Last_SQL_Error: Error &lt;span class=&quot;string&quot;&gt;&#39;Table &#39;&lt;/span&gt;Sarah_PictureManager&lt;span class=&quot;string&quot;&gt;&#39; already exists&#39;&lt;/span&gt; on query. Default database&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; : &lt;span class=&quot;string&quot;&gt;&#39;CommonData&#39;&lt;/span&gt;. Query: &lt;span class=&quot;string&quot;&gt;&#39;RENAME TABLE `CommonData`.`Sarah_PictureManager` TO `test`.`Sarah_PictureManager`&#39;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; Replicate_Ignore_Server_Ids:&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; Master_Server_Id: &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; Master_UUID: &lt;span class=&quot;number&quot;&gt;811367&lt;/span&gt;ec-&lt;span class=&quot;number&quot;&gt;52&lt;/span&gt;b9-&lt;span class=&quot;number&quot;&gt;11&lt;/span&gt;e5&lt;span class=&quot;operator&quot;&gt;-a&lt;/span&gt;8f5-&lt;span class=&quot;number&quot;&gt;0022&lt;/span&gt;f75&lt;span class=&quot;built_in&quot;&gt;fc&lt;/span&gt;65a&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; Master_Info_File: /data/home/data/mysql/master.info&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; SQL_Delay: &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; SQL_Remaining_Delay: NULL&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; Slave_SQL_Running_State:&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; Master_Retry_Count: &lt;span class=&quot;number&quot;&gt;86400&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; Master_Bind:&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; Last_IO_Error_Timestamp:&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; Last_SQL_Error_Timestamp: &lt;span class=&quot;number&quot;&gt;150922&lt;/span&gt; &lt;span class=&quot;number&quot;&gt;17&lt;/span&gt;:&lt;span class=&quot;number&quot;&gt;40&lt;/span&gt;:&lt;span class=&quot;number&quot;&gt;05&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; Master_SSL_Crl:&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; Master_SSL_Crlpath:&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; Retrieved_Gtid_Set:&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; Executed_Gtid_Set:&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; Auto_Position: &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt; row &lt;span class=&quot;keyword&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;built_in&quot;&gt;set&lt;/span&gt; (&lt;span class=&quot;number&quot;&gt;0.00&lt;/span&gt; sec)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;ERROR:&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; No query specified&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;均有如下相同的错误状态&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;Slave_IO_Running: Yes&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;Slave_SQL_Running: No &lt;span class=&quot;comment&quot;&gt;# 正常的为Yes&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;于是猜想是双服务器的数据库不能同步,并且有很多修改,不知从哪里开始恢复,网上建议&lt;/p&gt;
&lt;p&gt;有时候由于BUG或者在从服务器执行了写操作可能会造成键重复错误,错误信息如下:&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;Error ‘Duplicate entry ...’ &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; key ... on query&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;此时最好手动确认并删除从服务器上的无效数据,然后从主服务器复制正确数据,如果错误仍然不能解决,可以在从服务器使用 &lt;em&gt;SET GLOBAL sql_slave_skip_counter&lt;/em&gt; ,如下:&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;28&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;29&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;30&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;31&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;32&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;33&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;34&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;35&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;36&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;37&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;38&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;39&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;40&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;41&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;42&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;43&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;44&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;45&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;46&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;47&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;48&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;49&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;50&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;51&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;52&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;53&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;54&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;55&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;56&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;57&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;58&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;59&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;60&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;61&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;62&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;mysql&amp;gt; SET GLOBAL sql_slave_skip_counter = &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;;  &lt;span class=&quot;comment&quot;&gt;# 客户端运行,用来跳过几个事件,只有当同步进程出现错误而停止的时候才可以执行.&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;mysql&amp;gt; START SLAVE; &lt;span class=&quot;comment&quot;&gt;# 记得一定要执行,不然后续查看 从服务器的状态不会及时更新过来&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;mysql&amp;gt; show slave status\G;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;*************************** &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;. row ***************************&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; Slave_IO_State: Waiting &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; master to send event&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; Master_Host: &lt;span class=&quot;number&quot;&gt;43.241&lt;/span&gt;.&lt;span class=&quot;number&quot;&gt;222.110&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; Master_User: syBackup&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; Master_Port: &lt;span class=&quot;number&quot;&gt;3306&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; Connect_Retry: &lt;span class=&quot;number&quot;&gt;60&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; Master_Log_File: mysql-bin.&lt;span class=&quot;number&quot;&gt;000022&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; Read_Master_Log_Pos: &lt;span class=&quot;number&quot;&gt;52902&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; Relay_Log_File: mysqld-relay-bin.&lt;span class=&quot;number&quot;&gt;000083&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; Relay_Log_Pos: &lt;span class=&quot;number&quot;&gt;2158&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; Relay_Master_Log_File: mysql-bin.&lt;span class=&quot;number&quot;&gt;000022&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; Slave_IO_Running: Yes&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; Slave_SQL_Running: Yes&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; Replicate_Do_DB: CoamDatabase,CoamInfo,CoamSNS,form,CommonData,Wordpress,IM_Ejabberd&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; Replicate_Ignore_DB: mysql,&lt;span class=&quot;built_in&quot;&gt;test&lt;/span&gt;,information_schema,performance_schema,collie,ding,inotseeyou_com,pi&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;wik,trac,wzjp_net Replicate_Do_Table: &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; Replicate_Ignore_Table: &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; Replicate_Wild_Do_Table: &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; Replicate_Wild_Ignore_Table: &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; Last_Errno: &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; Last_Error: &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; Skip_Counter: &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; Exec_Master_Log_Pos: &lt;span class=&quot;number&quot;&gt;52902&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; Relay_Log_Space: &lt;span class=&quot;number&quot;&gt;2495&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; Until_Condition: None&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; Until_Log_File: &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; Until_Log_Pos: &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; Master_SSL_Allowed: No&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; Master_SSL_CA_File: &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; Master_SSL_CA_Path: &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; Master_SSL_Cert: &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; Master_SSL_Cipher: &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; Master_SSL_Key: &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; Seconds_Behind_Master: &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;Master_SSL_Verify_Server_Cert: No&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; Last_IO_Errno: &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; Last_IO_Error: &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; Last_SQL_Errno: &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; Last_SQL_Error: &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; Replicate_Ignore_Server_Ids: &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; Master_Server_Id: &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; Master_UUID: &lt;span class=&quot;number&quot;&gt;811367&lt;/span&gt;ec-&lt;span class=&quot;number&quot;&gt;52&lt;/span&gt;b9-&lt;span class=&quot;number&quot;&gt;11&lt;/span&gt;e5&lt;span class=&quot;operator&quot;&gt;-a&lt;/span&gt;8f5-&lt;span class=&quot;number&quot;&gt;0022&lt;/span&gt;f75&lt;span class=&quot;built_in&quot;&gt;fc&lt;/span&gt;65a&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; Master_Info_File: /data/home/data/mysql/master.info&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; SQL_Delay: &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; SQL_Remaining_Delay: NULL&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; Slave_SQL_Running_State: Slave has &lt;span class=&quot;built_in&quot;&gt;read&lt;/span&gt; all relay &lt;span class=&quot;built_in&quot;&gt;log&lt;/span&gt;; waiting &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; the slave I/O thread to update it&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; Master_Retry_Count: &lt;span class=&quot;number&quot;&gt;86400&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; Master_Bind: &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; Last_IO_Error_Timestamp: &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; Last_SQL_Error_Timestamp: &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; Master_SSL_Crl: &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; Master_SSL_Crlpath: &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; Retrieved_Gtid_Set: &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; Executed_Gtid_Set: &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; Auto_Position: &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt; row &lt;span class=&quot;keyword&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;built_in&quot;&gt;set&lt;/span&gt; (&lt;span class=&quot;number&quot;&gt;0.00&lt;/span&gt; sec)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;ERROR: &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;No query specified&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;注:如果有多个错误,可能需要依次循环执行多次(提醒:主从服务器数据可能因此不一致,遇到这样的情况可以使用 pt-table-checksum 和 pt-table-sync 检查并修复从服务器数据).&lt;/p&gt;
&lt;p&gt;发现没有错误则停止继续执行  SET GLOBAL sql_slave_skip_counter = 1;  否则执行过多会导致新插入的数据不会更新(未验证)&lt;/p&gt;
&lt;hr&gt;
&lt;ul&gt;
&lt;li&gt;问题:主从复制不止何故停止了,我该怎么办?&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;答案:复制错误多半是因为日志错误引起的,所以首先要搞清楚是主日志错误还是中继日志错误,从错误信息里一般就能判断,如果不能可以使用类似下面的mysqlbinlog命令:&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;shell&amp;gt; mysqlbinlog &amp;lt;MASTER_BINLOG_FILE&amp;gt; &amp;gt; /dev/null&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;shell&amp;gt; mysqlbinlog &amp;lt;RELAY_BINLOG_FILE&amp;gt; &amp;gt; /dev/null&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;如果没有错误,则不会有任何输出,反之如果有错误,则会显示出来.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;同步执行SQL错误,同步自动终止问题&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;在一台服务器更新了一个字段值,但是在从服务器没有更新过来,于是在从服务器查看状态&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;28&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;29&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;30&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;31&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;32&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;33&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;34&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;35&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;36&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;37&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;38&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;39&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;40&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;41&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;42&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;43&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;44&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;45&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;46&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;47&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;48&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;49&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;50&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;51&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;52&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;53&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;54&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;55&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;56&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;57&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;58&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;59&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;60&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;61&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;62&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;63&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;mysql&amp;gt; show slave status\G;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;*************************** &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;. row ***************************&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;               Slave_IO_State: Waiting &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; master to send event&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                  Master_Host: &lt;span class=&quot;number&quot;&gt;42.96&lt;/span&gt;.&lt;span class=&quot;number&quot;&gt;194.60&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                  Master_User: syBackup&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                  Master_Port: &lt;span class=&quot;number&quot;&gt;3306&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                Connect_Retry: &lt;span class=&quot;number&quot;&gt;60&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;              Master_Log_File: mysql-bin.&lt;span class=&quot;number&quot;&gt;000007&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;          Read_Master_Log_Pos: &lt;span class=&quot;number&quot;&gt;176357&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;               Relay_Log_File: mysqld-relay-bin.&lt;span class=&quot;number&quot;&gt;000005&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                Relay_Log_Pos: &lt;span class=&quot;number&quot;&gt;4776&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        Relay_Master_Log_File: mysql-bin.&lt;span class=&quot;number&quot;&gt;000007&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;             Slave_IO_Running: Yes&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            Slave_SQL_Running: No&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;              Replicate_Do_DB: CoamDatabase,CoamInfo,CoamSNS,form,CommonData,Wordpress,IM_Ejabberd&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;          Replicate_Ignore_DB: mysql,&lt;span class=&quot;built_in&quot;&gt;test&lt;/span&gt;,information_schema,performance_schema&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;           Replicate_Do_Table:&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;       Replicate_Ignore_Table:&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      Replicate_Wild_Do_Table:&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  Replicate_Wild_Ignore_Table:&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                   Last_Errno: &lt;span class=&quot;number&quot;&gt;1062&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                   Last_Error: Could not execute Write_rows event on table Wordpress.wp_options; , Error_code: &lt;span class=&quot;number&quot;&gt;1062&lt;/span&gt;; handler error HA_ERR_FOUND_DUPP_KEY; the event&lt;span class=&quot;string&quot;&gt;&#39;s master log mysql-bin.000007, end_log_pos 4884&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                 Skip_Counter: 0&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;          Exec_Master_Log_Pos: 4563&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;              Relay_Log_Space: 174245&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;              Until_Condition: None&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;               Until_Log_File:&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                Until_Log_Pos: 0&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;           Master_SSL_Allowed: No&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;           Master_SSL_CA_File:&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;           Master_SSL_CA_Path:&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;              Master_SSL_Cert:&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            Master_SSL_Cipher:&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;               Master_SSL_Key:&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        Seconds_Behind_Master: NULL&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;Master_SSL_Verify_Server_Cert: No&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                Last_IO_Errno: 0&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                Last_IO_Error:&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;               Last_SQL_Errno: 1062&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;               Last_SQL_Error: Could not execute Write_rows event on table Wordpress.wp_options; , Error_code: 1062; handler error HA_ERR_FOUND_DUPP_KEY; the event&#39;&lt;/span&gt;s master &lt;span class=&quot;built_in&quot;&gt;log&lt;/span&gt; mysql-bin.&lt;span class=&quot;number&quot;&gt;000007&lt;/span&gt;, end_&lt;span class=&quot;built_in&quot;&gt;log&lt;/span&gt;_pos &lt;span class=&quot;number&quot;&gt;4884&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  Replicate_Ignore_Server_Ids:&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;             Master_Server_Id: &lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                  Master_UUID: &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;e14bbca-&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;b46-&lt;span class=&quot;number&quot;&gt;11&lt;/span&gt;e6&lt;span class=&quot;operator&quot;&gt;-a&lt;/span&gt;21a-&lt;span class=&quot;number&quot;&gt;00163&lt;/span&gt;e043c4f&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;             Master_Info_File: /data/home/data/mysql/master.info&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                    SQL_Delay: &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;          SQL_Remaining_Delay: NULL&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      Slave_SQL_Running_State:&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;           Master_Retry_Count: &lt;span class=&quot;number&quot;&gt;86400&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                  Master_Bind:&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      Last_IO_Error_Timestamp:&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;     Last_SQL_Error_Timestamp: &lt;span class=&quot;number&quot;&gt;160518&lt;/span&gt; &lt;span class=&quot;number&quot;&gt;23&lt;/span&gt;:&lt;span class=&quot;number&quot;&gt;30&lt;/span&gt;:&lt;span class=&quot;number&quot;&gt;42&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;               Master_SSL_Crl:&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;           Master_SSL_Crlpath:&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;           Retrieved_Gtid_Set:&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            Executed_Gtid_Set:&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                Auto_Position: &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;         Replicate_Rewrite_DB:&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                 Channel_Name:&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;           Master_TLS_Version:&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt; row &lt;span class=&quot;keyword&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;built_in&quot;&gt;set&lt;/span&gt; (&lt;span class=&quot;number&quot;&gt;0.01&lt;/span&gt; sec)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;ERROR:&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;No query specified&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;发现 &lt;em&gt;Slave_SQL_Running: No&lt;/em&gt; 问题 并且有一条SQL执行错误 &lt;em&gt;Last_SQL_Error: Could not execute Write_rows event on table Wordpress.wp_options; , Error_code: 1062; handler error HA_ERR_FOUND_DUPP_KEY; the event’s master log mysql-bin.000007, end_log_pos 4884&lt;/em&gt; &lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;执行如下语句跳过一个 SQL 语句执行错误,问题解决,如果有多个错误,以下可以多执行几次&lt;/li&gt;
&lt;/ol&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;STOP SLAVE; SET GLOBAL SQL_SLAVE_SKIP_COUNTER=&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;; START SLAVE;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;ol&gt;
&lt;li&gt;如果在配置文件设定自动跳过 SQL 语句执行错误自动终止功能,可以配置 &lt;em&gt;/etc/mysql/my.cnf&lt;/em&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;slave-skip-errors = &lt;span class=&quot;number&quot;&gt;1062&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;以上配置全局忽略1062错误 &lt;a href=&quot;http://www.ducea.com/2008/02/13/mysql-skip-duplicate-replication-errors/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;MySQL Skip Duplicate Replication Errors&lt;/a&gt;&lt;br&gt;&lt;a href=&quot;http://blog.arganzheng.me/posts/mysql-replication-errors-fixed.html&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;记一次MySQL主从同步错误处理&lt;/a&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;如果是主日志错误,需要手动找到正确的日志信息,重新 CHANGE MASTER TO 即可:&lt;/li&gt;
&lt;/ul&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;mysql&amp;gt; CHANGE MASTER TO&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;       MASTER_LOG_FILE=&lt;span class=&quot;string&quot;&gt;&#39;&amp;lt;GOOD_LOG_FILE&amp;gt;&#39;&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;       MASTER_LOG_POS=&amp;lt;GOOD_LOG_POS&amp;gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;mysql&amp;gt; START SLAVE;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;ul&gt;
&lt;li&gt;如果是中继日志错误,只要在从服务器使用SHOW SLAVE STATUS结果中的日志信息重新CHANGE MASTER TO即可,系统会抛弃当前的中继日志,重新下载:&lt;/li&gt;
&lt;/ul&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;mysql&amp;gt; CHANGE MASTER TO&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;       MASTER_LOG_FILE=&lt;span class=&quot;string&quot;&gt;&#39;&amp;lt;Relay_Master_Log_File&amp;gt;&#39;&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;       MASTER_LOG_POS=&amp;lt;Exec_Master_Log_Pos&amp;gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;       &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;mysql&amp;gt; CHANGE MASTER TO MASTER_LOG_FILE=&lt;span class=&quot;string&quot;&gt;&#39;&amp;lt;Relay_Master_Log_File&amp;gt;&#39;&lt;/span&gt;, MASTER_LOG_POS=&amp;lt;Exec_Master_Log_Pos&amp;gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;mysql&amp;gt; START SLAVE;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;至于为什么使用的是 Relay_Master_Log_File &amp;amp; Exec_Master_Log_Pos,参见概述.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;MySQL主从失败, 错误 &lt;em&gt;Got fatal error 1236&lt;/em&gt; 解决方法&lt;/li&gt;
&lt;/ul&gt;
&lt;ol&gt;
&lt;li&gt;在从服务器&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;查看当前服务器作为从服务器同步状态&lt;/li&gt;
&lt;/ul&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;28&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;29&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;30&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;31&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;32&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;33&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;34&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;35&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;36&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;37&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;38&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;39&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;40&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;41&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;42&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;43&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;44&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;45&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;46&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;47&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;48&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;49&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;50&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;51&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;52&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;53&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;54&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;55&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;56&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;57&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;58&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;59&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;60&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;61&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;62&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;63&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;64&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;yzhang@coam:~$ mysql -u zhangyanxi -p&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;mysql&amp;gt; show slave status\G;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;*************************** &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;. row ***************************&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;               Slave_IO_State:&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                  Master_Host: &lt;span class=&quot;number&quot;&gt;42.96&lt;/span&gt;.&lt;span class=&quot;number&quot;&gt;194.60&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                  Master_User: syBackup&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                  Master_Port: &lt;span class=&quot;number&quot;&gt;3306&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                Connect_Retry: &lt;span class=&quot;number&quot;&gt;60&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;              Master_Log_File: mysql-bin.&lt;span class=&quot;number&quot;&gt;000005&lt;/span&gt;, MASTER_LOG_POS=&lt;span class=&quot;number&quot;&gt;154&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;          Read_Master_Log_Pos: &lt;span class=&quot;number&quot;&gt;4&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;               Relay_Log_File: mysqld-relay-bin.&lt;span class=&quot;number&quot;&gt;000001&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                Relay_Log_Pos: &lt;span class=&quot;number&quot;&gt;4&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        Relay_Master_Log_File: mysql-bin.&lt;span class=&quot;number&quot;&gt;000005&lt;/span&gt;, MASTER_LOG_POS=&lt;span class=&quot;number&quot;&gt;154&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;             Slave_IO_Running: No&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            Slave_SQL_Running: Yes&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;              Replicate_Do_DB: CoamDatabase,CoamInfo,CoamSNS,form,CommonData,Wordpress,IM_Ejabberd&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;          Replicate_Ignore_DB: mysql,&lt;span class=&quot;built_in&quot;&gt;test&lt;/span&gt;,information_schema,performance_schema&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;           Replicate_Do_Table:&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;       Replicate_Ignore_Table:&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      Replicate_Wild_Do_Table:&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  Replicate_Wild_Ignore_Table:&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                   Last_Errno: &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                   Last_Error:&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                 Skip_Counter: &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;          Exec_Master_Log_Pos: &lt;span class=&quot;number&quot;&gt;4&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;              Relay_Log_Space: &lt;span class=&quot;number&quot;&gt;154&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;              Until_Condition: None&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;               Until_Log_File:&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                Until_Log_Pos: &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;           Master_SSL_Allowed: No&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;           Master_SSL_CA_File:&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;           Master_SSL_CA_Path:&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;              Master_SSL_Cert:&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            Master_SSL_Cipher:&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;               Master_SSL_Key:&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        Seconds_Behind_Master: NULL&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;Master_SSL_Verify_Server_Cert: No&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                Last_IO_Errno: &lt;span class=&quot;number&quot;&gt;1236&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                Last_IO_Error:&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;               Last_SQL_Errno: &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;               Last_SQL_Error:&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  Replicate_Ignore_Server_Ids:&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;             Master_Server_Id: &lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                  Master_UUID: &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;e14bbca-&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;b46-&lt;span class=&quot;number&quot;&gt;11&lt;/span&gt;e6&lt;span class=&quot;operator&quot;&gt;-a&lt;/span&gt;21a-&lt;span class=&quot;number&quot;&gt;00163&lt;/span&gt;e043c4f&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;             Master_Info_File: /data/home/data/mysql/master.info&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                    SQL_Delay: &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;          SQL_Remaining_Delay: NULL&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      Slave_SQL_Running_State: Slave has &lt;span class=&quot;built_in&quot;&gt;read&lt;/span&gt; all relay &lt;span class=&quot;built_in&quot;&gt;log&lt;/span&gt;; waiting &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; more updates&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;           Master_Retry_Count: &lt;span class=&quot;number&quot;&gt;86400&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                  Master_Bind:&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      Last_IO_Error_Timestamp: &lt;span class=&quot;number&quot;&gt;160518&lt;/span&gt; &lt;span class=&quot;number&quot;&gt;11&lt;/span&gt;:&lt;span class=&quot;number&quot;&gt;29&lt;/span&gt;:&lt;span class=&quot;number&quot;&gt;06&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;     Last_SQL_Error_Timestamp:&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;               Master_SSL_Crl:&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;           Master_SSL_Crlpath:&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;           Retrieved_Gtid_Set:&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            Executed_Gtid_Set:&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                Auto_Position: &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;         Replicate_Rewrite_DB:&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                 Channel_Name:&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;           Master_TLS_Version:&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt; row &lt;span class=&quot;keyword&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;built_in&quot;&gt;set&lt;/span&gt; (&lt;span class=&quot;number&quot;&gt;0.00&lt;/span&gt; sec)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;ERROR:&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;No query specified&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;可以看到 &lt;em&gt;Slave_IO_State&lt;/em&gt; 和 &lt;em&gt;Slave_IO_Running&lt;/em&gt; 都不正常,而 &lt;em&gt;Read_Master_Log_Pos&lt;/em&gt; 为 4&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;查看从服务器错误日志文件&lt;/li&gt;
&lt;/ul&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;yzhang@coam:~$ sudo vi /data/home/data/mysql/coam.err&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;number&quot;&gt;2016&lt;/span&gt;-&lt;span class=&quot;number&quot;&gt;05&lt;/span&gt;-&lt;span class=&quot;number&quot;&gt;18&lt;/span&gt;T03:&lt;span class=&quot;number&quot;&gt;29&lt;/span&gt;:&lt;span class=&quot;number&quot;&gt;06.947349&lt;/span&gt;Z &lt;span class=&quot;number&quot;&gt;30&lt;/span&gt; [ERROR] Error reading packet from server &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; channel &lt;span class=&quot;string&quot;&gt;&#39;&#39;&lt;/span&gt;: Could not find first &lt;span class=&quot;built_in&quot;&gt;log&lt;/span&gt; file name &lt;span class=&quot;keyword&quot;&gt;in&lt;/span&gt; binary &lt;span class=&quot;built_in&quot;&gt;log&lt;/span&gt; index file (server_errno=&lt;span class=&quot;number&quot;&gt;1236&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;number&quot;&gt;2016&lt;/span&gt;-&lt;span class=&quot;number&quot;&gt;05&lt;/span&gt;-&lt;span class=&quot;number&quot;&gt;18&lt;/span&gt;T03:&lt;span class=&quot;number&quot;&gt;29&lt;/span&gt;:&lt;span class=&quot;number&quot;&gt;06.947405&lt;/span&gt;Z &lt;span class=&quot;number&quot;&gt;30&lt;/span&gt; [ERROR] Slave I/O &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; channel &lt;span class=&quot;string&quot;&gt;&#39;&#39;&lt;/span&gt;: , Error_code: &lt;span class=&quot;number&quot;&gt;1236&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;number&quot;&gt;2016&lt;/span&gt;-&lt;span class=&quot;number&quot;&gt;05&lt;/span&gt;-&lt;span class=&quot;number&quot;&gt;18&lt;/span&gt;T03:&lt;span class=&quot;number&quot;&gt;29&lt;/span&gt;:&lt;span class=&quot;number&quot;&gt;06.947417&lt;/span&gt;Z &lt;span class=&quot;number&quot;&gt;30&lt;/span&gt; [Note] Slave I/O thread exiting &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; channel &lt;span class=&quot;string&quot;&gt;&#39;&#39;&lt;/span&gt;, &lt;span class=&quot;built_in&quot;&gt;read&lt;/span&gt; up to &lt;span class=&quot;built_in&quot;&gt;log&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&#39;mysql-bin.000005, MASTER_LOG_POS=154&#39;&lt;/span&gt;, position &lt;span class=&quot;number&quot;&gt;4&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;ul&gt;
&lt;li&gt;在主服务器查看主服务器同步状态&lt;/li&gt;
&lt;/ul&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;mysql&amp;gt; show master status\G;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;*************************** &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;. row ***************************&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;         File: mysql-bin.&lt;span class=&quot;number&quot;&gt;000005&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;         Position: &lt;span class=&quot;number&quot;&gt;468&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;     Binlog_Do_DB: CoamDatabase,CoamInfo,CoamSNS,forum,CommonData,Wordpress,IM_Ejabberd&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; Binlog_Ignore_DB: mysql,&lt;span class=&quot;built_in&quot;&gt;test&lt;/span&gt;,information_schema,performance_schema&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;Executed_Gtid_Set:&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt; row &lt;span class=&quot;keyword&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;built_in&quot;&gt;set&lt;/span&gt; (&lt;span class=&quot;number&quot;&gt;0.01&lt;/span&gt; sec)&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;ul&gt;
&lt;li&gt;回到从服务器设置同步位置-记住,不要在这个时候重启主服务器,否则 &lt;em&gt;File: mysql-bin.000005&lt;/em&gt; 会改变&lt;/li&gt;
&lt;/ul&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;28&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;29&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;30&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;31&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;32&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;33&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;34&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;35&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;36&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;37&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;38&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;39&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;40&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;41&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;42&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;43&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;44&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;45&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;46&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;47&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;48&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;49&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;50&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;51&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;52&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;53&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;54&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;55&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;56&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;57&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;58&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;59&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;60&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;61&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;62&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;63&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;64&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;65&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;mysql&amp;gt; stop slave;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;mysql&amp;gt; CHANGE MASTER TO MASTER_LOG_FILE=&lt;span class=&quot;string&quot;&gt;&#39;mysql-bin.000005&#39;&lt;/span&gt;, MASTER_LOG_POS=&lt;span class=&quot;number&quot;&gt;468&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;mysql&amp;gt; start slave;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;mysql&amp;gt; show slave status\G;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; *************************** &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;. row ***************************&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; Slave_IO_State: Waiting &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; master to send event&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; Master_Host: &lt;span class=&quot;number&quot;&gt;42.96&lt;/span&gt;.&lt;span class=&quot;number&quot;&gt;194.60&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; Master_User: syBackup&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; Master_Port: &lt;span class=&quot;number&quot;&gt;3306&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; Connect_Retry: &lt;span class=&quot;number&quot;&gt;60&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; Master_Log_File: mysql-bin.&lt;span class=&quot;number&quot;&gt;000005&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; Read_Master_Log_Pos: &lt;span class=&quot;number&quot;&gt;468&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; Relay_Log_File: mysqld-relay-bin.&lt;span class=&quot;number&quot;&gt;000065&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; Relay_Log_Pos: &lt;span class=&quot;number&quot;&gt;283&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; Relay_Master_Log_File: mysql-bin.&lt;span class=&quot;number&quot;&gt;000017&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; Slave_IO_Running: Yes&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; Slave_SQL_Running: Yes&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; Replicate_Do_DB: CoamDatabase,CoamInfo,CoamSNS,form,CommonData,Wordpress,IM_Ejabberd&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; Replicate_Ignore_DB: mysql,&lt;span class=&quot;built_in&quot;&gt;test&lt;/span&gt;,information_schema,performance_schema,collie,ding,inotseeyou_com,pi&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; wik,trac,wzjp_net Replicate_Do_Table:&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; Replicate_Ignore_Table:&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; Replicate_Wild_Do_Table:&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; Replicate_Wild_Ignore_Table:&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; Last_Errno: &lt;span class=&quot;number&quot;&gt;1050&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; Last_Error: Error &lt;span class=&quot;string&quot;&gt;&#39;Table &#39;&lt;/span&gt;Sarah_PictureManager&lt;span class=&quot;string&quot;&gt;&#39; already exists&#39;&lt;/span&gt; on query. Default database&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; : &lt;span class=&quot;string&quot;&gt;&#39;CommonData&#39;&lt;/span&gt;. Query: &lt;span class=&quot;string&quot;&gt;&#39;RENAME TABLE `CommonData`.`Sarah_PictureManager` TO `test`.`Sarah_PictureManager`&#39;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; Skip_Counter: &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; Exec_Master_Log_Pos: &lt;span class=&quot;number&quot;&gt;120&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; Relay_Log_Space: &lt;span class=&quot;number&quot;&gt;12643&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; Until_Condition: None&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; Until_Log_File:&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; Until_Log_Pos: &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; Master_SSL_Allowed: No&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; Master_SSL_CA_File:&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; Master_SSL_CA_Path:&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; Master_SSL_Cert:&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; Master_SSL_Cipher:&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; Master_SSL_Key:&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; Seconds_Behind_Master: NULL&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; Master_SSL_Verify_Server_Cert: No&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; Last_IO_Errno: &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; Last_IO_Error:&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; Last_SQL_Errno: &lt;span class=&quot;number&quot;&gt;1050&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; Last_SQL_Error: Error &lt;span class=&quot;string&quot;&gt;&#39;Table &#39;&lt;/span&gt;Sarah_PictureManager&lt;span class=&quot;string&quot;&gt;&#39; already exists&#39;&lt;/span&gt; on query. Default database&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; : &lt;span class=&quot;string&quot;&gt;&#39;CommonData&#39;&lt;/span&gt;. Query: &lt;span class=&quot;string&quot;&gt;&#39;RENAME TABLE `CommonData`.`Sarah_PictureManager` TO `test`.`Sarah_PictureManager`&#39;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; Replicate_Ignore_Server_Ids:&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; Master_Server_Id: &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; Master_UUID: &lt;span class=&quot;number&quot;&gt;811367&lt;/span&gt;ec-&lt;span class=&quot;number&quot;&gt;52&lt;/span&gt;b9-&lt;span class=&quot;number&quot;&gt;11&lt;/span&gt;e5&lt;span class=&quot;operator&quot;&gt;-a&lt;/span&gt;8f5-&lt;span class=&quot;number&quot;&gt;0022&lt;/span&gt;f75&lt;span class=&quot;built_in&quot;&gt;fc&lt;/span&gt;65a&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; Master_Info_File: /data/home/data/mysql/master.info&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; SQL_Delay: &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; SQL_Remaining_Delay: NULL&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; Slave_SQL_Running_State:&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; Master_Retry_Count: &lt;span class=&quot;number&quot;&gt;86400&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; Master_Bind:&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; Last_IO_Error_Timestamp:&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; Last_SQL_Error_Timestamp: &lt;span class=&quot;number&quot;&gt;150922&lt;/span&gt; &lt;span class=&quot;number&quot;&gt;17&lt;/span&gt;:&lt;span class=&quot;number&quot;&gt;40&lt;/span&gt;:&lt;span class=&quot;number&quot;&gt;05&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; Master_SSL_Crl:&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; Master_SSL_Crlpath:&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; Retrieved_Gtid_Set:&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; Executed_Gtid_Set:&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; Auto_Position: &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt; row &lt;span class=&quot;keyword&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;built_in&quot;&gt;set&lt;/span&gt; (&lt;span class=&quot;number&quot;&gt;0.00&lt;/span&gt; sec)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;ERROR:&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; No query specified&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;&lt;a href=&quot;http://truthone.blog.sohu.com/243314332.html&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;MySQL主从失败, 错误Got fatal error 1236解决方法&lt;/a&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;出现以下错误&lt;/li&gt;
&lt;/ul&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;Slave SQL &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; channel ‘’: Slave failed to initialize relay &lt;span class=&quot;built_in&quot;&gt;log&lt;/span&gt; info structure from the repository, Error_code: &lt;span class=&quot;number&quot;&gt;1872&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;是因为 relay-log 有问题,这时候修改从服务器mysql配置,在[mysqld]中加入relay-log-recovery=1,这样表示,服务器启动之后,删除所有已有的relay日志,重新接收主库的relay日志&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;https://haofly.net/mysql-master-slave/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;Mysql之主从复制&lt;/a&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;问题:主服务器宕机了,如何把从服务器提升会主服务器?&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;答案:在一主多从的环境总,需选择数据最新的从服务器做新的主服务器.&lt;br&gt;如下图所示:&lt;/p&gt;
&lt;p&gt;promotion&lt;/p&gt;
&lt;p&gt;在一主(Server1)两从(Server2,. Server3)环境中,Server1宕机后,等到Server2和Server3把宕机前同步到的日志都执行完,比较Master_Log_File和Read_Master_Log_Pos就可以判断出谁快谁慢,&lt;br&gt;因为Server2从Server1同步的数据(1582)比Server3从Server1同步的数据(1493)新,所以应该提升Server2为新的主服务器,&lt;br&gt;那么Server3在CHANGE MASTER TO到Server2的时候应该使用什么样的参数呢?1582-1493=89,而Server2的最后的二进制日志位置是8167,所以答案是8167-89=8078.&lt;/p&gt;
&lt;h3 id=&quot;参考列表&quot;&gt;&lt;a href=&quot;#参考列表&quot; class=&quot;headerlink&quot; title=&quot;参考列表&quot;&gt;&lt;/a&gt;参考列表&lt;/h3&gt;&lt;p&gt;&lt;a href=&quot;http://huoding.com/2011/04/05/59&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;MySQL复制的概述. 安装. 故障. 技巧. 工具&lt;/a&gt;&lt;br&gt;&lt;a href=&quot;http://blog.itpub.net/29500582/viewspace-1318552/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;Slave_SQL_Running: No mysql同步故障&lt;/a&gt;&lt;br&gt;&lt;a href=&quot;http://mysql.wingtiplabs.com/documentation/reprv7zv/repair-replication&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;Repair Replication&lt;/a&gt;&lt;br&gt;&lt;a href=&quot;http://www.54it.top/archives/638&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;MySQL主从服务器数据不同步&lt;/a&gt;&lt;/p&gt;
</content>
    
    <summary type="html">
    
      &lt;h3 id=&quot;Mysql双机热备份&quot;&gt;&lt;a href=&quot;#Mysql双机热备份&quot; class=&quot;headerlink&quot; title=&quot;Mysql双机热备份&quot;&gt;&lt;/a&gt;Mysql双机热备份&lt;/h3&gt;&lt;h4 id=&quot;Mysql-主从同步配置&quot;&gt;&lt;a href=&quot;#Mysql-主从同步配置&quot; class=&quot;headerlink&quot; title=&quot;Mysql 主从同步配置&quot;&gt;&lt;/a&gt;Mysql 主从同步配置&lt;/h4&gt;&lt;p&gt;概述 首先主服务器把数据变化记录到主日志,然后从服务器通过I/O线程读取主服务器上的主日志,并且把它写入到从服务器的中继日志中,接着SQL线程读取中继日志,并且在从服务器上重放,从而实现MySQL复制.具体如下图所示:&lt;/p&gt;
&lt;p&gt;replication&lt;/p&gt;
&lt;p&gt;整个过程反映到从服务器上,对应三套日志信息,可在从服务器上用如下命令查看:&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;mysql&amp;gt; SHOW SLAVE STATUS;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;pre&gt;&lt;code&gt;Master_Log_File &amp;amp; Read_Master_Log_Pos:下一个传输的主日志信息.
Relay_Master_Log_File &amp;amp; Exec_Master_Log_Pos:下一个执行的主日志信息.
Relay_Log_File &amp;amp; Relay_Log_Pos:下一个执行的中继日志信息.
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;理解这些日志信息的含义对于解决故障至关重要&lt;/p&gt;
&lt;p&gt;两台服务器搭建Mysql双机热备份 mysql 版本最好一致&lt;/p&gt;
&lt;hr&gt;
&lt;h4 id=&quot;一-A主B从&quot;&gt;&lt;a href=&quot;#一-A主B从&quot; class=&quot;headerlink&quot; title=&quot;一. A主B从&quot;&gt;&lt;/a&gt;一. A主B从&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;主服务器 A: 43.241.222.110&lt;/li&gt;
&lt;li&gt;从服务器 B: 42.96.194.60&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;在主A服务器(master)下创建给从B服务器 (slave)登录用的用户名密码&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;GRANT REPLICATION SLAVE ON *.* TO &lt;span class=&quot;string&quot;&gt;&#39;syBackup&#39;&lt;/span&gt;@&lt;span class=&quot;string&quot;&gt;&#39;42.96.194.60&#39;&lt;/span&gt; IDENTIFIED BY &lt;span class=&quot;string&quot;&gt;&#39;******&#39;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;ol&gt;
&lt;li&gt;设置主服务器 A 需要复制的数据库&lt;br&gt;打开主服务器 A 的Mysql配置文件 &lt;em&gt;/etc/mysql/my.cnf&lt;/em&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;28&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;29&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;#################################################&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;server-id=&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt; &lt;span class=&quot;comment&quot;&gt;#主机id,整数&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;#开启二进制日志,并且名称为 /var/lib/mysql/mysql-bin.***&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# 如果是个路径则,保存到该路径下(log-bin=/var/log/mysql-bin.log -&amp;gt; /var/log/mysql-bin.***)&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;built_in&quot;&gt;log&lt;/span&gt;-bin=mysql-bin&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;### as master ###&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;built_in&quot;&gt;read&lt;/span&gt;-only=&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt; &lt;span class=&quot;comment&quot;&gt;#主机读写权限,读写都可以&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;binlog-do-db=CoamDatabase &lt;span class=&quot;comment&quot;&gt;#记录日志的数据库:需要的备份数据,多个写多行&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;binlog-do-db=CoamInfo&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;binlog-do-db=CoamSNS&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;binlog-do-db=form&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;binlog-do-db=CommonData&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;binlog-do-db=Wordpress&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;binlog-do-db=IM_Ejabberd&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;binlog-ignore-db=mysql &lt;span class=&quot;comment&quot;&gt;#不记录日志的数据库:不需要备份的数据库,多个写多行&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;binlog-ignore-db=&lt;span class=&quot;built_in&quot;&gt;test&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;binlog-ignore-db=information_schema&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;binlog-ignore-db=performance_schema&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# 自增字段奇数递增,防止冲突(1, 11, 21, ...,)&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;auto-increment-increment = &lt;span class=&quot;number&quot;&gt;10&lt;/span&gt; &lt;span class=&quot;comment&quot;&gt;# 每次递增的步长&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;auto-increment-offset = &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt; &lt;span class=&quot;comment&quot;&gt;# 初始值&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;### as slave ###&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;###&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;###############################################################&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;重启 Mysql 是配置生效,可以看到主(43.241.222.110) Mysql  增加了两个文件 mysql-bin.000001 和 mysql-bin.index &lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;Tue May &lt;span class=&quot;number&quot;&gt;17&lt;/span&gt; &lt;span class=&quot;number&quot;&gt;10&lt;/span&gt;:&lt;span class=&quot;number&quot;&gt;31&lt;/span&gt;:&lt;span class=&quot;number&quot;&gt;52&lt;/span&gt; yzhang@coam:/data/home/data/mysql$ ls&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;auto.cnf         client-key.pem  coam.pid    ib_buffer_pool  ibtmp1           performance_schema  server-key.pem&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;ca-key.pem       CoamDatabase    CoamSNS     ibdata1         IM_Ejabberd      private_key.pem     sys&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;ca.pem           coam.err        CommonData  ib_logfile0     mysql            public_key.pem      &lt;span class=&quot;built_in&quot;&gt;test&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;client-cert.pem  CoamInfo        forum       ib_logfile1     mysqld_safe.pid  server-cert.pem     Wordpress&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;Tue May &lt;span class=&quot;number&quot;&gt;17&lt;/span&gt; &lt;span class=&quot;number&quot;&gt;10&lt;/span&gt;:&lt;span class=&quot;number&quot;&gt;31&lt;/span&gt;:&lt;span class=&quot;number&quot;&gt;52&lt;/span&gt; yzhang@coam:/data/home/data/mysql$ sudo service mysql restart       ======&amp;gt; 重启 Mysql 数据库服务&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;Tue May &lt;span class=&quot;number&quot;&gt;17&lt;/span&gt; &lt;span class=&quot;number&quot;&gt;10&lt;/span&gt;:&lt;span class=&quot;number&quot;&gt;31&lt;/span&gt;:&lt;span class=&quot;number&quot;&gt;52&lt;/span&gt; yzhang@coam:/data/home/data/mysql$ ls&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;auto.cnf         CoamDatabase  CommonData      ib_logfile1       mysql-bin.&lt;span class=&quot;number&quot;&gt;000002&lt;/span&gt;  performance_schema  sys&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;ca-key.pem       coam.err      forum           ibtmp1            mysql-bin.&lt;span class=&quot;number&quot;&gt;000003&lt;/span&gt;  private_key.pem     &lt;span class=&quot;built_in&quot;&gt;test&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;ca.pem           CoamInfo      ib_buffer_pool  IM_Ejabberd       mysql-bin.&lt;span class=&quot;number&quot;&gt;000004&lt;/span&gt;  public_key.pem      Wordpress&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;client-cert.pem  coam.pid      ibdata1         mysql             mysql-bin.index   server-cert.pem&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;client-key.pem   CoamSNS       ib_logfile0     mysql-bin.&lt;span class=&quot;number&quot;&gt;000001&lt;/span&gt;  mysqld_safe.pid   server-key.pem&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;– 注意,这里因为配置有问题重启过几次 mysql 导致生成 [mysql-bin.000001 mysql-bin.000002 mysql-bin.000003 mysql-bin.000004] 等几个文件,不过不影响后续步骤执行&lt;/p&gt;
&lt;p&gt;先锁定 (hello) 数据库 - 不要退出 mysql shell&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;mysql&amp;gt; FLUSH TABLES WITH READ LOCK;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;然后新开一个终端,导出数据库,我这里只需要导出 hello 数据库, 如果你有多个数据库作为初态的话, 需要导出所有这些数据库:( 这里为了便于测试,我先不导出 forum 数据库,后续测试单独补加同步数据库)&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;mysqldump --master-data -uroot -p hello &amp;gt; hello.sql&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;mysqldump -u username -p password --databases CoamDatabase CoamInfo CoamSNS CommonData Wordpress IM_Ejabberd &amp;gt;backup.sql&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;查看主服务器的状态&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;mysql&amp;gt; show master status\G;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;*************************** &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;. row ***************************&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;             File: mysql-bin.&lt;span class=&quot;number&quot;&gt;000005&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;         Position: &lt;span class=&quot;number&quot;&gt;154&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;     Binlog_Do_DB: CoamDatabase,CoamInfo,CoamSNS,forum,CommonData,Wordpress,IM_Ejabberd&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; Binlog_Ignore_DB: mysql,&lt;span class=&quot;built_in&quot;&gt;test&lt;/span&gt;,information_schema,performance_schema&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;Executed_Gtid_Set:&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt; row &lt;span class=&quot;keyword&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;built_in&quot;&gt;set&lt;/span&gt; (&lt;span class=&quot;number&quot;&gt;0.00&lt;/span&gt; sec)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;ERROR:&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;No query specified&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;然后查看A服务器的 binary 日志位置,记下 Position 和 File 的值.&lt;/p&gt;
&lt;p&gt;主服务器已经做完了, 可以解除锁定了&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;UNLOCK TABLES;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;ol&gt;
&lt;li&gt;设置从服务器 B 需要复制的数据库&lt;br&gt;打开从服务器 B 的 Mysql 配置文件 &lt;em&gt;/etc/mysql/my.cnf&lt;/em&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;28&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;[mysqld]&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;####################################################################&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;server-id=&lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;built_in&quot;&gt;log&lt;/span&gt;-bin=mysql-bin&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;### as master ###&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;### as slave ###&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;replicate-do-db=CoamDatabase &lt;span class=&quot;comment&quot;&gt;#只复制某个库,多个写多行&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;replicate-do-db=CoamInfo&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;replicate-do-db=CoamSNS&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;replicate-do-db=form&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;replicate-do-db=CommonData&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;replicate-do-db=Wordpress&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;replicate-do-db=IM_Ejabberd&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;replicate-ignore-db=mysql &lt;span class=&quot;comment&quot;&gt;#不复制某个库&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;replicate-ignore-db=&lt;span class=&quot;built_in&quot;&gt;test&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;replicate-ignore-db=information_schema&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;replicate-ignore-db=performance_schema&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;relay-log=mysqld-relay-bin &lt;span class=&quot;comment&quot;&gt;# 开启日志中继&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;built_in&quot;&gt;log&lt;/span&gt;-slave-updates &lt;span class=&quot;comment&quot;&gt;# slave 将复制事件写进自己的二进制日志&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;#5.5&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;#log-slave-updates = ON&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;#5.1&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;#log-slave-updates = 1&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;###############################################################&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;重启 Mysql 是配置生效,可以看到从(42.96.194.60) Mysql  也相应的增加了两个文件 mysql-bin.000001 和 mysql-bin.index &lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;Tue May &lt;span class=&quot;number&quot;&gt;17&lt;/span&gt; &lt;span class=&quot;number&quot;&gt;11&lt;/span&gt;:&lt;span class=&quot;number&quot;&gt;07&lt;/span&gt;:&lt;span class=&quot;number&quot;&gt;14&lt;/span&gt; yzhang@coam:/data/home/data/mysql$ ls&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;auto.cnf    client-cert.pem  coam.pid        ib_logfile0  mysql               private_key.pem  server-key.pem&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;ca-key.pem  client-key.pem   ib_buffer_pool  ib_logfile1  mysqld_safe.pid     public_key.pem   sys&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;ca.pem      coam.err         ibdata1         ibtmp1       performance_schema  server-cert.pem&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;Tue May &lt;span class=&quot;number&quot;&gt;17&lt;/span&gt; &lt;span class=&quot;number&quot;&gt;10&lt;/span&gt;:&lt;span class=&quot;number&quot;&gt;31&lt;/span&gt;:&lt;span class=&quot;number&quot;&gt;52&lt;/span&gt; yzhang@coam:/data/home/data/mysql$ sudo service mysql restart       ======&amp;gt; 重启 Mysql 数据库服务&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;Tue May &lt;span class=&quot;number&quot;&gt;17&lt;/span&gt; &lt;span class=&quot;number&quot;&gt;11&lt;/span&gt;:&lt;span class=&quot;number&quot;&gt;08&lt;/span&gt;:&lt;span class=&quot;number&quot;&gt;40&lt;/span&gt; yzhang@coam:/data/home/data/mysql$ ls&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;auto.cnf    client-cert.pem  coam.pid        ib_logfile0  mysql             mysqld_safe.pid     public_key.pem   sys&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;ca-key.pem  client-key.pem   ib_buffer_pool  ib_logfile1  mysql-bin.&lt;span class=&quot;number&quot;&gt;000001&lt;/span&gt;  performance_schema  server-cert.pem&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;ca.pem      coam.err         ibdata1         ibtmp1       mysql-bin.index   private_key.pem     server-key.pem&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;导入从主服务器导出的数据库 hello,然后&lt;/p&gt;
&lt;p&gt;导入 master 导出的数据库:&lt;/p&gt;
&lt;p&gt;分别创建需要导入的数据库&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;mysql&amp;gt; CREATE DATABASE CoamDatabase DEFAULT CHARACTER SET utf8 DEFAULT COLLATE utf8_general_ci;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;mysql&amp;gt; CREATE DATABASE CoamInfo DEFAULT CHARACTER SET utf8 DEFAULT COLLATE utf8_general_ci;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;mysql&amp;gt; CREATE DATABASE CoamSNS DEFAULT CHARACTER SET utf8 DEFAULT COLLATE utf8_general_ci;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;mysql&amp;gt; CREATE DATABASE CommonData DEFAULT CHARACTER SET utf8 DEFAULT COLLATE utf8_general_ci;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;mysql&amp;gt; CREATE DATABASE Wordpress DEFAULT CHARACTER SET utf8 DEFAULT COLLATE utf8_general_ci;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;mysql&amp;gt; CREATE DATABASE IM_Ejabberd DEFAULT CHARACTER SET utf8 DEFAULT COLLATE utf8_general_ci;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;mysql&amp;gt; &lt;span class=&quot;built_in&quot;&gt;source&lt;/span&gt; backup.sql;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# 以下方式分别导入数据库&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;mysql -uroot -p CoamDatabase &amp;lt; backup.sql&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;mysql -uroot -p CoamInfo &amp;lt; backup.sql&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;mysql -uroot -p CoamSNS &amp;lt; backup.sql&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;mysql -uroot -p CommonData &amp;lt; backup.sql&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;mysql -uroot -p Wordpress &amp;lt; backup.sql&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;mysql -uroot -p IM_Ejabberd &amp;lt; backup.sql&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;ol&gt;
&lt;li&gt;在从 slave 服务器配置连接 master 信息:&lt;/li&gt;
&lt;/ol&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;mysql&amp;gt; slave stop;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;mysql&amp;gt; CHANGE MASTER TO&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;-&amp;gt; MASTER_HOST=&lt;span class=&quot;string&quot;&gt;&#39;43.241.222.110&#39;&lt;/span&gt;, //主服务器的IP地址&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;-&amp;gt; MASTER_USER=&lt;span class=&quot;string&quot;&gt;&#39;syBackup&#39;&lt;/span&gt;, //同步数据库的用户&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;-&amp;gt; MASTER_PASSWORD=&lt;span class=&quot;string&quot;&gt;&#39;******&#39;&lt;/span&gt;, //同步数据库的密码&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;-&amp;gt; MASTER_CONNECT_RETRY=&lt;span class=&quot;number&quot;&gt;60&lt;/span&gt;,  // 如果从服务器发现主服务器断掉,重新连接的时间差(秒)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;-&amp;gt; MASTER_LOG_FILE=&lt;span class=&quot;string&quot;&gt;&#39;mysql-bin.000001&#39;&lt;/span&gt;, //主服务器二进制日志的文件名(前面要求记住的 File 参数)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;-&amp;gt; MASTER_LOG_POS=&lt;span class=&quot;number&quot;&gt;98&lt;/span&gt;; //日志文件的开始位置(前面要求记住的 Position 参数)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;mysql&amp;gt; CHANGE MASTER TO MASTER_HOST=&lt;span class=&quot;string&quot;&gt;&#39;43.241.222.110&#39;&lt;/span&gt;, MASTER_USER=&lt;span class=&quot;string&quot;&gt;&#39;syBackup&#39;&lt;/span&gt;, MASTER_PASSWORD=&lt;span class=&quot;string&quot;&gt;&#39;******&#39;&lt;/span&gt;, MASTER_CONNECT_RETRY=&lt;span class=&quot;number&quot;&gt;60&lt;/span&gt;, MASTER_LOG_FILE=&lt;span class=&quot;string&quot;&gt;&#39;mysql-bin.000005&#39;&lt;/span&gt;, MASTER_LOG_POS=&lt;span class=&quot;number&quot;&gt;154&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;mysql &amp;gt; slave start;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;重启 master, slave:  &lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;service mysqld restart&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;查看 slave 状态:&lt;/p&gt;
&lt;p&gt;进入从服务器 slave mysql:&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;22&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;mysql&amp;gt; show slave status\G;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;*************************** &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;. row ***************************&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            Slave_IO_State: Connecting to master&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                Master_Host: &lt;span class=&quot;number&quot;&gt;43.241&lt;/span&gt;.&lt;span class=&quot;number&quot;&gt;222.110&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                Master_User: syBackup&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                Master_Port: &lt;span class=&quot;number&quot;&gt;3306&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            Connect_Retry: &lt;span class=&quot;number&quot;&gt;60&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            Master_Log_File: mysql-bin.&lt;span class=&quot;number&quot;&gt;000001&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        Read_Master_Log_Pos: &lt;span class=&quot;number&quot;&gt;98&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            Relay_Log_File: mysqld-relay-bin.&lt;span class=&quot;number&quot;&gt;000001&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            Relay_Log_Pos: &lt;span class=&quot;number&quot;&gt;98&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    Relay_Master_Log_File: mysql-bin.&lt;span class=&quot;number&quot;&gt;000001&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        Slave_IO_Running: Yes&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        Slave_SQL_Running: Yes&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            Replicate_Do_DB: CoamDatabase,CoamInfo,CoamSNS,form,CommonData,Wordpress,IM_Ejabberd&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; Replicate_Ignore_DB: mysql,&lt;span class=&quot;built_in&quot;&gt;test&lt;/span&gt;,information_schema,performance_schema,collie,ding,inotseeyou_com,pi&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;wik,trac,wzjp_net&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        Exec_Master_Log_Pos: &lt;span class=&quot;number&quot;&gt;98&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            Relay_Log_Space: &lt;span class=&quot;number&quot;&gt;98&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            Until_Log_Pos: &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    Seconds_Behind_Master: NULL&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt; row &lt;span class=&quot;keyword&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;built_in&quot;&gt;set&lt;/span&gt; (&lt;span class=&quot;number&quot;&gt;0.00&lt;/span&gt; sec)&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;注意一定要有下面两项(IO线程和SQL线程),没有的话查看错误日志(less /var/log/mysqld.log):&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;Slave_IO_Running: Yes&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;Slave_SQL_Running: Yes&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;如果显示这个状态 则稍等一会儿&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;Slave_IO_State: Waiting &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; master to send event&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;测试 master 服务器&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;mysql&amp;gt; use hello;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;Database changed&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;mysql&amp;gt; create table &lt;span class=&quot;built_in&quot;&gt;test&lt;/span&gt;(id int);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;mysql&amp;gt; insert int &lt;span class=&quot;built_in&quot;&gt;test&lt;/span&gt; &lt;span class=&quot;built_in&quot;&gt;set&lt;/span&gt; id=&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;mysql&amp;gt; show master status\G;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;*************************** &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;. row ***************************&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            File: mysql-bin.&lt;span class=&quot;number&quot;&gt;000002&lt;/span&gt;  &lt;span class=&quot;comment&quot;&gt;# 注意这里&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        Position: &lt;span class=&quot;number&quot;&gt;276&lt;/span&gt;    &lt;span class=&quot;comment&quot;&gt;# 注意这里&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    Binlog_Do_DB:&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;CoamDatabase,CoamInfo,CoamSNS,form,CommonData,Wordpress,IM_Ejabberd&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;Binlog_Ignore_DB: mysql,&lt;span class=&quot;built_in&quot;&gt;test&lt;/span&gt;,information_schema,performance_schema,collie,ding,inotseeyou_com,pi&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;wik,trac,wzjp_net&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt; row &lt;span class=&quot;keyword&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;built_in&quot;&gt;set&lt;/span&gt; (&lt;span class=&quot;number&quot;&gt;0.00&lt;/span&gt; sec)&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;测试 slave 服务器&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;28&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;29&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;30&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;31&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;32&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;33&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;34&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;35&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;36&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;37&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;38&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;39&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;40&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;41&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;mysql&amp;gt; use hello;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;mysql&amp;gt; show tables;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;+-----------------+&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;| Tables_&lt;span class=&quot;keyword&quot;&gt;in&lt;/span&gt;_hello |&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;+-----------------+&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;| &lt;span class=&quot;built_in&quot;&gt;test&lt;/span&gt;            | &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;+-----------------+&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt; row &lt;span class=&quot;keyword&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;built_in&quot;&gt;set&lt;/span&gt; (&lt;span class=&quot;number&quot;&gt;0.00&lt;/span&gt; sec)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;mysql&amp;gt; select * from &lt;span class=&quot;built_in&quot;&gt;test&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;+------+&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;| id   |&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;+------+&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;|    &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt; | &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;+------+&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt; row &lt;span class=&quot;keyword&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;built_in&quot;&gt;set&lt;/span&gt; (&lt;span class=&quot;number&quot;&gt;0.00&lt;/span&gt; sec)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;mysql&amp;gt; show slave status\G;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;*************************** &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;. row ***************************&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            Slave_IO_State: Waiting &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; master to send event&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                Master_Host: &lt;span class=&quot;number&quot;&gt;43.241&lt;/span&gt;.&lt;span class=&quot;number&quot;&gt;222.110&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                Master_User: syBackup&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                Master_Port: &lt;span class=&quot;number&quot;&gt;3306&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            Connect_Retry: &lt;span class=&quot;number&quot;&gt;60&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            Master_Log_File: mysql-bin.&lt;span class=&quot;number&quot;&gt;000002&lt;/span&gt;  &lt;span class=&quot;comment&quot;&gt;# 跟 master 一样&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        Read_Master_Log_Pos: &lt;span class=&quot;number&quot;&gt;276&lt;/span&gt;  &lt;span class=&quot;comment&quot;&gt;# 跟 master 一样&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            Relay_Log_File: mysqld-relay-bin.&lt;span class=&quot;number&quot;&gt;000003&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            Relay_Log_Pos: &lt;span class=&quot;number&quot;&gt;413&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    Relay_Master_Log_File: mysql-bin.&lt;span class=&quot;number&quot;&gt;000002&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        Slave_IO_Running: Yes&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        Slave_SQL_Running: Yes&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            Replicate_Do_DB: CoamDatabase,CoamInfo,CoamSNS,form,CommonData,Wordpress,IM_Ejabberd&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; Replicate_Ignore_DB: mysql,&lt;span class=&quot;built_in&quot;&gt;test&lt;/span&gt;,information_schema,performance_schema,collie,ding,inotseeyou_com,pi&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;wik,trac,wzjp_net&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                Last_Errno: &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                Last_Error: &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            Skip_Counter: &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        Exec_Master_Log_Pos: &lt;span class=&quot;number&quot;&gt;276&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            Relay_Log_Space: &lt;span class=&quot;number&quot;&gt;413&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    Seconds_Behind_Master: &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt; row &lt;span class=&quot;keyword&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;built_in&quot;&gt;set&lt;/span&gt; (&lt;span class=&quot;number&quot;&gt;0.00&lt;/span&gt; sec)&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;主A服务器从B服务器配置就已经顺利完成了 –A从B主&lt;/p&gt;
&lt;hr&gt;
&lt;h4 id=&quot;二-下面开始配置从A服务器主B服务器&quot;&gt;&lt;a href=&quot;#二-下面开始配置从A服务器主B服务器&quot; class=&quot;headerlink&quot; title=&quot;二. 下面开始配置从A服务器主B服务器&quot;&gt;&lt;/a&gt;二. 下面开始配置从A服务器主B服务器&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;从服务器 A: 43.241.222.110&lt;/li&gt;
&lt;li&gt;主服务器 B: 42.96.194.60&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;一、设置主服务器 A 需要复制的数据库&lt;br&gt;打开主服务器 B 的 Mysql 配置文件 &lt;em&gt;/etc/mysql/my.cnf&lt;/em&gt; 并添加以下配置项&lt;/p&gt;
&lt;figure class=&quot;highlight ini&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;26&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;###############################################################&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;setting&quot;&gt;server-id=&lt;span class=&quot;value&quot;&gt;&lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;setting&quot;&gt;log-bin=&lt;span class=&quot;value&quot;&gt;mysql-bin&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;### as master ###&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;setting&quot;&gt;read-only=&lt;span class=&quot;value&quot;&gt;&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt; #主机读写权限,读写都可&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;setting&quot;&gt;binlog-do-db=&lt;span class=&quot;value&quot;&gt;CoamDatabase #记录日志的数据库:需要的备份数据,多个写多行&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;setting&quot;&gt;binlog-do-db=&lt;span class=&quot;value&quot;&gt;CoamInfo&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;setting&quot;&gt;binlog-do-db=&lt;span class=&quot;value&quot;&gt;CoamSNS&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;setting&quot;&gt;binlog-do-db=&lt;span class=&quot;value&quot;&gt;form&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;setting&quot;&gt;binlog-do-db=&lt;span class=&quot;value&quot;&gt;CommonData&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;setting&quot;&gt;binlog-do-db=&lt;span class=&quot;value&quot;&gt;Wordpress&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;setting&quot;&gt;binlog-do-db=&lt;span class=&quot;value&quot;&gt;IM_Ejabberd&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;setting&quot;&gt;binlog-ignore-db=&lt;span class=&quot;value&quot;&gt;mysql #不记录日志的数据库:不需要备份的数据库,多个写多行&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;setting&quot;&gt;binlog-ignore-db=&lt;span class=&quot;value&quot;&gt;test&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;setting&quot;&gt;binlog-ignore-db=&lt;span class=&quot;value&quot;&gt;information_schema&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;setting&quot;&gt;binlog-ignore-db=&lt;span class=&quot;value&quot;&gt;performance_schema&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# 自增字段奇数递增,防止冲突(1, 3, 5, ...,)&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;setting&quot;&gt;auto-increment-increment = &lt;span class=&quot;value&quot;&gt;&lt;span class=&quot;number&quot;&gt;10&lt;/span&gt; # 每次递增的步长&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;setting&quot;&gt;auto-increment-offset = &lt;span class=&quot;value&quot;&gt;&lt;span class=&quot;number&quot;&gt;2&lt;/span&gt; # 初始值&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;### as slave ###&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# 之前配置过,这里保持不变&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;#######################################################################&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;重启 mysql: &lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;serivce mysqld restart&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;在主 B 服务器(master)下创建给从A服务器 (slave)登录用的用户名密码&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;mysql&amp;gt; GRANT REPLICATION SLAVE ON *.* TO &lt;span class=&quot;string&quot;&gt;&#39;syBackup&#39;&lt;/span&gt;@&lt;span class=&quot;string&quot;&gt;&#39;43.241.222.110&#39;&lt;/span&gt; IDENTIFIED BY &lt;span class=&quot;string&quot;&gt;&#39;******&#39;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;mysql&amp;gt; FLUSH TABLES WITH READ LOCK;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;mysql&amp;gt; show master status\G;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;*************************** &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;. row ***************************&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;         File: mysql-bin.&lt;span class=&quot;number&quot;&gt;000003&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;         Position: &lt;span class=&quot;number&quot;&gt;468&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;     Binlog_Do_DB: CoamDatabase,CoamInfo,CoamSNS,forum,CommonData,Wordpress,IM_Ejabberd&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; Binlog_Ignore_DB: mysql,&lt;span class=&quot;built_in&quot;&gt;test&lt;/span&gt;,information_schema,performance_schema&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;Executed_Gtid_Set:&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt; row &lt;span class=&quot;keyword&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;built_in&quot;&gt;set&lt;/span&gt; (&lt;span class=&quot;number&quot;&gt;0.01&lt;/span&gt; sec)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;mysql&amp;gt; UNLOCK TABLES;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;hr&gt;
&lt;p&gt;在从服务器 A 的服务器配置登陆主服务器 B 中创建的复制用户登陆&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;mysql&amp;gt; slave stop;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;mysql&amp;gt;  CHANGE MASTER TO MASTER_HOST=&lt;span class=&quot;string&quot;&gt;&#39;42.96.194.60&#39;&lt;/span&gt;, MASTER_USER=&lt;span class=&quot;string&quot;&gt;&#39;syBackup&#39;&lt;/span&gt;, MASTER_PASSWORD=&lt;span class=&quot;string&quot;&gt;&#39;yafei312&#39;&lt;/span&gt;, MASTER_CONNECT_RETRY=&lt;span class=&quot;number&quot;&gt;60&lt;/span&gt;, MASTER_LOG_FILE=&lt;span class=&quot;string&quot;&gt;&#39;mysql-bin.000004, MASTER_LOG_POS=46702&#39;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;mysql&amp;gt; slave start;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;修改从服务器A的 Mysql 配置文件 &lt;em&gt;/etc/mysql/my.cnf&lt;/em&gt; 从配置信息&lt;/p&gt;
&lt;p&gt;打开从服务器 A 的 Mysql 配置文件 &lt;em&gt;/etc/mysql/my.cnf&lt;/em&gt; 并添加以下配置项&lt;/p&gt;
&lt;figure class=&quot;highlight&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;19&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;### as master ###&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;### as slave ###&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;replicate-do-db=CoamDatabase #只复制某个库,多个写多行&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;replicate-do-db=CoamInfo&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;replicate-do-db=CoamSNS&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;replicate-do-db=form&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;replicate-do-db=CommonData&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;replicate-do-db=Wordpress&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;replicate-do-db=IM_Ejabberd&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;replicate-ignore-db=mysql #不复制某个库&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;replicate-ignore-db=test&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;replicate-ignore-db=information_schema&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;replicate-ignore-db=performance_schema&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;relay-log=mysqld-relay-bin # 开启日志中继&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;log-slave-updates # slave将复制事件写进自己的二进制日志&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;######################################################################&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;重启主服务器A、B并测试插入测试更新数据&lt;/p&gt;
&lt;p&gt;从 A 服务器 43.241.222.110&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;mysql&amp;gt; show slave status\G;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;hr&gt;
&lt;p&gt;最后的 A 服务器 配置文件 &lt;em&gt;/etc/mysql/my.cnf&lt;/em&gt;&lt;/p&gt;
&lt;figure class=&quot;highlight&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;28&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;29&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;30&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;31&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;32&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;33&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;34&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;35&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;36&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;37&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;38&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;39&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;40&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;41&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;42&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;43&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;44&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;45&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;46&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;47&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;#######################################################&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;server-id=1 #主机id,整数&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;#开启二进制日志,并且名称为 /var/lib/mysql/mysql-bin.***&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;# 如果是个路径则,保存到该路径下(log-bin=/var/log/mysql-bin.log -&amp;gt; /var/log/mysql-bin.***)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;log-bin=mysql-bin&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;### as master ###&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;read-only=0 #主机读写权限,读写都可以&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;binlog-do-db=CoamDatabase #记录日志的数据库:需要的备份数据,多个写多行&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;binlog-do-db=CoamInfo&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;binlog-do-db=CoamSNS&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;binlog-do-db=form&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;binlog-do-db=CommonData&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;binlog-do-db=Wordpress&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;binlog-do-db=IM_Ejabberd&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;binlog-ignore-db=mysql #不记录日志的数据库:不需要备份的数据库,多个写多行&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;binlog-ignore-db=test&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;binlog-ignore-db=information_schema&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;binlog-ignore-db=performance_schema&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;# 自增字段奇数递增,防止冲突(1, 11, 21, ...,)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;auto-increment-increment = 10 # 每次递增的步长&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;auto-increment-offset = 1 # 初始值&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;### as slave ###&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;replicate-do-db=CoamDatabase #只复制某个库,多个写多行&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;replicate-do-db=CoamInfo&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;replicate-do-db=CoamSNS&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;replicate-do-db=form&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;replicate-do-db=CommonData&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;replicate-do-db=Wordpress&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;replicate-do-db=IM_Ejabberd&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;replicate-ignore-db=mysql #不复制某个库&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;replicate-ignore-db=test&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;replicate-ignore-db=information_schema&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;replicate-ignore-db=performance_schema&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;relay-log=mysqld-relay-bin # 开启日志中继&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;log-slave-updates # slave将复制事件写进自己的二进制日志&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;#5.5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;#log-slave-updates = ON&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;#5.1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;#log-slave-updates = 1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;#######################################################&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;最后的 B 服务器配置文件 &lt;em&gt;/etc/mysql/my.cnf&lt;/em&gt;&lt;/p&gt;
&lt;figure class=&quot;highlight&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;28&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;29&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;30&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;31&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;32&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;33&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;34&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;35&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;36&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;37&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;38&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;39&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;40&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;41&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;42&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;43&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;44&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;###############################################################&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;server-id=2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;log-bin=mysql-bin&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;### as master ###&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;read-only=0 #主机读写权限,读写都可以&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;binlog-do-db=CoamDatabase #记录日志的数据库:需要的备份数据,多个写多行&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;binlog-do-db=CoamInfo&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;binlog-do-db=CoamSNS&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;binlog-do-db=form&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;binlog-do-db=CommonData&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;binlog-do-db=Wordpress&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;binlog-do-db=IM_Ejabberd&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;binlog-ignore-db=mysql #不记录日志的数据库:不需要备份的数据库,多个写多行&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;binlog-ignore-db=test&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;binlog-ignore-db=information_schema&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;binlog-ignore-db=performance_schema&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;# 自增字段奇数递增,防止冲突(2, 12, 22, ...,)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;auto-increment-increment = 10 # 每次递增的步长&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;auto-increment-offset = 2 # 初始值&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;### as slave ###&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;replicate-do-db=CoamDatabase #只复制某个库,多个写多行&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;replicate-do-db=CoamInfo&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;replicate-do-db=CoamSNS&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;replicate-do-db=form&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;replicate-do-db=CommonData&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;replicate-do-db=Wordpress&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;replicate-do-db=IM_Ejabberd&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;replicate-ignore-db=mysql #不复制某个库&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;replicate-ignore-db=test&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;replicate-ignore-db=information_schema&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;replicate-ignore-db=performance_schema&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;relay-log=mysqld-relay-bin # 开启日志中继&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;log-slave-updates # slave将复制事件写进自己的二进制日志&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;#5.5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;#log-slave-updates = ON&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;#5.1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;#log-slave-updates = 1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;###############################################################&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;hr&gt;
&lt;h3 id=&quot;其它&quot;&gt;&lt;a href=&quot;#其它&quot; class=&quot;headerlink&quot; title=&quot;其它&quot;&gt;&lt;/a&gt;其它&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;安装MySQL.首先要在两台服务器上安装MySQL,完成之后应该确认能否两台服务器能否互相访问. 这是因为缺省的 my.cnf 设置有 bind-address = 127.0.0.1,这条语句应该被注释掉.&lt;/li&gt;
&lt;li&gt;创建账号.数据库中缺省的帐户的host值是localhost,所以应该创建一个可以远端访问的帐号.比如:&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;root@’%’ or root@10.x.x.x&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id=&quot;Mysql双机热备份日常维护及问题分析&quot;&gt;&lt;a href=&quot;#Mysql双机热备份日常维护及问题分析&quot; class=&quot;headerlink&quot; title=&quot;Mysql双机热备份日常维护及问题分析&quot;&gt;&lt;/a&gt;Mysql双机热备份日常维护及问题分析&lt;/h3&gt;
    
    </summary>
    
    
  </entry>
  
  <entry>
    <title>MysqlToRedis</title>
    <link href="https://coam.co/2016/05/14/Mysql/MysqlToRedis/"/>
    <id>https://coam.co/2016/05/14/Mysql/MysqlToRedis/</id>
    <published>2016-05-14T08:48:31.000Z</published>
    <updated>2016-05-19T08:26:14.815Z</updated>
    
    <content type="html">&lt;h3 id=&quot;Ubuntu-安装-Mysql2redis-及错误日记&quot;&gt;&lt;a href=&quot;#Ubuntu-安装-Mysql2redis-及错误日记&quot; class=&quot;headerlink&quot; title=&quot;Ubuntu 安装 Mysql2redis 及错误日记&quot;&gt;&lt;/a&gt;Ubuntu 安装 Mysql2redis 及错误日记&lt;/h3&gt;&lt;a id=&quot;more&quot;&gt;&lt;/a&gt;
&lt;p&gt;&lt;em&gt;mysql2redis&lt;/em&gt; 是 Mysql 的一个 &lt;em&gt;UDF(user-defined function)&lt;/em&gt; 函数,它提供了 &lt;em&gt;mysql&lt;/em&gt; 与 &lt;em&gt;redis&lt;/em&gt; 之间的数据交互.当 &lt;em&gt;mysql&lt;/em&gt; 的数据进行了更新,它就会调用相应 的 &lt;em&gt;trigger&lt;/em&gt; 调用 &lt;em&gt;mysql2redis&lt;/em&gt; 里面的函数对 &lt;em&gt;redis&lt;/em&gt; 的数据进行更新.&lt;/p&gt;
&lt;p&gt;安装前提&lt;/p&gt;
&lt;p&gt;安装 &lt;em&gt;mysql2redis&lt;/em&gt; 前,先在系统里安装 mysql, redis 并安装相关依赖:&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;jemalloc&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;apr 和 apr-util&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;hiredis&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;lib_mysqludf_json&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;hr&gt;
&lt;h3 id=&quot;安装过程–Ubuntu&quot;&gt;&lt;a href=&quot;#安装过程–Ubuntu&quot; class=&quot;headerlink&quot; title=&quot;安装过程–Ubuntu&quot;&gt;&lt;/a&gt;安装过程–Ubuntu&lt;/h3&gt;&lt;h4 id=&quot;安装jemalloc-安装命令如下&quot;&gt;&lt;a href=&quot;#安装jemalloc-安装命令如下&quot; class=&quot;headerlink&quot; title=&quot;安装jemalloc 安装命令如下:&quot;&gt;&lt;/a&gt;安装jemalloc 安装命令如下:&lt;/h4&gt;&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;sudo apt-get install libjemalloc1 libjemalloc-dev -y&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h3 id=&quot;安装-apr-和-apr-util&quot;&gt;&lt;a href=&quot;#安装-apr-和-apr-util&quot; class=&quot;headerlink&quot; title=&quot;安装 apr 和 apr-util&quot;&gt;&lt;/a&gt;安装 apr 和 apr-util&lt;/h3&gt;&lt;blockquote&gt;
&lt;p&gt;&lt;em&gt;apr&lt;/em&gt; 和 &lt;em&gt;apr-util&lt;/em&gt; 是两个依赖包,它们最新版本的下载地址请点击,下载 好的以后,它的安装过程如下(配制,编译,安装):&lt;/p&gt;
&lt;/blockquote&gt;
&lt;ul&gt;
&lt;li&gt;首先安装 apr&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;apr-1.4.6(&lt;a href=&quot;http://apr.apache.org/download.cgi&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;http://apr.apache.org/download.cgi&lt;/a&gt;)&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;sudo wget http://apache.claz.org/apr/apr-&lt;span class=&quot;number&quot;&gt;1.5&lt;/span&gt;.&lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;.tar.gz&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;sudo tar zxvf apr-&lt;span class=&quot;number&quot;&gt;1.5&lt;/span&gt;.&lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;.tar.gz&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;built_in&quot;&gt;cd&lt;/span&gt; apr-&lt;span class=&quot;number&quot;&gt;1.5&lt;/span&gt;.&lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;./configure&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;make&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;make &lt;span class=&quot;built_in&quot;&gt;test&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;sudo make install&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;完成编译后将会创建 &lt;em&gt;/usr/local/apr&lt;/em&gt; 目录下&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;再次安装 apr-util&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;apr-util-1.5.2(&lt;a href=&quot;http://apr.apache.org/download.cgi&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;http://apr.apache.org/download.cgi&lt;/a&gt;)&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;sudo wget http://ftp.wayne.edu/apache//apr/apr-util-&lt;span class=&quot;number&quot;&gt;1.5&lt;/span&gt;.&lt;span class=&quot;number&quot;&gt;4&lt;/span&gt;.tar.gz&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;sudo tar zxvf apr-util-&lt;span class=&quot;number&quot;&gt;1.5&lt;/span&gt;.&lt;span class=&quot;number&quot;&gt;4&lt;/span&gt;.tar.gz&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;built_in&quot;&gt;cd&lt;/span&gt; apr-util-&lt;span class=&quot;number&quot;&gt;1.5&lt;/span&gt;.&lt;span class=&quot;number&quot;&gt;4&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;./configure --with-apr=/usr/&lt;span class=&quot;built_in&quot;&gt;local&lt;/span&gt;/apr&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;make&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;sudo make install&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;完成编译后将会将 apr-util 添加至 &lt;em&gt;/usr/local/apr/lib&lt;/em&gt; 目录下&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;安装 lib_mysqludf_json&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;lib_mysqludf_json(&lt;a href=&quot;https://github.com/mysqludf/lib_mysqludf_json&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;https://github.com/mysqludf/lib_mysqludf_json&lt;/a&gt;)&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;em&gt;lib_mysqludf_json&lt;/em&gt; 是一个支持json数据格式的UDF函数,它提供给 mysql 与 redis 进行数据交互.它的下载安装过程如下:&lt;/p&gt;
&lt;/blockquote&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;sudo git &lt;span class=&quot;built_in&quot;&gt;clone&lt;/span&gt; https://github.com/mysqludf/lib_mysqludf_json.git&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;cp lib_mysqludf_json.so /usr/lib/mysql/plugin&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;ul&gt;
&lt;li&gt;安装 hiredis&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;hiredis(&lt;a href=&quot;https://github.com/redis/hiredis&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;https://github.com/redis/hiredis&lt;/a&gt;)&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;em&gt;hiredis&lt;/em&gt; 是redis的一个调用接口,它提供了一些简单的redis的操作,它 的安装和下载过程如下:&lt;/p&gt;
&lt;/blockquote&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;sudo git &lt;span class=&quot;built_in&quot;&gt;clone&lt;/span&gt; https://github.com/redis/hiredis.git&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;built_in&quot;&gt;cd&lt;/span&gt; hiredis&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;make&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;sudo make install&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;完成编译后将会创建 &lt;em&gt;/usr/local/include/hiredis/&lt;/em&gt; 和 &lt;em&gt;/usr/local/lib/libhiredis.so&lt;/em&gt; 文件&lt;/p&gt;
&lt;p&gt;将生成的 &lt;em&gt;/usr/local/lib/libhiredis.so.0.13&lt;/em&gt; 文件拷备到 &lt;em&gt;/lib/libhiredis.so.0.13&lt;/em&gt; 下&lt;/p&gt;
&lt;p&gt;//貌似不用将生成的 &lt;em&gt;libhiredis.so&lt;/em&gt; 拷贝到 &lt;em&gt;/usr/lib/mysql/plugins&lt;/em&gt; 下,&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;最后安装 mysql2redis&lt;/li&gt;
&lt;/ul&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;sudo git &lt;span class=&quot;built_in&quot;&gt;clone&lt;/span&gt; https://github.com/dawnbreaks/mysql2redis.git&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;built_in&quot;&gt;cd&lt;/span&gt; mysql2redis&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;make&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;sudo make install&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;最后 make install 会将当前目录下生成的 &lt;em&gt;lib_mysqludf_redis_v2.so&lt;/em&gt; 文件复制到 &lt;em&gt;mysqlplugin_dir&lt;/em&gt; 下&lt;/p&gt;
&lt;p&gt;注:另有一个类似库 &lt;a href=&quot;https://github.com/aborn/mysql2redis.git&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;https://github.com/aborn/mysql2redis.git&lt;/a&gt;&lt;/p&gt;
&lt;h4 id=&quot;下载完-mysql2redis-后-记住修改以下几步&quot;&gt;&lt;a href=&quot;#下载完-mysql2redis-后-记住修改以下几步&quot; class=&quot;headerlink&quot; title=&quot;下载完 mysql2redis 后,记住修改以下几步:&quot;&gt;&lt;/a&gt;下载完 &lt;em&gt;mysql2redis&lt;/em&gt; 后,记住修改以下几步:&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;p&gt;修改 Makefile 将默认 &lt;em&gt;/usr/lib64/mysql/plugin&lt;/em&gt; 修改为当前系统的 &lt;em&gt;/usr/lib/mysql/plugin&lt;/em&gt; (修改PLUGINDIR参数  添加mysql的include 如-I/usr/include/mysql)并重新编译安装&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;编译 make 的时候提示错误,貌似没有找到 &lt;em&gt;my_global.h&lt;/em&gt; 文件&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;/bin/sh: &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;: /usr/bin/mysql_config: not found&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;In file included from lib_mysqludf_redis.c:&lt;span class=&quot;number&quot;&gt;5&lt;/span&gt;:&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;:&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;lib_mysqludf_redis.h:&lt;span class=&quot;number&quot;&gt;21&lt;/span&gt;:&lt;span class=&quot;number&quot;&gt;23&lt;/span&gt;: fatal error: my_global.h: No such file or directory&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;#include &amp;lt;my_global.h&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;发现没有Makefile里指定的 &lt;em&gt;/usr/include/mysql&lt;/em&gt; 文件,查看之前的服务器,发现存在并且里边包含有 &lt;em&gt;my_global.h&lt;/em&gt; 文件,于是猜是这里出了问题,一番搜索之后,提示需要安装mysql开发包&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;sudo apt-get install libmysqlclient-dev&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;发现已创建此目录,重新编译没有提示上面的错误&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;错误 &lt;em&gt;lib_mysqludf_redis.c:271:13: error: format not a string literaland no format arguments&lt;/em&gt; &lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;将 lib_mysqludf_redis.c [Line:271]行的 fprintf(pFile, buf) 改为 fputs(buf, pFile),或注释掉 [Line:46]  /&lt;em&gt;debug_print(buf);&lt;/em&gt;/&lt;/p&gt;
&lt;h3 id=&quot;MYSQL-的配制&quot;&gt;&lt;a href=&quot;#MYSQL-的配制&quot; class=&quot;headerlink&quot; title=&quot;MYSQL 的配制&quot;&gt;&lt;/a&gt;MYSQL 的配制&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;对于 lib_mysqludf_json 在 mysql 中执行以下sql命令:&lt;/li&gt;
&lt;/ul&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;DROP FUNCTION IF EXISTS json_members;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;DROP FUNCTION IF EXISTS json_array;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;DROP FUNCTION IF EXISTS json_object;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;DROP FUNCTION IF EXISTS json_values;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;CREATE FUNCTION json_members RETURNS STRING SONAME &lt;span class=&quot;string&quot;&gt;&#39;lib_mysqludf_json.so&#39;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;CREATE FUNCTION json_array RETURNS STRING SONAME &lt;span class=&quot;string&quot;&gt;&#39;lib_mysqludf_json.so&#39;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;CREATE FUNCTION json_object RETURNS STRING SONAME &lt;span class=&quot;string&quot;&gt;&#39;lib_mysqludf_json.so&#39;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;CREATE FUNCTION json_values RETURNS STRING SONAME &lt;span class=&quot;string&quot;&gt;&#39;lib_mysqludf_json.so&#39;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;ul&gt;
&lt;li&gt;json_array json_object&lt;/li&gt;
&lt;/ul&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;mysql&amp;gt; CREATE FUNCTION json_array RETURNS STRING SONAME &lt;span class=&quot;string&quot;&gt;&#39;lib_mysqludf_json.so&#39;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;ERROR &lt;span class=&quot;number&quot;&gt;1585&lt;/span&gt; (HY000): This &lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&#39;json_array&#39;&lt;/span&gt; has the same name as a native &lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;注:自Mysql5.7开始已有内建 json_array json_object 方法,虽然用法不一样,但是可以稍作调整替换这里的同名方法–所以 &lt;em&gt;lib_mysqludf_json&lt;/em&gt; 该库可以不用了&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;对于 mysql2redis 在 mysql 中执行以下 sql 命令:&lt;/li&gt;
&lt;/ul&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;DROP FUNCTION IF EXISTS redis_servers_&lt;span class=&quot;built_in&quot;&gt;set&lt;/span&gt;_v2;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;DROP FUNCTION IF EXISTS redis_&lt;span class=&quot;built_in&quot;&gt;command&lt;/span&gt;_v2;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;DROP FUNCTION IF EXISTS free_resources;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;CREATE FUNCTION redis_servers_&lt;span class=&quot;built_in&quot;&gt;set&lt;/span&gt;_v2 RETURNS int SONAME &lt;span class=&quot;string&quot;&gt;&quot;lib_mysqludf_redis_v2.so&quot;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;CREATE FUNCTION redis_&lt;span class=&quot;built_in&quot;&gt;command&lt;/span&gt;_v2 RETURNS int SONAME &lt;span class=&quot;string&quot;&gt;&quot;lib_mysqludf_redis_v2.so&quot;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;CREATE FUNCTION free_resources RETURNS int SONAME &lt;span class=&quot;string&quot;&gt;&quot;lib_mysqludf_redis_v2.so&quot;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;在安装过程中遇到的问题,请参照 &lt;em&gt;mysql2redis.md&lt;/em&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;创建 &lt;em&gt;redis_servers_set_v2&lt;/em&gt; FUNCTION 出现如下错误 &lt;em&gt;‘lib_mysqludf_redis_v2.so’ (errno: 2 libapr-1.so.0: cannot open shared object file&lt;/em&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;mysql&amp;gt; CREATE FUNCTION redis_servers_&lt;span class=&quot;built_in&quot;&gt;set&lt;/span&gt;_v2 RETURNS int SONAME &lt;span class=&quot;string&quot;&gt;&quot;lib_mysqludf_redis_v2.so&quot;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;ERROR &lt;span class=&quot;number&quot;&gt;1126&lt;/span&gt; (HY000): Can&lt;span class=&quot;string&quot;&gt;&#39;t open shared library &#39;&lt;/span&gt;lib_mysqludf_redis_v2.so&lt;span class=&quot;string&quot;&gt;&#39; (errno: 2 libapr-1.so.0: cannot open shared object file: No such file or directory)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;mysql&amp;gt; CREATE FUNCTION redis_servers_set_v2 RETURNS int SONAME &quot;lib_mysqludf_redis_v2.so&quot;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;ERROR 1126 (HY000): Can&#39;&lt;/span&gt;t open shared library &lt;span class=&quot;string&quot;&gt;&#39;lib_mysqludf_redis_v2.so&#39;&lt;/span&gt; (errno: &lt;span class=&quot;number&quot;&gt;11&lt;/span&gt; libaprutil-&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;.so.&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;: cannot open shared object file: No such file or directory)&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;查看 &lt;em&gt;libapr-1.so.0&lt;/em&gt; 和 &lt;em&gt;libaprutil-1.so.0&lt;/em&gt; 均在 &lt;em&gt;/usr/local/apr/lib/&lt;/em&gt; 下&lt;/p&gt;
&lt;p&gt;查看已安装好的 Ali 服务器&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;Thu May &lt;span class=&quot;number&quot;&gt;19&lt;/span&gt; &lt;span class=&quot;number&quot;&gt;10&lt;/span&gt;:&lt;span class=&quot;number&quot;&gt;54&lt;/span&gt;:&lt;span class=&quot;number&quot;&gt;21&lt;/span&gt; yzhang@coam:/usr/lib/x86_64-linux-gnu$ sudo find / -name libapr-&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;.so.&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;/usr/&lt;span class=&quot;built_in&quot;&gt;local&lt;/span&gt;/apr/lib/libapr-&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;.so.&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;/usr/lib/x86_64-linux-gnu/libapr-&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;.so.&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;...&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;可以看到 &lt;em&gt;libapr-1.so.0&lt;/em&gt; 和 &lt;em&gt;libaprutil-1.so.0&lt;/em&gt; 都已复制到系统的 &lt;em&gt;/usr/lib/x86_64-linux-gnu/&lt;/em&gt; 路径下,可能是当前服务器 &lt;em&gt;Vultr&lt;/em&gt; 系统安装有差异,于是手动复制这两个文件,问题解决&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;cp /usr/&lt;span class=&quot;built_in&quot;&gt;local&lt;/span&gt;/apr/lib/libapr-&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;.so.&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt; /usr/lib/x86_64-linux-gnu/libapr-&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;.so.&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;cp /usr/&lt;span class=&quot;built_in&quot;&gt;local&lt;/span&gt;/apr/lib/libaprutil-&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;.so.&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt; /usr/lib/x86_64-linux-gnu/libaprutil-&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;.so.&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;ul&gt;
&lt;li&gt;最后登陆 Mysql 命令行测试 redis udf&lt;/li&gt;
&lt;/ul&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# 设定连接 Redis 数据库&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;select redis_servers_&lt;span class=&quot;built_in&quot;&gt;set&lt;/span&gt;_v2(&lt;span class=&quot;string&quot;&gt;&quot;127.0.0.1&quot;&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;6379&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;select redis_&lt;span class=&quot;built_in&quot;&gt;command&lt;/span&gt;_v2(&lt;span class=&quot;string&quot;&gt;&quot;HSET&quot;&lt;/span&gt;,&lt;span class=&quot;string&quot;&gt;&quot;AccountInfoList&quot;&lt;/span&gt;,&lt;span class=&quot;string&quot;&gt;&quot;C-1&quot;&lt;/span&gt;,json_object(&lt;span class=&quot;string&quot;&gt;&quot;C-1&quot;&lt;/span&gt;, &lt;span class=&quot;string&quot;&gt;&quot;C-1&quot;&lt;/span&gt;)); // 测试连接&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;select redis_&lt;span class=&quot;built_in&quot;&gt;command&lt;/span&gt;_v2(&lt;span class=&quot;string&quot;&gt;&quot;hset&quot;&lt;/span&gt;,&lt;span class=&quot;string&quot;&gt;&quot;hkey&quot;&lt;/span&gt;,&lt;span class=&quot;string&quot;&gt;&quot;hfield&quot;&lt;/span&gt;,json_object(json_members(&lt;span class=&quot;string&quot;&gt;&quot;op&quot;&lt;/span&gt;,&lt;span class=&quot;string&quot;&gt;&quot;insert&quot;&lt;/span&gt;,&lt;span class=&quot;string&quot;&gt;&quot;value&quot;&lt;/span&gt;,&lt;span class=&quot;string&quot;&gt;&quot;valuettt&quot;&lt;/span&gt;))); // 测试 json_object 方法&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;select free_resources();&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;hr&gt;
&lt;h3 id=&quot;错误记录&quot;&gt;&lt;a href=&quot;#错误记录&quot; class=&quot;headerlink&quot; title=&quot;错误记录&quot;&gt;&lt;/a&gt;错误记录&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;错误 &lt;em&gt;lib_mysqludf_json.so: wrong ELF class: ELFCLASS32)&lt;/em&gt; 产生原因是: lib_mysqludf_json.so 是32位的文件-解决方法:重新编译&lt;/li&gt;
&lt;/ul&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;built_in&quot;&gt;cd&lt;/span&gt; /RunSoft/lib_mysqludf_json&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;sudo gcc -Wall -m64 -I/usr/include/mysql -I. -shared lib_mysqludf_json.c -o ./lib_mysqludf_json.so &lt;span class=&quot;operator&quot;&gt;-f&lt;/span&gt;PIC&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;注意:-I 为 mysql 的 include 目录&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;错误 &lt;em&gt;libhiredis.so.0.10: cannot open shared object file&lt;/em&gt; 执行以下命令:&lt;/li&gt;
&lt;/ul&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;sudo cp /usr/&lt;span class=&quot;built_in&quot;&gt;local&lt;/span&gt;/lib/libhiredis.so.&lt;span class=&quot;number&quot;&gt;0.10&lt;/span&gt; /lib&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;ul&gt;
&lt;li&gt;Mysql SQL 创建 json_members 方法的时候,提示如下错误:&lt;/li&gt;
&lt;/ul&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;mysql&amp;gt; CREATE FUNCTION json_members RETURNS STRING SONAME &lt;span class=&quot;string&quot;&gt;&#39;lib_mysqludf_json.so&#39;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;ERROR &lt;span class=&quot;number&quot;&gt;1126&lt;/span&gt; (HY000): Can&lt;span class=&quot;string&quot;&gt;&#39;t open shared library &#39;&lt;/span&gt;lib_mysqludf_json.so&lt;span class=&quot;string&quot;&gt;&#39; (errno: 2 /usr/local/mysql/usr/lib/mysql/plugin/lib_mysqludf_json.so: cannot open shared object file: No such file or directory)&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;检查发现 &lt;em&gt;/usr/lib/mysql/plugin/lib_mysqludf_json.so&lt;/em&gt; 文件存在,可能是安装 Mysql 配置的 plugin-dir 有问题 &lt;em&gt;/usr/local/mysql/&lt;/em&gt;&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;Sat May &lt;span class=&quot;number&quot;&gt;14&lt;/span&gt; &lt;span class=&quot;number&quot;&gt;18&lt;/span&gt;:&lt;span class=&quot;number&quot;&gt;02&lt;/span&gt;:&lt;span class=&quot;number&quot;&gt;00&lt;/span&gt; yzhang@coam:~/RunSoft/mysql2redis$ sudo ps -ef | grep mysql&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;root       &lt;span class=&quot;number&quot;&gt;958&lt;/span&gt;     &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;  &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt; May13 ?        &lt;span class=&quot;number&quot;&gt;00&lt;/span&gt;:&lt;span class=&quot;number&quot;&gt;00&lt;/span&gt;:&lt;span class=&quot;number&quot;&gt;00&lt;/span&gt; /bin/sh /usr/&lt;span class=&quot;built_in&quot;&gt;local&lt;/span&gt;/mysql/bin/mysqld_safe --datadir=/data/home/data/mysq  --pid-file=/data/home/data/mysql/coam.pid&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;mysql     &lt;span class=&quot;number&quot;&gt;1204&lt;/span&gt;   &lt;span class=&quot;number&quot;&gt;958&lt;/span&gt;  &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt; May13 ?        &lt;span class=&quot;number&quot;&gt;00&lt;/span&gt;:&lt;span class=&quot;number&quot;&gt;00&lt;/span&gt;:&lt;span class=&quot;number&quot;&gt;19&lt;/span&gt; /usr/&lt;span class=&quot;built_in&quot;&gt;local&lt;/span&gt;/mysql/bin/mysqld --basedir=/usr/&lt;span class=&quot;built_in&quot;&gt;local&lt;/span&gt;/mysql --datadir=/data/home/data/mysql --plugin-dir=/usr/&lt;span class=&quot;built_in&quot;&gt;local&lt;/span&gt;/mysql//usr/lib/mysql/plugin --user=mysql --log-error=/var/&lt;span class=&quot;built_in&quot;&gt;log&lt;/span&gt;/mysql/error.log --pid-file=/data/home/data/mysql/coam.pid --socket=/tmp/mysql/mysql.sock --port=&lt;span class=&quot;number&quot;&gt;3306&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;yzhang    &lt;span class=&quot;number&quot;&gt;8559&lt;/span&gt; &lt;span class=&quot;number&quot;&gt;24523&lt;/span&gt;  &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt; &lt;span class=&quot;number&quot;&gt;18&lt;/span&gt;:&lt;span class=&quot;number&quot;&gt;05&lt;/span&gt; pts/&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;    &lt;span class=&quot;number&quot;&gt;00&lt;/span&gt;:&lt;span class=&quot;number&quot;&gt;00&lt;/span&gt;:&lt;span class=&quot;number&quot;&gt;00&lt;/span&gt; mysql -u zhangyanxi -p&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;yzhang   &lt;span class=&quot;number&quot;&gt;12036&lt;/span&gt; &lt;span class=&quot;number&quot;&gt;29119&lt;/span&gt;  &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt; &lt;span class=&quot;number&quot;&gt;18&lt;/span&gt;:&lt;span class=&quot;number&quot;&gt;12&lt;/span&gt; pts/&lt;span class=&quot;number&quot;&gt;4&lt;/span&gt;    &lt;span class=&quot;number&quot;&gt;00&lt;/span&gt;:&lt;span class=&quot;number&quot;&gt;00&lt;/span&gt;:&lt;span class=&quot;number&quot;&gt;00&lt;/span&gt; grep --color=auto mysql&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;可以看见 &lt;em&gt;–plugin-dir=/usr/local/mysql//usr/lib/mysql/plugin&lt;/em&gt; 这里配置有问题&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;我是 Mysql 源码编译安装,并且在 cmake 中设定参数 &lt;em&gt;-DINSTALL_PLUGINDIR=/usr/lib/mysql/plugin \&lt;/em&gt; 也没有问题.修改 /etc/mysql/my.cnf 添加以下内容&lt;/li&gt;
&lt;/ul&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;[mysqld]&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;plugin_dir=/usr/lib/mysql/plugin&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;重启 mysql 发现问题已修正&lt;/p&gt;
&lt;h3 id=&quot;参考列表&quot;&gt;&lt;a href=&quot;#参考列表&quot; class=&quot;headerlink&quot; title=&quot;参考列表&quot;&gt;&lt;/a&gt;参考列表&lt;/h3&gt;&lt;p&gt;&lt;a href=&quot;http://blog.popkit.org/2014/02/21/how-to-install-mysql2redis/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;怎样安装 mysql2redis&lt;/a&gt;&lt;br&gt;&lt;a href=&quot;https://github.com/aborn/popkit/blob/master/doc/mysql2redis.md&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;疑难杂症&lt;/a&gt;&lt;br&gt;&lt;a href=&quot;https://github.com/dawnbreaks/mysql2redis&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;https://github.com/dawnbreaks/mysql2redis&lt;/a&gt;&lt;br&gt;&lt;a href=&quot;https://github.com/jackeylu/mysql2redis&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;https://github.com/jackeylu/mysql2redis&lt;/a&gt;&lt;br&gt;&lt;a href=&quot;http://www.mysqludf.org/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;http://www.mysqludf.org/&lt;/a&gt;&lt;br&gt;&lt;a href=&quot;http://avnpc.com/pages/mysql-replication-to-redis-by-gearman&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;通过Gearman实现MySQL到Redis的数据复制&lt;/a&gt;&lt;br&gt;&lt;a href=&quot;http://www.longlong.asia/2015/09/19/mysql-queue-trigger.html&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;使用MySQL触发器同步数据到Memcached&lt;/a&gt;&lt;/p&gt;
&lt;hr&gt;
</content>
    
    <summary type="html">
    
      &lt;h3 id=&quot;Ubuntu-安装-Mysql2redis-及错误日记&quot;&gt;&lt;a href=&quot;#Ubuntu-安装-Mysql2redis-及错误日记&quot; class=&quot;headerlink&quot; title=&quot;Ubuntu 安装 Mysql2redis 及错误日记&quot;&gt;&lt;/a&gt;Ubuntu 安装 Mysql2redis 及错误日记&lt;/h3&gt;
    
    </summary>
    
    
  </entry>
  
  <entry>
    <title>MysqlNote</title>
    <link href="https://coam.co/2016/05/13/Mysql/MysqlNote/"/>
    <id>https://coam.co/2016/05/13/Mysql/MysqlNote/</id>
    <published>2016-05-13T01:13:31.000Z</published>
    <updated>2016-05-18T13:19:29.479Z</updated>
    
    <content type="html">&lt;a id=&quot;more&quot;&gt;&lt;/a&gt;
&lt;ul&gt;
&lt;li&gt;刚安装完 php5-fpm mysql 使用 phpMyAdmin 登陆提示如下错误&lt;/li&gt;
&lt;/ul&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;#2002 - Can&#39;t connect to local MySQL server through socket &#39;/var/run/mysqld/mysqld.sock&#39; (2) — The server is not responding (or the local server&#39;s socket is not correctly configured).&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;ul&gt;
&lt;li&gt;因为使用源码编译安装的 mysql 5.7 的默认配置文件 &lt;em&gt;/etc/mysql/my.cnf&lt;/em&gt; 没有 [client] 这一段配置.而默认的 mysql sock 位置为 &lt;em&gt;/var/run/mysqld/mysqld.sock&lt;/em&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;ol&gt;
&lt;li&gt;首先找到所有的 socket 文件:&lt;/li&gt;
&lt;/ol&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;yzhang@coam:~$ sudo find / -type s&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;/tmp/mongodb-&lt;span class=&quot;number&quot;&gt;27017&lt;/span&gt;.sock&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;/tmp/mysql/mysql.sock&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;/run/fail2ban/fail2ban.sock&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;...&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;所以手动 &lt;em&gt;/etc/mysql/my.cnf&lt;/em&gt; 添加这一行:&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;[client]&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;socket=/tmp/mysql/mysql.sock &amp;lt;= this path should be also same as is[mysqld]&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;ul&gt;
&lt;li&gt;重启 mysql&lt;/li&gt;
&lt;/ul&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;sudo service mysql restart&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;ul&gt;
&lt;li&gt;最简单的方法是建立软连接 &lt;em&gt;/tmp/mysql/mysql.sock =&amp;gt; /var/run/mysqld/mysqld.sock&lt;/em&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;sudo ln &lt;span class=&quot;operator&quot;&gt;-s&lt;/span&gt; /tmp/mysql/mysql.sock /var/run/mysqld/mysqld.sock&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;ul&gt;
&lt;li&gt;据说以下也可以解决此问题的一个途径,记录一下&lt;/li&gt;
&lt;/ul&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;/usr/bin/mysql -u root -p -S /home/mysql/mysql.sock&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h3 id=&quot;参考列表&quot;&gt;&lt;a href=&quot;#参考列表&quot; class=&quot;headerlink&quot; title=&quot;参考列表&quot;&gt;&lt;/a&gt;参考列表&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;使用 phpMyAdmin 登陆 Mysql,用户名密码都没错,但是一直提示如下错误 &lt;em&gt;error: ‘Can’t connect to local MySQL server through socket ‘/var/run/mysqld/mysqld.sock’(2)’&lt;/em&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;a href=&quot;http://stackoverflow.com/questions/11990708/error-cant-connect-to-local-mysql-server-through-socket-var-run-mysqld-mysq&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;error: ‘Can’t connect to local MySQL server through socket ‘/var/run/mysqld/mysqld.sock’ (2)’&lt;/a&gt;&lt;br&gt;&lt;a href=&quot;http://serverfault.com/questions/735581/cannot-connect-to-mysql-server-error-2002-hy000-cant-connect-to-local-mysql&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;Cannot connect to mysql server ERROR 2002 (HY000): Can’t connect to local MySQL server through socket ‘/var/lib/mysql/mysql.sock’ (2)&lt;/a&gt;&lt;br&gt;&lt;a href=&quot;http://stackoverflow.com/questions/5376427/cant-connect-to-local-mysql-server-through-socket-var-mysql-mysql-sock-38&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;Can’t connect to local MySQL server through socket ‘/var/mysql/mysql.sock’ (38)&lt;/a&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;最根本的原因是 &lt;em&gt;/etc/php5/fpm/php.ini&lt;/em&gt; 中的三个配置段 {[Pdo_mysql]pdo_mysql.default_socket = |[MySQL]mysql.default_socket = |[MySQLi]mysqli.default_socket = |} 默认留空,也就是为默认的 &lt;em&gt;/var/run/mysqld/mysqld.sock&lt;/em&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;使用 vi 搜索 &lt;em&gt;.default_socket&lt;/em&gt; 将其改为 {[Pdo_mysql]pdo_mysql.default_socket = /tmp/mysql/mysql.sock|[MySQL]mysql.default_socket = /tmp/mysql/mysql.sock|[MySQLi]mysqli.default_socket = /tmp/mysql/mysql.sock|}&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;vi /etc/php5/fpm/php.ini&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;[P&lt;span class=&quot;keyword&quot;&gt;do&lt;/span&gt;_mysql]&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;...&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;pdo_mysql.default_socket = /tmp/mysql/mysql.sock&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;...&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;[MySQL]&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;...&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;mysql.default_socket = /tmp/mysql/mysql.sock&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;...&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;[MySQLi]&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;...&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;mysqli.default_socket = /tmp/mysql/mysql.sock&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;...&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;ul&gt;
&lt;li&gt;重启 php5-fpm 生效&lt;/li&gt;
&lt;/ul&gt;
&lt;blockquote&gt;
&lt;p&gt;注 没有修改 &lt;em&gt;/etc/php5/cli/php.ini&lt;/em&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;hr&gt;
</content>
    
    <summary type="html">
    
      &lt;a id=&quot;more&quot;&gt;&lt;/a&gt;
&lt;ul&gt;
&lt;li&gt;刚安装完 php5-fpm mysql 使用 phpMyAdmin 登陆提示如下错误&lt;/li&gt;
&lt;/ul&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter
    
    </summary>
    
    
  </entry>
  
  <entry>
    <title>MysqlSql</title>
    <link href="https://coam.co/2016/05/13/Mysql/MysqlSql/"/>
    <id>https://coam.co/2016/05/13/Mysql/MysqlSql/</id>
    <published>2016-05-13T01:03:31.000Z</published>
    <updated>2016-05-19T02:35:14.193Z</updated>
    
    <content type="html">&lt;a id=&quot;more&quot;&gt;&lt;/a&gt;
&lt;h3 id=&quot;数据库操作相关&quot;&gt;&lt;a href=&quot;#数据库操作相关&quot; class=&quot;headerlink&quot; title=&quot;数据库操作相关&quot;&gt;&lt;/a&gt;数据库操作相关&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;创建数据库&lt;/li&gt;
&lt;/ul&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;mysql&amp;gt; CREATE DATABASE CoamDatabase DEFAULT CHARACTER SET utf8 DEFAULT COLLATE utf8_general_ci;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;ul&gt;
&lt;li&gt;删除数据库&lt;/li&gt;
&lt;/ul&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;mysql&amp;gt; DROP DATABASE CoamDatabase;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;&lt;a href=&quot;https://dev.mysql.com/doc/refman/5.7/en/charset-applications.html&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;11.1.6 Configuring the Character Set and Collation for Applications&lt;/a&gt;&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id=&quot;mysqldump&quot;&gt;&lt;a href=&quot;#mysqldump&quot; class=&quot;headerlink&quot; title=&quot;mysqldump&quot;&gt;&lt;/a&gt;mysqldump&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;导出数据库:&lt;/li&gt;
&lt;/ul&gt;
&lt;blockquote&gt;
&lt;p&gt;mysqldump -u 用户名 -p 数据库名 &amp;gt; 导出的文件名&lt;/p&gt;
&lt;/blockquote&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;mysqldump -u root -p CoamDatabase &amp;gt; CoamDatabase.sql   (输入后会让你输入进入MySQL的密码)&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;(如果导出单张表的话在数据库名后面输入表名即可)&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;同时备份多个数据库&lt;/li&gt;
&lt;/ul&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;mysqldump -h hostname -u username -p password --databases db_name1 db_name2 db_namen &amp;gt;backup.sql&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;ul&gt;
&lt;li&gt;只备份数据库的结构,不备份数据&lt;/li&gt;
&lt;/ul&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;mysqldump -h hostname -u username -p password --no-data --databases db_name1 db_name2 db_namen &amp;gt;backup.sql&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;ul&gt;
&lt;li&gt;备份所有的数据库&lt;/li&gt;
&lt;/ul&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;mysqldump -h hostname -u username -p password --all-databases &amp;gt;backup.sql&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;// 其它&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;mysqldump —opt —skip-comments —extended-insert=&lt;span class=&quot;literal&quot;&gt;false&lt;/span&gt; -uroot -p1234 inotseeyou_com &amp;gt; inotseeyou_com.sql&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;ul&gt;
&lt;li&gt;导入数据库&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;首先创建相应的 Database&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;CREATE DATABASE CoamDatabase DEFAULT CHARACTER SET utf8 DEFAULT COLLATE utf8_general_ci;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;use CoamDatabase;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;built_in&quot;&gt;source&lt;/span&gt; CoamDatabase.sql;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;&lt;a href=&quot;http://dev.mysql.com/doc/refman/5.7/en/mysqldump.html&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;mysqldump.html&lt;/a&gt; &lt;/p&gt;
&lt;hr&gt;
&lt;h3 id=&quot;用户相关&quot;&gt;&lt;a href=&quot;#用户相关&quot; class=&quot;headerlink&quot; title=&quot;用户相关&quot;&gt;&lt;/a&gt;用户相关&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;查看所有用户&lt;/li&gt;
&lt;/ul&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;mysql&amp;gt; SELECT User, Host, Password FROM mysql.user;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;ul&gt;
&lt;li&gt;添加新用户 - 以下方式适用于 5.7 以前的版本&lt;/li&gt;
&lt;/ul&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;mysql&amp;gt; INSERT INTO mysql.user (User,Host,Password) VALUES(&lt;span class=&quot;string&quot;&gt;&#39;demouser&#39;&lt;/span&gt;,&lt;span class=&quot;string&quot;&gt;&#39;localhost&#39;&lt;/span&gt;,PASSWORD(&lt;span class=&quot;string&quot;&gt;&#39;demopassword&#39;&lt;/span&gt;));&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;ul&gt;
&lt;li&gt;添加新用户 - 以下方式适用于 5.7 以后的版本&lt;/li&gt;
&lt;/ul&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;mysql&amp;gt; GRANT USAGE ON *.* TO &lt;span class=&quot;string&quot;&gt;&#39;zhangyanxi&#39;&lt;/span&gt;@&lt;span class=&quot;string&quot;&gt;&#39;localhost&#39;&lt;/span&gt; IDENTIFIED BY &lt;span class=&quot;string&quot;&gt;&#39;yanxi312&#39;&lt;/span&gt; WITH GRANT OPTION;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;mysql&amp;gt; GRANT ALL ON *.* TO &lt;span class=&quot;string&quot;&gt;&#39;zhangyanxi&#39;&lt;/span&gt;@&lt;span class=&quot;string&quot;&gt;&#39;localhost&#39;&lt;/span&gt;;        ======&amp;gt; 给用户授权&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;mysql&amp;gt; flush privileges;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;ul&gt;
&lt;li&gt;给用户授权相关&lt;/li&gt;
&lt;/ul&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;mysql&amp;gt; GRANT ALL PRIVILEGES ON demodb.* to demouser@localhost;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;GRANT SELECT, INSERT ON *.* TO &lt;span class=&quot;string&quot;&gt;&#39;zhangyanxi&#39;&lt;/span&gt;@&lt;span class=&quot;string&quot;&gt;&#39;localhost&#39;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;GRANT ALL ON *.* TO &lt;span class=&quot;string&quot;&gt;&#39;zhangyanxi&#39;&lt;/span&gt;@&lt;span class=&quot;string&quot;&gt;&#39;%&#39;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;ul&gt;
&lt;li&gt;检查用户授权&lt;/li&gt;
&lt;/ul&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;mysql&amp;gt; SHOW GRANTS FOR &lt;span class=&quot;string&quot;&gt;&#39;demouser&#39;&lt;/span&gt;@&lt;span class=&quot;string&quot;&gt;&#39;localhost&#39;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;hr&gt;
</content>
    
    <summary type="html">
    
      &lt;a id=&quot;more&quot;&gt;&lt;/a&gt;
&lt;h3 id=&quot;数据库操作相关&quot;&gt;&lt;a href=&quot;#数据库操作相关&quot; class=&quot;headerlink&quot; title=&quot;数据库操作相关&quot;&gt;&lt;/a&gt;数据库操作相关&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;创建数据库&lt;/li&gt;
&lt;/ul&gt;
&lt;figure c
    
    </summary>
    
    
  </entry>
  
  <entry>
    <title>RedisNote</title>
    <link href="https://coam.co/2016/05/10/Redis/RedisNote/"/>
    <id>https://coam.co/2016/05/10/Redis/RedisNote/</id>
    <published>2016-05-10T13:16:31.000Z</published>
    <updated>2016-05-16T14:23:33.861Z</updated>
    
    <content type="html">&lt;a id=&quot;more&quot;&gt;&lt;/a&gt;
&lt;p&gt;&lt;a href=&quot;http://ifeve.com/redis-replication/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;《Redis官方文档》主从复制&lt;/a&gt;&lt;br&gt;&lt;a href=&quot;http://gsandow.com/redis-replication/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;redis 主从同步原理及参数&lt;/a&gt;&lt;br&gt;&lt;a href=&quot;https://www.zhihu.com/question/21419897&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;Redis集群方案应该怎么做?&lt;/a&gt;&lt;/p&gt;
</content>
    
    <summary type="html">
    
      &lt;a id=&quot;more&quot;&gt;&lt;/a&gt;
&lt;p&gt;&lt;a href=&quot;http://ifeve.com/redis-replication/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;《Redis官方文档》主从复制&lt;/a&gt;&lt;br&gt;&lt;a href=&quot;http://gsa
    
    </summary>
    
    
  </entry>
  
  <entry>
    <title>MongoNotes</title>
    <link href="https://coam.co/2016/05/10/Mongo/MongoNotes/"/>
    <id>https://coam.co/2016/05/10/Mongo/MongoNotes/</id>
    <published>2016-05-10T13:13:31.000Z</published>
    <updated>2016-05-18T13:19:29.474Z</updated>
    
    <content type="html">&lt;a id=&quot;more&quot;&gt;&lt;/a&gt;
&lt;p&gt;&lt;a href=&quot;https://jockchou.gitbooks.io/getting-started-with-mongodb/content/index.html&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;《MongoDB入门指南》&lt;/a&gt;&lt;/p&gt;
&lt;h3 id=&quot;mongodb-基本命令&quot;&gt;&lt;a href=&quot;#mongodb-基本命令&quot; class=&quot;headerlink&quot; title=&quot;mongodb 基本命令&quot;&gt;&lt;/a&gt;mongodb 基本命令&lt;/h3&gt;&lt;p&gt;进入 mongo: mongo&lt;br&gt;启动服务:net start MongoDB&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;查看数据库:&lt;/li&gt;
&lt;/ol&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;show dbs&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;ol&gt;
&lt;li&gt;查看所有集合:&lt;/li&gt;
&lt;/ol&gt;
&lt;pre&gt;&lt;code class=&quot;bash&quot;&gt;show collections;
&lt;/code&gt;&lt;/pre&gt;
&lt;ol&gt;
&lt;li&gt;查看数据库服务器的状态:&lt;/li&gt;
&lt;/ol&gt;
&lt;pre&gt;&lt;code class=&quot;bash&quot;&gt;db.serverStatus();
&lt;/code&gt;&lt;/pre&gt;
&lt;ol&gt;
&lt;li&gt;查询指定数据库统计信息:&lt;/li&gt;
&lt;/ol&gt;
&lt;pre&gt;&lt;code class=&quot;bash&quot;&gt;use user;
db.stats();
&lt;/code&gt;&lt;/pre&gt;
&lt;ol&gt;
&lt;li&gt;查询指定数据库包含的集合名称列表&lt;/li&gt;
&lt;/ol&gt;
&lt;pre&gt;&lt;code class=&quot;bash&quot;&gt;db.getCollectionNames();
&lt;/code&gt;&lt;/pre&gt;
&lt;ol&gt;
&lt;li&gt;删除数据库&lt;/li&gt;
&lt;/ol&gt;
&lt;pre&gt;&lt;code class=&quot;bash&quot;&gt;db.dropDatabse();
&lt;/code&gt;&lt;/pre&gt;
&lt;ol&gt;
&lt;li&gt;创建集合&lt;/li&gt;
&lt;/ol&gt;
&lt;pre&gt;&lt;code class=&quot;bash&quot;&gt;db.createCollection(name, {size:..., capped:..., max:...})
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;MongoDB 支持 Capped Collection,一种固定大小的集合,当集合的大小达到指定大小时,新数据会覆盖老数据.&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;删除集合:&lt;/li&gt;
&lt;/ol&gt;
&lt;pre&gt;&lt;code class=&quot;bash&quot;&gt;db.collections.drop();
&lt;/code&gt;&lt;/pre&gt;
&lt;ol&gt;
&lt;li&gt;插入更新记录,save方法:&lt;/li&gt;
&lt;/ol&gt;
&lt;pre&gt;&lt;code class=&quot;bash&quot;&gt;db.user.save({‘name’:&lt;span class=&quot;string&quot;&gt;&#39;xiaoming’,&#39;&lt;/span&gt;age’:25});
&lt;/code&gt;&lt;/pre&gt;
&lt;ol&gt;
&lt;li&gt;查询一条记录:&lt;br&gt;参数为查询条件,可选,系统会随机查询获取到满足条件的一条记录(如果存在查询结果数量大于等于1)&lt;/li&gt;
&lt;/ol&gt;
&lt;pre&gt;&lt;code class=&quot;bash&quot;&gt;db.user.findOne({‘name’:&lt;span class=&quot;string&quot;&gt;&#39;xiaoming’})&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;ol&gt;
&lt;li&gt;查询多条记录:不指定条件则查询全部记录&lt;/li&gt;
&lt;/ol&gt;
&lt;pre&gt;&lt;code class=&quot;bash&quot;&gt;db.user.find();
&lt;/code&gt;&lt;/pre&gt;
&lt;ol&gt;
&lt;li&gt;删除记录:&lt;/li&gt;
&lt;/ol&gt;
&lt;pre&gt;&lt;code class=&quot;bash&quot;&gt;db.user.remove({‘name’:&lt;span class=&quot;string&quot;&gt;&#39;xiaomng’});&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;ol&gt;
&lt;li&gt;创建索引:&lt;/li&gt;
&lt;/ol&gt;
&lt;pre&gt;&lt;code class=&quot;bash&quot;&gt;&amp;gt;use user
&amp;gt;db.page.ensureIndex({}’name’:1, ‘age’:-1})
&amp;gt;db.system.index.find()
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ensureIndex 方法参数中,数字1表示升序,-1表示降序.&lt;br&gt;db.system.indexes.find() 可以查询全部索引&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;查询索引:&lt;/li&gt;
&lt;/ol&gt;
&lt;pre&gt;&lt;code class=&quot;bash&quot;&gt;db.page.getIndexes();
&lt;/code&gt;&lt;/pre&gt;
&lt;ol&gt;
&lt;li&gt;删除索引:&lt;/li&gt;
&lt;/ol&gt;
&lt;pre&gt;&lt;code class=&quot;bash&quot;&gt;db.user.dropIndex(name)
db.user.dropIndexes();//删除全部索引
&lt;/code&gt;&lt;/pre&gt;
&lt;ol&gt;
&lt;li&gt;索引重建:&lt;/li&gt;
&lt;/ol&gt;
&lt;pre&gt;&lt;code class=&quot;bash&quot;&gt;db.page.reIndex()
&lt;/code&gt;&lt;/pre&gt;
&lt;ol&gt;
&lt;li&gt;统计集合记录数&lt;/li&gt;
&lt;/ol&gt;
&lt;pre&gt;&lt;code class=&quot;bash&quot;&gt;user user;
db.baseSe.count();
&lt;/code&gt;&lt;/pre&gt;
&lt;ol&gt;
&lt;li&gt;查询并统计结果记录数:&lt;/li&gt;
&lt;/ol&gt;
&lt;pre&gt;&lt;code class=&quot;bash&quot;&gt;use user
db.baseSe.find({‘name’:&lt;span class=&quot;string&quot;&gt;&#39;xiaoming’}).count()&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;先根据条件查询结果,然后再统计结果中的记录数,查询条件也可为空.&lt;/p&gt;
</content>
    
    <summary type="html">
    
      &lt;a id=&quot;more&quot;&gt;&lt;/a&gt;
&lt;p&gt;&lt;a href=&quot;https://jockchou.gitbooks.io/getting-started-with-mongodb/content/index.html&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;《
    
    </summary>
    
    
  </entry>
  
  <entry>
    <title>iptables</title>
    <link href="https://coam.co/2016/05/09/Linux/iptables/"/>
    <id>https://coam.co/2016/05/09/Linux/iptables/</id>
    <published>2016-05-09T13:53:31.000Z</published>
    <updated>2016-05-16T14:12:46.567Z</updated>
    
    <content type="html">&lt;h3 id=&quot;iptables入门教程&quot;&gt;&lt;a href=&quot;#iptables入门教程&quot; class=&quot;headerlink&quot; title=&quot;iptables入门教程&quot;&gt;&lt;/a&gt;iptables入门教程&lt;/h3&gt;&lt;a id=&quot;more&quot;&gt;&lt;/a&gt;
&lt;h3 id=&quot;iptables介绍&quot;&gt;&lt;a href=&quot;#iptables介绍&quot; class=&quot;headerlink&quot; title=&quot;iptables介绍&quot;&gt;&lt;/a&gt;iptables介绍&lt;/h3&gt;&lt;p&gt;linux的包过滤功能,即linux防火墙,它由netfilter 和 iptables 两个组件组成.&lt;/p&gt;
&lt;p&gt;netfilter 组件也称为内核空间,是内核的一部分,由一些信息包过滤表组成,这些表包含内核用来控制信息包过滤处理的规则集.&lt;/p&gt;
&lt;p&gt;iptables 组件是一种工具,也称为用户空间,它使插入. 修改和除去信息包过滤表中的规则变得容易.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;../iptables/1.png&quot; alt=&quot;1.png&quot;&gt;&lt;/p&gt;
&lt;h3 id=&quot;iptables的结构&quot;&gt;&lt;a href=&quot;#iptables的结构&quot; class=&quot;headerlink&quot; title=&quot;iptables的结构&quot;&gt;&lt;/a&gt;iptables的结构&lt;/h3&gt;&lt;p&gt;iptables的结构:&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;iptables -&amp;gt; Tables -&amp;gt; Chains -&amp;gt; Rules&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;简单地讲,tables由chains组成,而chains又由rules组成.iptables 默认有四个表Filter, NAT, Mangle, Raw,其对于的链如下图.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;../iptables/2.jpg&quot; alt=&quot;2.jpg&quot;&gt;&lt;/p&gt;
&lt;p&gt;0x02 iptables工作流程&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;../iptables/3.jpg&quot; alt=&quot;3.jpg&quot;&gt;&lt;/p&gt;
&lt;h3 id=&quot;filter表详解&quot;&gt;&lt;a href=&quot;#filter表详解&quot; class=&quot;headerlink&quot; title=&quot;filter表详解&quot;&gt;&lt;/a&gt;filter表详解&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;p&gt;在iptables中,filter表起过滤数据包的功能,它具有以下三种内建链:&lt;/p&gt;
&lt;p&gt; INPUT链 – 处理来自外部的数据.&lt;br&gt; OUTPUT链 – 处理向外发送的数据.&lt;br&gt; FORWARD链 – 将数据转发到本机的其他网卡设备上. &lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;数据流向场景&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;访问本机:在INPUT链上做过滤&lt;/p&gt;
&lt;p&gt;本机访问外部:在OUTPUT链上做过滤&lt;/p&gt;
&lt;p&gt;通过本机访问其他主机:在FORWARD链上做过滤&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;Iptables基本操作&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;启动&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;iptables:service iptables start&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;关闭&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;iptables:service iptables stop&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;重启&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;iptables:service iptables restart&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;查看iptables状态:&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;service iptables status&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;保存iptables配置:&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;service iptables save&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;Iptables服务配置文件:&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;/etc/sysconfig/iptables-config&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;Iptables规则保存文件:&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;/etc/sysconfig/iptables&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;打开iptables转发:&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;built_in&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&quot;1&quot;&lt;/span&gt;&amp;gt; /proc/sys/net/ipv4/ip_forward&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h3 id=&quot;iptables命令参考&quot;&gt;&lt;a href=&quot;#iptables命令参考&quot; class=&quot;headerlink&quot; title=&quot;iptables命令参考&quot;&gt;&lt;/a&gt;iptables命令参考&lt;/h3&gt;&lt;p&gt;命令:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;iptables [ -t 表名] 命令选项 [链名] [条件匹配] [-j 目标动作或跳转] 
&lt;/code&gt;&lt;/pre&gt;&lt;ol&gt;
&lt;li&gt;表名&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;表名:Filter, NAT, Mangle, Raw&lt;/p&gt;
&lt;p&gt;起包过滤功能的为表Filter,可以不填,不填默认为Filter&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;p&gt;命令选项&lt;/p&gt;
&lt;p&gt; 选项名    功能及特点&lt;br&gt; -A    在指定链的末尾添加(–append)一条新的规则&lt;br&gt; -D    删除(–delete)指定链中的某一条规则,按规则序号或内容确定要删除的规则&lt;br&gt; -I    在指定链中插入(–insert)一条新的规则,默认在链的开头插入&lt;br&gt; -R    修改. 替换(–replace)指定链中的一条规则,按规则序号或内容确定&lt;br&gt; -L    列出(–list)指定链中的所有的规则进行查看,默认列出表中所有链的内容&lt;br&gt; -F    清空(–flush)指定链中的所有规则,默认清空表中所有链的内容&lt;br&gt; -N    新建(–new-chain)一条用户自己定义的规则链&lt;br&gt; -X    删除指定表中用户自定义的规则链(–delete-chain)&lt;br&gt; -P    设置指定链的默认策略(–policy)&lt;br&gt; -n    用数字形式(–numeric)显示输出结果,若显示主机的 IP地址而不是主机名&lt;br&gt; -P    设置指定链的默认策略(–policy)&lt;br&gt; -v    查看规则列表时显示详细(–verbose)的信息&lt;br&gt; -V    查看iptables命令工具的版本(–Version)信息&lt;br&gt; -h    查看命令帮助信息(–help)&lt;br&gt; –line-number    查看规则列表时,同时显示规则在链中的顺序号&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;链名&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;可以根据数据流向来确定具体使用哪个链,在Filter中的使用情况如下:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;INPUT链 – 处理来自外部的数据. 
OUTPUT链 – 处理向外发送的数据. 
FORWARD链 – 将数据转发到本机的其他网卡设备上.
&lt;/code&gt;&lt;/pre&gt;&lt;ol&gt;
&lt;li&gt;条件匹配&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;条件匹配分为基本匹配和扩展匹配,拓展匹配又分为隐式扩展和显示扩展.&lt;/p&gt;
&lt;p&gt;a)基本匹配包括:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;匹配参数    说明
-p    指定规则协议,如tcp, udp,icmp等,可以使用all来指定所有协议
-s    指定数据包的源地址参数,可以使IP地址. 网络地址. 主机名
-d    指定目的地址
-i    输入接口
-o    输出接口
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;b)隐式扩展包括:&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;../iptables/4.jpg&quot; alt=&quot;4.jpg&quot;&gt;&lt;/p&gt;
&lt;p&gt;c)常用显式扩展&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;../iptables/5.jpg&quot; alt=&quot;5.jpg&quot;&gt;&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;目标值&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;数据包控制方式包括四种为:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;ACCEPT:允许数据包通过. 
DROP:直接丢弃数据包,不给出任何回应信息. 
REJECT:拒绝数据包通过,必须时会给数据发送端一个响应信息. 
LOG:在/var/log/messages 文件中记录日志信息,然后将数据包传递给下一条规则. 
QUEUE:防火墙将数据包移交到用户空间 
RETURN:防火墙停止执行当前链中的后续Rules,并返回到调用链(the calling chain) 
0x05 Iptables常见命令
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;a) 1. 删除iptables现有规则&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;iptables –F&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;b) 2. 查看iptables规则&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;iptables –L(iptables –L –v -n)&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;c) 3. 增加一条规则到最后&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;iptables -A INPUT -i eth0 -p tcp --dport &lt;span class=&quot;number&quot;&gt;80&lt;/span&gt; -m state --state NEW,ESTABLISHED -j ACCEPT&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;d) 4.添加一条规则到指定位置&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;iptables -I INPUT &lt;span class=&quot;number&quot;&gt;2&lt;/span&gt; -i eth0 -p tcp --dport &lt;span class=&quot;number&quot;&gt;80&lt;/span&gt; -m state --state NEW,ESTABLISHED -j ACCEPT&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;e) 5.  删除一条规则&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;iptabels -D INPUT &lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;f) 6.修改一条规则&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;iptables -R INPUT &lt;span class=&quot;number&quot;&gt;3&lt;/span&gt; -i eth0 -p tcp --dport &lt;span class=&quot;number&quot;&gt;80&lt;/span&gt; -m state --state NEW,ESTABLISHED -j ACCEPT&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;g) 7. 设置默认策略&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;iptables -P INPUT DROP&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;h) 8.允许远程主机进行SSH连接&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;iptables -A INPUT -i eth0 -p tcp --dport &lt;span class=&quot;number&quot;&gt;22&lt;/span&gt; -m state --state NEW,ESTABLISHED -j ACCEPT &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;iptables -A OUTPUT -o eth0 -p tcp --sport &lt;span class=&quot;number&quot;&gt;22&lt;/span&gt; -m state --state ESTABLISHED -j ACCEPT&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;i) 9.允许本地主机进行SSH连接&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;iptables -A OUTPUT -o eth0 -p tcp --dport &lt;span class=&quot;number&quot;&gt;22&lt;/span&gt; -m state --state NEW,ESTABLISHED -j ACCEPT &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;iptables -A INTPUT -i eth0 -p tcp --sport &lt;span class=&quot;number&quot;&gt;22&lt;/span&gt; -m state --state ESTABLISHED -j ACCEPT&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;j) 10.允许HTTP请求&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;iptables -A INPUT -i eth0 -p tcp --dport &lt;span class=&quot;number&quot;&gt;80&lt;/span&gt; -m state --state NEW,ESTABLISHED -j ACCEPT &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;iptables -A OUTPUT -o eth0 -p tcp --sport &lt;span class=&quot;number&quot;&gt;80&lt;/span&gt; -m state --state ESTABLISHED -j ACCEPT&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;k) 11.限制ping 192.168.146.3主机的数据包数,平均2/s个,最多不能超过3个&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;iptables -A INPUT -i eth0 &lt;span class=&quot;operator&quot;&gt;-d&lt;/span&gt; &lt;span class=&quot;number&quot;&gt;192.168&lt;/span&gt;.&lt;span class=&quot;number&quot;&gt;146.3&lt;/span&gt; -p icmp --icmp-type &lt;span class=&quot;number&quot;&gt;8&lt;/span&gt; -m &lt;span class=&quot;built_in&quot;&gt;limit&lt;/span&gt; --limit &lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;/second --limit-burst &lt;span class=&quot;number&quot;&gt;3&lt;/span&gt; -j ACCEPT&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;l) 12.限制SSH连接速率(默认策略是DROP)&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;iptables -I INPUT &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt; -p tcp --dport &lt;span class=&quot;number&quot;&gt;22&lt;/span&gt; &lt;span class=&quot;operator&quot;&gt;-d&lt;/span&gt; &lt;span class=&quot;number&quot;&gt;192.168&lt;/span&gt;.&lt;span class=&quot;number&quot;&gt;146.3&lt;/span&gt; -m state --state ESTABLISHED -j ACCEPT  &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;iptables -I INPUT &lt;span class=&quot;number&quot;&gt;2&lt;/span&gt; -p tcp --dport &lt;span class=&quot;number&quot;&gt;22&lt;/span&gt; &lt;span class=&quot;operator&quot;&gt;-d&lt;/span&gt; &lt;span class=&quot;number&quot;&gt;192.168&lt;/span&gt;.&lt;span class=&quot;number&quot;&gt;146.3&lt;/span&gt; -m &lt;span class=&quot;built_in&quot;&gt;limit&lt;/span&gt; --limit &lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;/minute --limit-burst &lt;span class=&quot;number&quot;&gt;2&lt;/span&gt; -m state --state NEW -j ACCEPT&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;0x06 如何正确配置iptables&lt;/p&gt;
&lt;p&gt;a) 1. 删除现有规则&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;iptables -F&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;b) 2.  配置默认链策略&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;iptables -P INPUT DROP &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;iptables -P FORWARD DROP &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;iptables -P OUTPUT DROP&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;c) 3. 允许远程主机进行SSH连接&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;iptables -A INPUT -i eth0 -p tcp –dport &lt;span class=&quot;number&quot;&gt;22&lt;/span&gt; -m state –state NEW,ESTABLISHED -j ACCEPT &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;iptables -A OUTPUT -o eth0 -p tcp –sport &lt;span class=&quot;number&quot;&gt;22&lt;/span&gt; -m state –state ESTABLISHED -j ACCEPT&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;d) 4. 允许本地主机进行SSH连接&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;iptables -A OUTPUT -o eth0 -p tcp –dport &lt;span class=&quot;number&quot;&gt;22&lt;/span&gt; -m state –state NEW,ESTABLISHED -j ACCEPT &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;iptables -A INPUT -i eth0 -p tcp –sport &lt;span class=&quot;number&quot;&gt;22&lt;/span&gt; -m state –state ESTABLISHED -j ACCEPT&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;e) 5. 允许HTTP请求&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;iptables -A INPUT -i eth0 -p tcp –dport &lt;span class=&quot;number&quot;&gt;80&lt;/span&gt; -m state –state NEW,ESTABLISHED -j ACCEPT &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;iptables -A OUTPUT -o eth0 -p tcp –sport &lt;span class=&quot;number&quot;&gt;80&lt;/span&gt; -m state –state ESTABLISHED -j ACCEPT&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h3 id=&quot;使用iptables抵抗常见攻击&quot;&gt;&lt;a href=&quot;#使用iptables抵抗常见攻击&quot; class=&quot;headerlink&quot; title=&quot;使用iptables抵抗常见攻击&quot;&gt;&lt;/a&gt;使用iptables抵抗常见攻击&lt;/h3&gt;&lt;p&gt;1.防止syn攻击&lt;/p&gt;
&lt;p&gt;思路一:限制syn的请求速度(这个方式需要调节一个合理的速度值,不然会影响正常用户的请求)&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;iptables -N syn-flood &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;iptables -A INPUT -p tcp --syn -j syn-flood &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;iptables -A syn-flood -m &lt;span class=&quot;built_in&quot;&gt;limit&lt;/span&gt; --limit &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;/s --limit-burst &lt;span class=&quot;number&quot;&gt;4&lt;/span&gt; -j RETURN &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;iptables -A syn-flood -j DROP&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;思路二:限制单个ip的最大syn连接数&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;iptables –A INPUT –i eth0 –p tcp --syn -m connlimit --connlimit-above &lt;span class=&quot;number&quot;&gt;15&lt;/span&gt; -j DROP&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;ol&gt;
&lt;li&gt;防止DOS攻击&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;利用recent模块抵御DOS攻击&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;iptables -I INPUT -p tcp -dport &lt;span class=&quot;number&quot;&gt;22&lt;/span&gt; -m connlimit --connlimit-above &lt;span class=&quot;number&quot;&gt;3&lt;/span&gt; -j DROP&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;单个IP最多连接3个会话&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;iptables -I INPUT -p tcp --dport &lt;span class=&quot;number&quot;&gt;22&lt;/span&gt; -m state --state NEW -m recent --set --name SSH&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;只要是新的连接请求,就把它加入到SSH列表中&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;Iptables -I INPUT -p tcp --dport &lt;span class=&quot;number&quot;&gt;22&lt;/span&gt; -m state NEW -m recent --update --seconds &lt;span class=&quot;number&quot;&gt;300&lt;/span&gt; --hitcount &lt;span class=&quot;number&quot;&gt;3&lt;/span&gt; --name SSH -j DROP&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;5分钟内你的尝试次数达到3次,就拒绝提供SSH列表中的这个IP服务.被限制5分钟后即可恢复访问.&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;防止单个ip访问量过大&lt;/li&gt;
&lt;/ol&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;iptables -I INPUT -p tcp --dport &lt;span class=&quot;number&quot;&gt;80&lt;/span&gt; -m connlimit --connlimit-above &lt;span class=&quot;number&quot;&gt;30&lt;/span&gt; -j DROP&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;ol&gt;
&lt;li&gt;木马反弹&lt;/li&gt;
&lt;/ol&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;iptables –A OUTPUT –m state --state NEW –j DROP&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;ol&gt;
&lt;li&gt;防止ping攻击&lt;/li&gt;
&lt;/ol&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;iptables -A INPUT -p icmp --icmp-type &lt;span class=&quot;built_in&quot;&gt;echo&lt;/span&gt;-request -m &lt;span class=&quot;built_in&quot;&gt;limit&lt;/span&gt; --limit &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;/m -j ACCEPT&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;hr&gt;
&lt;h3 id=&quot;参考列表&quot;&gt;&lt;a href=&quot;#参考列表&quot; class=&quot;headerlink&quot; title=&quot;参考列表&quot;&gt;&lt;/a&gt;参考列表&lt;/h3&gt;&lt;p&gt;&lt;a href=&quot;http://drops.wooyun.org/tips/1424&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;Iptables入门教程&lt;/a&gt;&lt;br&gt;&lt;a href=&quot;https://wiki.vpsmm.com/iptables/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;Linux防火墙iptables基本应用&lt;/a&gt;&lt;br&gt;&lt;a href=&quot;https://wiki.vpsmm.com/iptables-ping-ddos/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;iptables之禁ping和ddos向外发包&lt;/a&gt;&lt;/p&gt;
</content>
    
    <summary type="html">
    
      &lt;h3 id=&quot;iptables入门教程&quot;&gt;&lt;a href=&quot;#iptables入门教程&quot; class=&quot;headerlink&quot; title=&quot;iptables入门教程&quot;&gt;&lt;/a&gt;iptables入门教程&lt;/h3&gt;
    
    </summary>
    
    
  </entry>
  
  <entry>
    <title>AndroidNDK</title>
    <link href="https://coam.co/2016/04/25/Android/AndroidNDK/"/>
    <id>https://coam.co/2016/04/25/Android/AndroidNDK/</id>
    <published>2016-04-25T02:08:31.000Z</published>
    <updated>2016-05-19T11:11:36.187Z</updated>
    
    <content type="html">&lt;a id=&quot;more&quot;&gt;&lt;/a&gt;
&lt;hr&gt;
&lt;hr&gt;
&lt;p&gt;### &lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;https://github.com/googlesamples/android-ndk&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;NDK官网示例 googlesamples/android-ndk&lt;/a&gt;&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id=&quot;CrystaX-NDK&quot;&gt;&lt;a href=&quot;#CrystaX-NDK&quot; class=&quot;headerlink&quot; title=&quot;CrystaX NDK&quot;&gt;&lt;/a&gt;CrystaX NDK&lt;/h3&gt;&lt;p&gt;&lt;a href=&quot;https://www.crystax.net/cn/blog/2&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;Boost + Android? CrystaX NDK!&lt;/a&gt;&lt;br&gt;&lt;a href=&quot;https://www.crystax.net/cn/blog/3&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;使用Android Studio构建基于NDK和Boost C++库的应用程序&lt;/a&gt;&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id=&quot;不错的-ndk-文章&quot;&gt;&lt;a href=&quot;#不错的-ndk-文章&quot; class=&quot;headerlink&quot; title=&quot;不错的 ndk 文章&quot;&gt;&lt;/a&gt;不错的 ndk 文章&lt;/h3&gt;&lt;p&gt;&lt;a href=&quot;http://www.jianshu.com/p/4ee5b5237b55&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;Android ndk入门学习&lt;/a&gt;&lt;br&gt;&lt;a href=&quot;http://blog.whyun.com/posts/jni-ndk/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;JNI系列教程三 —— NDK入门&lt;/a&gt;&lt;br&gt;&lt;a href=&quot;http://www.race604.com/android-studio-with-ndk/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;MENU Android Studio中NDK开发&lt;/a&gt;&lt;br&gt;&lt;a href=&quot;http://ph0b.com/android-studio-gradle-and-ndk-integration/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;Android Studio, gradle and NDK integration&lt;/a&gt;&lt;br&gt;&lt;a href=&quot;http://yanbober.github.io/2015/02/14/android_studio_jni_1/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;NDK-JNI实战教程(一) 在Android Studio运行第一个NDK程序&lt;/a&gt;&lt;br&gt;&lt;a href=&quot;http://yanbober.github.io/2015/02/16/android_studio_jni_2/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;NDK-JNI实战教程(二) JNI官方中文资料&lt;/a&gt;&lt;br&gt;&lt;a href=&quot;http://www.jianshu.com/p/d8cde65cb4f7&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;Android Studio ndk-Jni开发详细入门,Aes加密demo&lt;/a&gt;&lt;br&gt;&lt;a href=&quot;http://ph0b.com/new-android-studio-ndk-support/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;国外不错的文章-The new NDK support in Android Studio&lt;/a&gt;&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id=&quot;出现错误&quot;&gt;&lt;a href=&quot;#出现错误&quot; class=&quot;headerlink&quot; title=&quot;出现错误&quot;&gt;&lt;/a&gt;出现错误&lt;/h3&gt;&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt; /home/user5432/workspace/bitmapproj/obj/&lt;span class=&quot;built_in&quot;&gt;local&lt;/span&gt;/armeabi/objs-debug/mybitmap.o : In &lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt; Java_com_example_plasma_PlasmaView_renderPlasma&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;string&quot;&gt;&quot;undefined reference to AndroidBitmap_getInfo&quot;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;string&quot;&gt;&quot;undefined reference to AndroidBitmap_lockPixels&quot;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;string&quot;&gt;&quot;undefined reference to AndroidBitmap_unlockPixels&quot;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;gradle ndk 添加如下依赖&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;ndk &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    ldLibs &lt;span class=&quot;string&quot;&gt;&quot;log&quot;&lt;/span&gt;,&lt;span class=&quot;string&quot;&gt;&quot;android&quot;&lt;/span&gt;, &lt;span class=&quot;string&quot;&gt;&quot;jnigraphics&quot;&lt;/span&gt; // 引用依赖的 ndk 库 ldLibs = [&lt;span class=&quot;string&quot;&gt;&quot;android&quot;&lt;/span&gt;, &lt;span class=&quot;string&quot;&gt;&quot;jnigraphics&quot;&lt;/span&gt;, &amp;lt;other ndk libraries you might need&amp;gt;]&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;或 Android.mk 添加如下依赖&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;`LOCAL_LDFLAGS += -ljnigraphics`&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;参考&lt;br&gt;&lt;a href=&quot;http://stackoverflow.com/questions/4939266/android-bitmap-native-code-linking-problem&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;Android bitmap native code - linking problem&lt;/a&gt;&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id=&quot;出现-NEON-错误&quot;&gt;&lt;a href=&quot;#出现-NEON-错误&quot; class=&quot;headerlink&quot; title=&quot;出现 NEON 错误&quot;&gt;&lt;/a&gt;出现 NEON 错误&lt;/h3&gt;&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;Error:(&lt;span class=&quot;number&quot;&gt;31&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;) error: &lt;span class=&quot;comment&quot;&gt;#error You must enable NEON instructions (e.g. -mfloat-abi=softfp -mfpu=neon) to use arm_neon.h&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;&lt;a href=&quot;http://luofl1992.is-programmer.com/posts/38686.html&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;Android NDK(ARM开发)使用NEON优化&lt;/a&gt;&lt;br&gt;&lt;a href=&quot;http://blog.csdn.net/luofl1992/article/details/8759145&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;Android NDK使用NEON优化,SIMD优化&lt;/a&gt;&lt;br&gt;&lt;a href=&quot;http://dbro.pro/blog/2014/01/04/gradle-ndk.html&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;Gradle - neon&lt;/a&gt;&lt;br&gt;&lt;a href=&quot;http://stackoverflow.com/questions/34958125/how-do-i-enable-arm-neon-builds-using-gradle&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;How do I enable ARM NEON builds using Gradle?&lt;/a&gt;&lt;br&gt;&lt;a href=&quot;http://stackoverflow.com/questions/36277243/how-to-build-and-debug-native-code-c-with-neon-enabled-in-android-studio&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;How to build and debug native code (c) with neon enabled in android studio?&lt;/a&gt;&lt;br&gt;&lt;a href=&quot;http://developer.android.com/intl/es/ndk/guides/cpu-arm-neon.html#rd&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;Android-NDK _NEON Support&lt;/a&gt;&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id=&quot;error-Unknown-or-unsupported-ARM-architecture&quot;&gt;&lt;a href=&quot;#error-Unknown-or-unsupported-ARM-architecture&quot; class=&quot;headerlink&quot; title=&quot;error Unknown or unsupported ARM architecture&quot;&gt;&lt;/a&gt;error Unknown or unsupported ARM architecture&lt;/h3&gt;&lt;p&gt;&lt;a href=&quot;https://github.com/kivy/python-for-android/issues/455&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;[revamp] Android NDK API 21 issue #455&lt;/a&gt;&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;It would appear that at least as of Kitkat &lt;span class=&quot;number&quot;&gt;4.4&lt;/span&gt; (API &lt;span class=&quot;number&quot;&gt;19&lt;/span&gt;), ARM devices are required to be at least ARMv7a:&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;MUST report, via android.os.Build.CPU_ABI, only one of the ABIs listed below&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;* armeabi-v7a&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;* x86&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;* mips&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;It&lt;span class=&quot;string&quot;&gt;&#39;s not altogether surprising that the API to follow 19 (Lollipop API 21) would drop support for ARMv5 completely. From what I&#39;&lt;/span&gt;ve &lt;span class=&quot;built_in&quot;&gt;read&lt;/span&gt;, official builds of &lt;span class=&quot;number&quot;&gt;4.4&lt;/span&gt;+ are always ARMv7a, but there are some custom builds &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; certain devices &lt;span class=&quot;built_in&quot;&gt;which&lt;/span&gt; run ARMv6.&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;So the fix is to target a lower API or target the armeabi-v7a architecture. Switching to v7a fixed this problem &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; me.&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;blockquote&gt;
&lt;p&gt;我的错误信息大概是 android-23/…/cpu-feature.h 中的错误,可能是最新的 ndk 暂不支持 cpu-feature.h 的 armeabi 平台编译库吧, 去掉 abiFilters 中的 armeabi 编译选项即可&lt;/p&gt;
&lt;/blockquote&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;abiFilters &lt;span class=&quot;string&quot;&gt;&quot;armeabi-v7a&quot;&lt;/span&gt; , &lt;span class=&quot;string&quot;&gt;&quot;x86&quot;&lt;/span&gt;, &lt;span class=&quot;string&quot;&gt;&quot;mips&quot;&lt;/span&gt; //&lt;span class=&quot;string&quot;&gt;&quot;armeabi&quot;&lt;/span&gt;, &lt;span class=&quot;string&quot;&gt;&quot;armeabi-v7a&quot;&lt;/span&gt; , &lt;span class=&quot;string&quot;&gt;&quot;x86&quot;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;hr&gt;
&lt;h3 id=&quot;错误-Error-208-9-error-‘for’-loop-initial-declarations-are-only-allowed-in-C99-or-C11-mode&quot;&gt;&lt;a href=&quot;#错误-Error-208-9-error-‘for’-loop-initial-declarations-are-only-allowed-in-C99-or-C11-mode&quot; class=&quot;headerlink&quot; title=&quot;错误 Error:(208, 9) error: ‘for’ loop initial declarations are only allowed in C99 or C11 mode&quot;&gt;&lt;/a&gt;错误 Error:(208, 9) error: ‘for’ loop initial declarations are only allowed in C99 or C11 mode&lt;/h3&gt;&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;C:\Users\yafei\AppDeveloperWorkspace\CoamAndroid\app\src\main\jni\audio.c&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;Error:(&lt;span class=&quot;number&quot;&gt;208&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;9&lt;/span&gt;) error: &lt;span class=&quot;string&quot;&gt;&#39;for&#39;&lt;/span&gt; loop initial declarations are only allowed &lt;span class=&quot;keyword&quot;&gt;in&lt;/span&gt; C99 or C11 mode&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;Information:(&lt;span class=&quot;number&quot;&gt;208&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;9&lt;/span&gt;) use option -std=c99, -std=gnu99, -std=c11 or -std=gnu11 to compile your code&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;C:\Users\yafei\AppDeveloperWorkspace\CoamAndroid\app\src\main\jni\audio.c: In &lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&#39;Java_com_coam_ui_telegram_controller_TelegramMediaController_getWaveform2&#39;&lt;/span&gt;:&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;C:\Users\yafei\AppDeveloperWorkspace\CoamAndroid\app\src\main\jni\audio.c:&lt;span class=&quot;number&quot;&gt;692&lt;/span&gt;:&lt;span class=&quot;number&quot;&gt;5&lt;/span&gt;: error: &lt;span class=&quot;string&quot;&gt;&#39;for&#39;&lt;/span&gt; loop initial declarations are only allowed &lt;span class=&quot;keyword&quot;&gt;in&lt;/span&gt; C99 or C11 mode&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;&lt;a href=&quot;http://stackoverflow.com/questions/34698592/building-android-app-with-c&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;Building android app with C++&lt;/a&gt;&lt;br&gt;&lt;a href=&quot;http://stackoverflow.com/questions/24279249/gradle-building-issue&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;Gradle building issue&lt;/a&gt;&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id=&quot;Telegram-相关&quot;&gt;&lt;a href=&quot;#Telegram-相关&quot; class=&quot;headerlink&quot; title=&quot;Telegram 相关&quot;&gt;&lt;/a&gt;Telegram 相关&lt;/h3&gt;&lt;hr&gt;
&lt;h3 id=&quot;ogg-没有-config-types-h-错误&quot;&gt;&lt;a href=&quot;#ogg-没有-config-types-h-错误&quot; class=&quot;headerlink&quot; title=&quot;ogg 没有 config_types.h 错误&quot;&gt;&lt;/a&gt;ogg 没有 config_types.h 错误&lt;/h3&gt;&lt;p&gt;&lt;a href=&quot;https://github.com/xiph/ogg&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;xiph/ogg&lt;/a&gt;&lt;br&gt;添加文件 &lt;a href=&quot;https://github.com/GunioRobot/rtn56u/blob/a6824f903dd56c0325a19be342aeb4e7485239db/user/flac-1.2.1/source/include/ogg/config_types.h&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;rtn56u/user/flac-1.2.1/source/include/ogg/config_types.h&lt;/a&gt;&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id=&quot;cpu-feature-问题&quot;&gt;&lt;a href=&quot;#cpu-feature-问题&quot; class=&quot;headerlink&quot; title=&quot;cpu-feature 问题&quot;&gt;&lt;/a&gt;cpu-feature 问题&lt;/h3&gt;&lt;p&gt;&lt;a href=&quot;http://developer.android.com/intl/es/ndk/guides/cpu-features.html&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;The cpufeatures Library&lt;/a&gt;&lt;/p&gt;
&lt;hr&gt;
</content>
    
    <summary type="html">
    
      &lt;a id=&quot;more&quot;&gt;&lt;/a&gt;
&lt;hr&gt;
&lt;hr&gt;
&lt;p&gt;### &lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;https://github.com/googlesamples/android-ndk&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;NDK官网示例 goo
    
    </summary>
    
    
  </entry>
  
  <entry>
    <title>PhotoShop 设计笔记摘要</title>
    <link href="https://coam.co/2016/04/21/Design/PhotoShop/"/>
    <id>https://coam.co/2016/04/21/Design/PhotoShop/</id>
    <published>2016-04-21T02:31:31.000Z</published>
    <updated>2016-05-11T10:31:12.353Z</updated>
    
    <content type="html">&lt;p&gt; PhotoShop 设计笔记摘要&lt;/p&gt;
&lt;a id=&quot;more&quot;&gt;&lt;/a&gt;
&lt;h3 id=&quot;刚下载的-FlatIcon-png-icon-图标默认都是-黑色的-用-PhotoShop-修改PNG图标颜色为白色-背景仍透明&quot;&gt;&lt;a href=&quot;#刚下载的-FlatIcon-png-icon-图标默认都是-黑色的-用-PhotoShop-修改PNG图标颜色为白色-背景仍透明&quot; class=&quot;headerlink&quot; title=&quot;刚下载的 FlatIcon png icon 图标默认都是 黑色的,用 PhotoShop 修改PNG图标颜色为白色,背景仍透明&quot;&gt;&lt;/a&gt;刚下载的 FlatIcon png icon 图标默认都是 黑色的,用 PhotoShop 修改PNG图标颜色为白色,背景仍透明&lt;/h3&gt;&lt;blockquote&gt;
&lt;p&gt;菜单&amp;gt;&amp;gt;图层&amp;gt;&amp;gt;图层样式&amp;gt;&amp;gt;颜色叠加.你想什么颜色就选什么颜色&lt;/p&gt;
&lt;/blockquote&gt;
&lt;hr&gt;
&lt;h3 id=&quot;有时候感觉icon透明边距过小-需要增大icon图案的透明边距&quot;&gt;&lt;a href=&quot;#有时候感觉icon透明边距过小-需要增大icon图案的透明边距&quot; class=&quot;headerlink&quot; title=&quot;有时候感觉icon透明边距过小,需要增大icon图案的透明边距&quot;&gt;&lt;/a&gt;有时候感觉icon透明边距过小,需要增大icon图案的透明边距&lt;/h3&gt;&lt;blockquote&gt;
&lt;p&gt;菜单 &amp;gt;&amp;gt; 图像 &amp;gt;&amp;gt; 画布大小,即可调整 icon 边距&lt;/p&gt;
&lt;/blockquote&gt;
&lt;hr&gt;
</content>
    
    <summary type="html">
    
      &lt;p&gt; PhotoShop 设计笔记摘要&lt;/p&gt;
    
    </summary>
    
    
  </entry>
  
  <entry>
    <title>Enshrine收藏</title>
    <link href="https://coam.co/2016/04/15/Others/Enshrine/"/>
    <id>https://coam.co/2016/04/15/Others/Enshrine/</id>
    <published>2016-04-15T01:49:31.000Z</published>
    <updated>2016-05-11T10:32:04.997Z</updated>
    
    <content type="html">&lt;a id=&quot;more&quot;&gt;&lt;/a&gt;
&lt;p&gt;&lt;a href=&quot;http://news.gmw.cn/2016-04/14/content_19704438.htm&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;男人液体进入女人体内后发生的”化学反应”&lt;/a&gt;&lt;/p&gt;
</content>
    
    <summary type="html">
    
      &lt;a id=&quot;more&quot;&gt;&lt;/a&gt;
&lt;p&gt;&lt;a href=&quot;http://news.gmw.cn/2016-04/14/content_19704438.htm&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;男人液体进入女人体内后发生的”化学反应”&lt;/a&gt;&lt;/p
    
    </summary>
    
    
  </entry>
  
  <entry>
    <title>【脑洞大开】你看过这样的动态图吗?——太牛了！</title>
    <link href="https://coam.co/2016/04/03/Others/Imagine/"/>
    <id>https://coam.co/2016/04/03/Others/Imagine/</id>
    <published>2016-04-03T12:59:31.000Z</published>
    <updated>2016-05-16T14:23:33.857Z</updated>
    
    <content type="html">&lt;p&gt;&lt;a href=&quot;http://learning.sohu.com/20160401/n443068703.shtml&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;【脑洞大开】你看过这样的动态图吗?——太牛了！&lt;/a&gt;&lt;/p&gt;
&lt;a id=&quot;more&quot;&gt;&lt;/a&gt;
&lt;h4 id=&quot;飞机的星形发动机&quot;&gt;&lt;a href=&quot;#飞机的星形发动机&quot; class=&quot;headerlink&quot; title=&quot;飞机的星形发动机&quot;&gt;&lt;/a&gt;飞机的星形发动机&lt;/h4&gt;&lt;p&gt;&lt;a href=&quot;images/imagine/1.jpg&quot;&gt;飞机的星形发动机&lt;/a&gt;&lt;/p&gt;
&lt;hr&gt;
&lt;h4 id=&quot;椭圆规&quot;&gt;&lt;a href=&quot;#椭圆规&quot; class=&quot;headerlink&quot; title=&quot;椭圆规&quot;&gt;&lt;/a&gt;椭圆规&lt;/h4&gt;&lt;p&gt;&lt;a href=&quot;images/imagine/2.jpg&quot;&gt;椭圆规&lt;/a&gt;&lt;/p&gt;
&lt;hr&gt;
&lt;h4 id=&quot;缝纫机&quot;&gt;&lt;a href=&quot;#缝纫机&quot; class=&quot;headerlink&quot; title=&quot;缝纫机&quot;&gt;&lt;/a&gt;缝纫机&lt;/h4&gt;&lt;p&gt;&lt;a href=&quot;images/imagine/3.jpg&quot;&gt;缝纫机&lt;/a&gt;&lt;/p&gt;
&lt;hr&gt;
&lt;h4 id=&quot;马耳他十字机芯——用于控制时钟的秒针运动&quot;&gt;&lt;a href=&quot;#马耳他十字机芯——用于控制时钟的秒针运动&quot; class=&quot;headerlink&quot; title=&quot;马耳他十字机芯——用于控制时钟的秒针运动&quot;&gt;&lt;/a&gt;马耳他十字机芯——用于控制时钟的秒针运动&lt;/h4&gt;&lt;p&gt;&lt;a href=&quot;images/imagine/4.jpg&quot;&gt;马耳他十字机芯——用于控制时钟的秒针运动&lt;/a&gt;&lt;/p&gt;
&lt;hr&gt;
&lt;h4 id=&quot;舰炮弹药装填系统&quot;&gt;&lt;a href=&quot;#舰炮弹药装填系统&quot; class=&quot;headerlink&quot; title=&quot;舰炮弹药装填系统&quot;&gt;&lt;/a&gt;舰炮弹药装填系统&lt;/h4&gt;&lt;p&gt;&lt;a href=&quot;images/imagine/5.jpg&quot;&gt;舰炮弹药装填系统&lt;/a&gt;&lt;/p&gt;
&lt;hr&gt;
&lt;h4 id=&quot;转子发动机——内燃机的一种-把热能转为旋转运动而非活塞运动-如马自达RX8&quot;&gt;&lt;a href=&quot;#转子发动机——内燃机的一种-把热能转为旋转运动而非活塞运动-如马自达RX8&quot; class=&quot;headerlink&quot; title=&quot;转子发动机——内燃机的一种,把热能转为旋转运动而非活塞运动,如马自达RX8&quot;&gt;&lt;/a&gt;转子发动机——内燃机的一种,把热能转为旋转运动而非活塞运动,如马自达RX8&lt;/h4&gt;&lt;p&gt;&lt;a href=&quot;images/imagine/6.jpg&quot;&gt;转子发动机——内燃机的一种,把热能转为旋转运动而非活塞运动,如马自达RX8&lt;/a&gt;&lt;/p&gt;
&lt;hr&gt;
&lt;h4 id=&quot;直列式发动机——它的汽缸肩并肩地排成一排-L4发动机-一般的车都用&quot;&gt;&lt;a href=&quot;#直列式发动机——它的汽缸肩并肩地排成一排-L4发动机-一般的车都用&quot; class=&quot;headerlink&quot; title=&quot;直列式发动机——它的汽缸肩并肩地排成一排,L4发动机,一般的车都用&quot;&gt;&lt;/a&gt;直列式发动机——它的汽缸肩并肩地排成一排,L4发动机,一般的车都用&lt;/h4&gt;&lt;p&gt;&lt;a href=&quot;images/imagine/7.jpg&quot;&gt;直列式发动机——它的汽缸肩并肩地排成一排,L4发动机,一般的车都用&lt;/a&gt;&lt;/p&gt;
&lt;hr&gt;
&lt;h4 id=&quot;V-型发动机——汽缸排列在成一定角度的两个平面上-V6发动机&quot;&gt;&lt;a href=&quot;#V-型发动机——汽缸排列在成一定角度的两个平面上-V6发动机&quot; class=&quot;headerlink&quot; title=&quot;V 型发动机——汽缸排列在成一定角度的两个平面上,V6发动机&quot;&gt;&lt;/a&gt;V 型发动机——汽缸排列在成一定角度的两个平面上,V6发动机&lt;/h4&gt;&lt;p&gt;&lt;a href=&quot;images/imagine/8.jpg&quot;&gt;V 型发动机——汽缸排列在成一定角度的两个平面上,V6发动机&lt;/a&gt;&lt;/p&gt;
&lt;hr&gt;
&lt;h4 id=&quot;水平对置式发动机-——汽缸排列在发动机相对的两个平面上-保时捷911用的是这种的6缸&quot;&gt;&lt;a href=&quot;#水平对置式发动机-——汽缸排列在发动机相对的两个平面上-保时捷911用的是这种的6缸&quot; class=&quot;headerlink&quot; title=&quot;水平对置式发动机 ——汽缸排列在发动机相对的两个平面上,保时捷911用的是这种的6缸&quot;&gt;&lt;/a&gt;水平对置式发动机 ——汽缸排列在发动机相对的两个平面上,保时捷911用的是这种的6缸&lt;/h4&gt;&lt;p&gt;&lt;a href=&quot;images/imagine/9.jpg&quot;&gt;水平对置式发动机 ——汽缸排列在发动机相对的两个平面上,保时捷911用的是这种的6缸&lt;/a&gt;&lt;/p&gt;
&lt;hr&gt;
&lt;h4 id=&quot;汽车等速万向节&quot;&gt;&lt;a href=&quot;#汽车等速万向节&quot; class=&quot;headerlink&quot; title=&quot;汽车等速万向节&quot;&gt;&lt;/a&gt;汽车等速万向节&lt;/h4&gt;&lt;p&gt;&lt;a href=&quot;images/imagine/10.jpg&quot;&gt;汽车等速万向节&lt;/a&gt;&lt;/p&gt;
&lt;hr&gt;
</content>
    
    <summary type="html">
    
      【脑洞大开】你看过这样的动态图吗?——太牛了！
    
    </summary>
    
    
  </entry>
  
  <entry>
    <title>Linux.bashrc</title>
    <link href="https://coam.co/2016/02/26/Linux/Linux.bashrc/"/>
    <id>https://coam.co/2016/02/26/Linux/Linux.bashrc/</id>
    <published>2016-02-26T03:52:31.000Z</published>
    <updated>2016-05-11T10:31:12.527Z</updated>
    
    <content type="html">&lt;a id=&quot;more&quot;&gt;&lt;/a&gt;
&lt;h3 id=&quot;环境变量&quot;&gt;&lt;a href=&quot;#环境变量&quot; class=&quot;headerlink&quot; title=&quot;环境变量&quot;&gt;&lt;/a&gt;环境变量&lt;/h3&gt;&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# Erlang&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# export PATH=/opt/otp/bin:$PATH&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;hr&gt;
&lt;h3 id=&quot;Ubuntu-终端颜色显示-PS1-bash-输出文本颜色配置&quot;&gt;&lt;a href=&quot;#Ubuntu-终端颜色显示-PS1-bash-输出文本颜色配置&quot; class=&quot;headerlink&quot; title=&quot;Ubuntu 终端颜色显示 PS1 bash 输出文本颜色配置&quot;&gt;&lt;/a&gt;Ubuntu 终端颜色显示 PS1 bash 输出文本颜色配置&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;&lt;p&gt;突然发现终端文件不高亮显示,可以修改 .bashrc 文件来调节&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;将以下加入到 .bashrc 的最后&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;PS1=&lt;span class=&quot;string&quot;&gt;&#39;\[\e[1;36m\]\d \[\e[1;32m\]\t \[\e[1;33m\]\u@\[\e[1;35m\]\h:\w\$\[\e[0;31m\] &#39;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h1 id=&quot;退出终端重新登陆或执行以下命令可看到效果&quot;&gt;&lt;a href=&quot;#退出终端重新登陆或执行以下命令可看到效果&quot; class=&quot;headerlink&quot; title=&quot;退出终端重新登陆或执行以下命令可看到效果&quot;&gt;&lt;/a&gt;退出终端重新登陆或执行以下命令可看到效果&lt;/h1&gt;&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;built_in&quot;&gt;source&lt;/span&gt; .bashrc&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;其它的一些参考的色彩设置:&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;$ PS1=&lt;span class=&quot;string&quot;&gt;&#39;\[\e[1;34m\][\d \t \u@\h \w]\$\[\e[m\] &#39;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;$ PS1=&lt;span class=&quot;string&quot;&gt;&#39;\[\e[1;36m\]\d \[\e[1;32m\]\t \[\e[1;33m\]\u@\[\e[1;35m\]\h:\w\$\[\e[0;31m\] &#39;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;$ PS1=&lt;span class=&quot;string&quot;&gt;&#39;\[\e[1;33m\]\u@\h \w -&amp;gt;\n\[\e[1;36m\] \@ \d\$\[\e[m\] &#39;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;$ PS1=&lt;span class=&quot;string&quot;&gt;&quot;[\[\e[0;32m\]\u@\h, load: `cat /proc/loadavg | awk &#39;&amp;#123; print &lt;span class=&quot;variable&quot;&gt;$1&lt;/span&gt;; &amp;#125;&#39;`\[\e[00m\]] (\[\e[00;35m\]\d - \t\[\e[00m\])\n\w \$ &quot;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;$ PS1=&lt;span class=&quot;string&quot;&gt;&quot;[\u@\h, load: `cat /proc/loadavg | awk &#39;&amp;#123; print &lt;span class=&quot;variable&quot;&gt;$1&lt;/span&gt;; &amp;#125;&#39;`] (\d - \t)\n\w \$ &quot;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;$ PS1=&lt;span class=&quot;string&quot;&gt;&quot;&lt;span class=&quot;variable&quot;&gt;$HC&lt;/span&gt;&lt;span class=&quot;variable&quot;&gt;$FYEL&lt;/span&gt;[ &lt;span class=&quot;variable&quot;&gt;$FBLE&lt;/span&gt;&lt;span class=&quot;variable&quot;&gt;$&amp;#123;debian_chroot:+($debian_chroot)&amp;#125;&lt;/span&gt;\u&lt;span class=&quot;variable&quot;&gt;$FYEL&lt;/span&gt;: &lt;span class=&quot;variable&quot;&gt;$FBLE&lt;/span&gt;\w &lt;span class=&quot;variable&quot;&gt;$FYEL&lt;/span&gt;]\\$ &lt;span class=&quot;variable&quot;&gt;$RS&lt;/span&gt;&quot;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;$ PS2=&lt;span class=&quot;string&quot;&gt;&quot;&lt;span class=&quot;variable&quot;&gt;$HC&lt;/span&gt;&lt;span class=&quot;variable&quot;&gt;$FYEL&lt;/span&gt;&amp;amp;gt; &lt;span class=&quot;variable&quot;&gt;$RS&lt;/span&gt;&quot;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h3 id=&quot;当前服务器配置&quot;&gt;&lt;a href=&quot;#当前服务器配置&quot; class=&quot;headerlink&quot; title=&quot;当前服务器配置&quot;&gt;&lt;/a&gt;当前服务器配置&lt;/h3&gt;&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# Terminate HighLight&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;#PS1=&#39;$&amp;#123;debian_chroot:+($debian_chroot)&amp;#125;\[\033[01;35;40m\]\u\[\033[00;00;40m\]@\[\033[01;35;40m\]\h\[\033[00;31;40m\]:\[\033[00;00;40m\]\w \[\033[01;32;40m\]\$ \[\033[01;36;40m\]&#39;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;#PS1=&quot;$HC$FYEL[ $FBLE$&amp;#123;debian_chroot:+($debian_chroot)&amp;#125;\u$FYEL: $FBLE\w $FYEL]\\$ $RS&quot;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;#PS2=&quot;$HC$FYEL&amp;amp;gt; $RS&quot;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;#PS1=&#39;\[\e[1;33m\]\u@\h \w -&amp;gt;\n\[\e[1;36m\] \@ \d\$\[\e[m\] &#39;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;PS1=&lt;span class=&quot;string&quot;&gt;&#39;\[\e[1;36m\]\d \[\e[1;32m\]\t \[\e[1;33m\]\u@\[\e[1;35m\]\h:\w\$\[\e[0;37m\] &#39;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h3 id=&quot;其中配置项&quot;&gt;&lt;a href=&quot;#其中配置项&quot; class=&quot;headerlink&quot; title=&quot;其中配置项&quot;&gt;&lt;/a&gt;其中配置项&lt;/h3&gt;&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;PS1=&lt;span class=&quot;string&quot;&gt;&#39;\[\e[1;36m\]\d \[\e[1;32m\]\t \[\e[1;33m\]\u@\[\e[1;35m\]\h:\w\$\[\e[0;37m\] &#39;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h3 id=&quot;显示效果为&quot;&gt;&lt;a href=&quot;#显示效果为&quot; class=&quot;headerlink&quot; title=&quot;显示效果为&quot;&gt;&lt;/a&gt;显示效果为&lt;/h3&gt;&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;Fri Feb &lt;span class=&quot;number&quot;&gt;26&lt;/span&gt; &lt;span class=&quot;number&quot;&gt;11&lt;/span&gt;:&lt;span class=&quot;number&quot;&gt;55&lt;/span&gt;:&lt;span class=&quot;number&quot;&gt;20&lt;/span&gt; yzhang@coam:~$&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h4 id=&quot;Linux-PS1-配置对应表&quot;&gt;&lt;a href=&quot;#Linux-PS1-配置对应表&quot; class=&quot;headerlink&quot; title=&quot;Linux PS1 配置对应表&quot;&gt;&lt;/a&gt;Linux PS1 配置对应表&lt;/h4&gt;&lt;figure class=&quot;highlight ini&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;21&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# ANSI color codes&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;setting&quot;&gt;RS=&lt;span class=&quot;value&quot;&gt;&lt;span class=&quot;string&quot;&gt;&quot;\[\033[0m\]&quot;&lt;/span&gt;    # reset&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;setting&quot;&gt;HC=&lt;span class=&quot;value&quot;&gt;&lt;span class=&quot;string&quot;&gt;&quot;\[\033[1m\]&quot;&lt;/span&gt;    # hicolor&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;setting&quot;&gt;UL=&lt;span class=&quot;value&quot;&gt;&lt;span class=&quot;string&quot;&gt;&quot;\[\033[4m\]&quot;&lt;/span&gt;    # underline&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;setting&quot;&gt;INV=&lt;span class=&quot;value&quot;&gt;&lt;span class=&quot;string&quot;&gt;&quot;\[\033[7m\]&quot;&lt;/span&gt;   # inverse background and foreground&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;setting&quot;&gt;FBLK=&lt;span class=&quot;value&quot;&gt;&lt;span class=&quot;string&quot;&gt;&quot;\[\033[30m\]&quot;&lt;/span&gt; # foreground black&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;setting&quot;&gt;FRED=&lt;span class=&quot;value&quot;&gt;&lt;span class=&quot;string&quot;&gt;&quot;\[\033[31m\]&quot;&lt;/span&gt; # foreground red&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;setting&quot;&gt;FGRN=&lt;span class=&quot;value&quot;&gt;&lt;span class=&quot;string&quot;&gt;&quot;\[\033[32m\]&quot;&lt;/span&gt; # foreground green&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;setting&quot;&gt;FYEL=&lt;span class=&quot;value&quot;&gt;&lt;span class=&quot;string&quot;&gt;&quot;\[\033[33m\]&quot;&lt;/span&gt; # foreground yellow&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;setting&quot;&gt;FBLE=&lt;span class=&quot;value&quot;&gt;&lt;span class=&quot;string&quot;&gt;&quot;\[\033[34m\]&quot;&lt;/span&gt; # foreground blue&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;setting&quot;&gt;FMAG=&lt;span class=&quot;value&quot;&gt;&lt;span class=&quot;string&quot;&gt;&quot;\[\033[35m\]&quot;&lt;/span&gt; # foreground magenta&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;setting&quot;&gt;FCYN=&lt;span class=&quot;value&quot;&gt;&lt;span class=&quot;string&quot;&gt;&quot;\[\033[36m\]&quot;&lt;/span&gt; # foreground cyan&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;setting&quot;&gt;FWHT=&lt;span class=&quot;value&quot;&gt;&lt;span class=&quot;string&quot;&gt;&quot;\[\033[37m\]&quot;&lt;/span&gt; # foreground white&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;setting&quot;&gt;BBLK=&lt;span class=&quot;value&quot;&gt;&lt;span class=&quot;string&quot;&gt;&quot;\[\033[40m\]&quot;&lt;/span&gt; # background black&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;setting&quot;&gt;BRED=&lt;span class=&quot;value&quot;&gt;&lt;span class=&quot;string&quot;&gt;&quot;\[\033[41m\]&quot;&lt;/span&gt; # background red&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;setting&quot;&gt;BGRN=&lt;span class=&quot;value&quot;&gt;&lt;span class=&quot;string&quot;&gt;&quot;\[\033[42m\]&quot;&lt;/span&gt; # background green&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;setting&quot;&gt;BYEL=&lt;span class=&quot;value&quot;&gt;&lt;span class=&quot;string&quot;&gt;&quot;\[\033[43m\]&quot;&lt;/span&gt; # background yellow&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;setting&quot;&gt;BBLE=&lt;span class=&quot;value&quot;&gt;&lt;span class=&quot;string&quot;&gt;&quot;\[\033[44m\]&quot;&lt;/span&gt; # background blue&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;setting&quot;&gt;BMAG=&lt;span class=&quot;value&quot;&gt;&lt;span class=&quot;string&quot;&gt;&quot;\[\033[45m\]&quot;&lt;/span&gt; # background magenta&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;setting&quot;&gt;BCYN=&lt;span class=&quot;value&quot;&gt;&lt;span class=&quot;string&quot;&gt;&quot;\[\033[46m\]&quot;&lt;/span&gt; # background cyan&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;setting&quot;&gt;BWHT=&lt;span class=&quot;value&quot;&gt;&lt;span class=&quot;string&quot;&gt;&quot;\[\033[47m\]&quot;&lt;/span&gt; # background white&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;ul&gt;
&lt;li&gt;注:每种颜色都有两种,分别以 3&lt;em&gt; 和 4&lt;/em&gt; 开头的数字配置,3&lt;em&gt; 表示文字颜色,4&lt;/em&gt; 表示背景颜色&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;a href=&quot;https://help.ubuntu.com/community/CustomizingBashPrompt&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;CustomizingBashPrompt&lt;/a&gt;&lt;br&gt;&lt;a href=&quot;http://bashrcgenerator.com/#minidoc&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;http://bashrcgenerator.com/#minidoc&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;https://www.digitalocean.com/community/tutorials/how-to-customize-your-bash-prompt-on-a-linux-vps&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;How to Customize your Bash Prompt on a Linux VPS&lt;/a&gt;&lt;br&gt;&lt;a href=&quot;https://www.linux.com/learn/tutorials/772396-how-to-make-a-fancy-and-useful-bash-prompt-in-linux-&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;How to Make a Fancy and Useful Bash Prompt in Linux&lt;/a&gt;&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id=&quot;使用-Putty-客户端登陆后显示对应的服务器ip名称&quot;&gt;&lt;a href=&quot;#使用-Putty-客户端登陆后显示对应的服务器ip名称&quot; class=&quot;headerlink&quot; title=&quot;使用 Putty 客户端登陆后显示对应的服务器ip名称&quot;&gt;&lt;/a&gt;使用 Putty 客户端登陆后显示对应的服务器ip名称&lt;/h3&gt;&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# Auto add env parameter $PROMPT_COMMAND when use non-Linux tty login by ssh.&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# 让 putty 登陆的标题栏显示对应服务器 IP&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; [ &lt;span class=&quot;string&quot;&gt;&quot;&lt;span class=&quot;variable&quot;&gt;$SSH_CONNECTION&lt;/span&gt;&quot;&lt;/span&gt; != &lt;span class=&quot;string&quot;&gt;&#39;&#39;&lt;/span&gt; &lt;span class=&quot;operator&quot;&gt;-a&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&quot;&lt;span class=&quot;variable&quot;&gt;$TERM&lt;/span&gt;&quot;&lt;/span&gt; != &lt;span class=&quot;string&quot;&gt;&#39;linux&#39;&lt;/span&gt; ]; &lt;span class=&quot;keyword&quot;&gt;then&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;built_in&quot;&gt;declare&lt;/span&gt; &lt;span class=&quot;operator&quot;&gt;-a&lt;/span&gt; HOSTIP&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    HOSTIP=`&lt;span class=&quot;built_in&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;variable&quot;&gt;$SSH_CONNECTION&lt;/span&gt; |awk &lt;span class=&quot;string&quot;&gt;&#39;&amp;#123;print $3&amp;#125;&#39;&lt;/span&gt;`&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;built_in&quot;&gt;export&lt;/span&gt; PROMPT_COMMAND=&lt;span class=&quot;string&quot;&gt;&#39;echo -ne &quot;\033]0;$&amp;#123;USER&amp;#125;@$HOSTIP:[$&amp;#123;HOSTNAME%%.*&amp;#125;]:$&amp;#123;PWD/#$HOME/~&amp;#125; \007&quot;&#39;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;fi&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;hr&gt;
</content>
    
    <summary type="html">
    
      &lt;a id=&quot;more&quot;&gt;&lt;/a&gt;
&lt;h3 id=&quot;环境变量&quot;&gt;&lt;a href=&quot;#环境变量&quot; class=&quot;headerlink&quot; title=&quot;环境变量&quot;&gt;&lt;/a&gt;环境变量&lt;/h3&gt;&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td c
    
    </summary>
    
    
  </entry>
  
  <entry>
    <title>WinNote</title>
    <link href="https://coam.co/2016/02/24/WinScripts/WinNote/"/>
    <id>https://coam.co/2016/02/24/WinScripts/WinNote/</id>
    <published>2016-02-24T04:36:31.000Z</published>
    <updated>2016-05-16T14:12:46.508Z</updated>
    
    <content type="html">&lt;a id=&quot;more&quot;&gt;&lt;/a&gt;
&lt;h3 id=&quot;关于WINDOWS下-文件名过长-无法删除的解决办法&quot;&gt;&lt;a href=&quot;#关于WINDOWS下-文件名过长-无法删除的解决办法&quot; class=&quot;headerlink&quot; title=&quot;关于WINDOWS下,文件名过长,无法删除的解决办法&quot;&gt;&lt;/a&gt;关于WINDOWS下,文件名过长,无法删除的解决办法&lt;/h3&gt;&lt;p&gt;&lt;a href=&quot;http://icodeisky.lofter.com/post/3a5e8_2c8516&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;关于WINDOWS下,文件名过长,无法删除的解决办法&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;dir /x 这时候就会出现里面所有文件的列表,并且显示每个文件的缩短名(显示在文件大小和文件名之间)&lt;br&gt;然后输入del加上你要删除文件的短文件名.即可删除.&lt;br&gt;如果是删除文件夹,请使用RMDIR /S 文件夹名&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;dir /x &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;F:\BaiDuCloud\YS&amp;gt;dir /x&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; Volume &lt;span class=&quot;keyword&quot;&gt;in&lt;/span&gt; drive F has no label.&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; Volume Serial Number is &lt;span class=&quot;number&quot;&gt;0000&lt;/span&gt;-&lt;span class=&quot;number&quot;&gt;4823&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; Directory of F:\BaiDuCloud\YS&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;number&quot;&gt;02&lt;/span&gt;/&lt;span class=&quot;number&quot;&gt;24&lt;/span&gt;/&lt;span class=&quot;number&quot;&gt;2016&lt;/span&gt;  &lt;span class=&quot;number&quot;&gt;12&lt;/span&gt;:&lt;span class=&quot;number&quot;&gt;10&lt;/span&gt; PM    &amp;lt;DIR&amp;gt;                       .&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;number&quot;&gt;02&lt;/span&gt;/&lt;span class=&quot;number&quot;&gt;24&lt;/span&gt;/&lt;span class=&quot;number&quot;&gt;2016&lt;/span&gt;  &lt;span class=&quot;number&quot;&gt;12&lt;/span&gt;:&lt;span class=&quot;number&quot;&gt;10&lt;/span&gt; PM    &amp;lt;DIR&amp;gt;                       ..&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;number&quot;&gt;02&lt;/span&gt;/&lt;span class=&quot;number&quot;&gt;24&lt;/span&gt;/&lt;span class=&quot;number&quot;&gt;2016&lt;/span&gt;  &lt;span class=&quot;number&quot;&gt;12&lt;/span&gt;:&lt;span class=&quot;number&quot;&gt;31&lt;/span&gt; PM    &amp;lt;DIR&amp;gt;          COAMRU~&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;     CoamRunning&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;number&quot;&gt;02&lt;/span&gt;/&lt;span class=&quot;number&quot;&gt;24&lt;/span&gt;/&lt;span class=&quot;number&quot;&gt;2016&lt;/span&gt;  &lt;span class=&quot;number&quot;&gt;12&lt;/span&gt;:&lt;span class=&quot;number&quot;&gt;08&lt;/span&gt; PM       &lt;span class=&quot;number&quot;&gt;600&lt;/span&gt;,&lt;span class=&quot;number&quot;&gt;910&lt;/span&gt;,&lt;span class=&quot;number&quot;&gt;847&lt;/span&gt; COAMRU~&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;.ZIP CoamRunning.zip&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;               &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt; File(s)    &lt;span class=&quot;number&quot;&gt;600&lt;/span&gt;,&lt;span class=&quot;number&quot;&gt;910&lt;/span&gt;,&lt;span class=&quot;number&quot;&gt;847&lt;/span&gt; bytes&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;               &lt;span class=&quot;number&quot;&gt;3&lt;/span&gt; Dir(s)  &lt;span class=&quot;number&quot;&gt;14&lt;/span&gt;,&lt;span class=&quot;number&quot;&gt;681&lt;/span&gt;,&lt;span class=&quot;number&quot;&gt;616&lt;/span&gt;,&lt;span class=&quot;number&quot;&gt;384&lt;/span&gt; bytes free&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;del COAMRU~&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;.ZIP&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;RMDIR /S COAMRU~&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;hr&gt;
&lt;h3 id=&quot;Window-下-默认使用微软账号登陆&quot;&gt;&lt;a href=&quot;#Window-下-默认使用微软账号登陆&quot; class=&quot;headerlink&quot; title=&quot;Window 下 默认使用微软账号登陆&quot;&gt;&lt;/a&gt;Window 下 默认使用微软账号登陆&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;Win+R 打开运行命令,输入 &lt;em&gt;control userpasswords2&lt;/em&gt; 打开”用户账户”管理界面&lt;/li&gt;
&lt;li&gt;取消【要使用本计算机,用户必须输入用户名和密码】的复选框,点击应用&lt;/li&gt;
&lt;li&gt;点击应用后出现【自动登录】窗口,默认用户名为当前电脑激活的用户账户名称&lt;/li&gt;
&lt;li&gt;此时在自动登录界面手动输入Microsoft账户及对应Microsoft账户的密码,点击确定即可&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;如此便可以实现微软账户自动登陆了&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;http://support1.lenovo.com.cn/lenovo/wsi/Modules/htmls/detail_20150803141441030.html&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;Windows 10如何设置Microsoft账户开机自动登录桌面&lt;/a&gt;&lt;/p&gt;
&lt;hr&gt;
</content>
    
    <summary type="html">
    
      &lt;a id=&quot;more&quot;&gt;&lt;/a&gt;
&lt;h3 id=&quot;关于WINDOWS下-文件名过长-无法删除的解决办法&quot;&gt;&lt;a href=&quot;#关于WINDOWS下-文件名过长-无法删除的解决办法&quot; class=&quot;headerlink&quot; title=&quot;关于WINDOWS下,文件名过长,无法删除的
    
    </summary>
    
    
  </entry>
  
  <entry>
    <title>ProGuard</title>
    <link href="https://coam.co/2016/02/21/Android/ProGuard/"/>
    <id>https://coam.co/2016/02/21/Android/ProGuard/</id>
    <published>2016-02-21T03:40:31.000Z</published>
    <updated>2016-05-16T14:12:46.347Z</updated>
    
    <content type="html">&lt;p&gt;&lt;a href=&quot;http://yuluoding.com/2016/01/14/Gradle-for-Android%E7%B3%BB%E5%88%97/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;关于Android Studio的Gradle 系列文章&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;https://github.com/shwenzhang/AndResGuard/blob/master/README.zh-cn.md&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;shwenzhang/AndResGuard&lt;/a&gt;&lt;br&gt;&lt;a href=&quot;http://www.salton123.com/2016/01/28/android%E6%B7%B7%E6%B7%86%E6%89%93%E5%8C%85%E6%94%BB%E7%95%A5%EF%BC%8C%E5%90%8C%E5%BE%AE%E4%BF%A1%E7%BA%A7%E5%88%AB%E6%93%8D%E4%BD%9C/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;Android混淆打包攻略,同微信级别操作&lt;/a&gt;&lt;/p&gt;
&lt;a id=&quot;more&quot;&gt;&lt;/a&gt;
&lt;h4 id=&quot;ProGuard-的输出文件及用处&quot;&gt;&lt;a href=&quot;#ProGuard-的输出文件及用处&quot; class=&quot;headerlink&quot; title=&quot;ProGuard 的输出文件及用处&quot;&gt;&lt;/a&gt;ProGuard 的输出文件及用处&lt;/h4&gt;&lt;blockquote&gt;
&lt;p&gt;混淆之后,会给我们输出一些文件,在gradle方式下是在 /build/proguard/ 目录下,ant是在 /bin/proguard 目录,eclipse构建在 /proguard 目录像. &lt;/p&gt;
&lt;/blockquote&gt;
&lt;figure class=&quot;highlight tex&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;C:&lt;span class=&quot;command&quot;&gt;\Users&lt;/span&gt;&lt;span class=&quot;command&quot;&gt;\yafei&lt;/span&gt;&lt;span class=&quot;command&quot;&gt;\DevelopWorkspace&lt;/span&gt;&lt;span class=&quot;command&quot;&gt;\StudioProjects&lt;/span&gt;&lt;span class=&quot;command&quot;&gt;\ShangYun&lt;/span&gt;&lt;span class=&quot;command&quot;&gt;\app&lt;/span&gt;&lt;span class=&quot;command&quot;&gt;\build&lt;/span&gt;&lt;span class=&quot;command&quot;&gt;\outputs&lt;/span&gt;&lt;span class=&quot;command&quot;&gt;\mapping&lt;/span&gt;&lt;span class=&quot;command&quot;&gt;\dev&lt;/span&gt;&lt;span class=&quot;command&quot;&gt;\release&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;分别有以下文件:&lt;/p&gt;
&lt;figure class=&quot;highlight stylus&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;dump&lt;span class=&quot;class&quot;&gt;.txt&lt;/span&gt; 描述apk文件中所有类文件间的内部结构.&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;mapping&lt;span class=&quot;class&quot;&gt;.txt&lt;/span&gt; 列出了原始的类,方法,和字段名与混淆后代码之间的映射.&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;seeds&lt;span class=&quot;class&quot;&gt;.txt&lt;/span&gt; 列出了未被混淆的类和成员&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;usage&lt;span class=&quot;class&quot;&gt;.txt&lt;/span&gt; 列出了从apk中删除的代码&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;当我们发布的release版本的程序出现bug时,可以通过以上文件(特别时mapping.txt)文件找到错误原始的位置,进行bug修改.同时,可能一开始的proguard配置有错误,也可以通过错误日志,根据这些文件,找到哪些文件不应该混淆,从而修改proguard的配置.&lt;/p&gt;
&lt;h4 id=&quot;Proguard-一些其它问题&quot;&gt;&lt;a href=&quot;#Proguard-一些其它问题&quot; class=&quot;headerlink&quot; title=&quot;Proguard 一些其它问题&quot;&gt;&lt;/a&gt;Proguard 一些其它问题&lt;/h4&gt;&lt;blockquote&gt;
&lt;p&gt;开启 代码混淆&lt;/p&gt;
&lt;/blockquote&gt;
&lt;figure class=&quot;highlight nginx&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;title&quot;&gt;release&lt;/span&gt; &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;title&quot;&gt;minifyEnabled&lt;/span&gt; &lt;span class=&quot;built_in&quot;&gt;true&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;后报以下错误:&lt;/p&gt;
&lt;figure class=&quot;highlight sql&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;28&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;java.lang.RuntimeException: Unable to &lt;span class=&quot;operator&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;start&lt;/span&gt; activity ComponentInfo&amp;#123;com.coam.shangyun/com.coam.ui.menu.activity.CommonServiceCircleActivity&amp;#125;: android.&lt;span class=&quot;keyword&quot;&gt;view&lt;/span&gt;.InflateException: &lt;span class=&quot;built_in&quot;&gt;Binary&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;XML&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;file&lt;/span&gt; line #&lt;span class=&quot;number&quot;&gt;77&lt;/span&gt;: &lt;span class=&quot;keyword&quot;&gt;Error&lt;/span&gt; inflating &lt;span class=&quot;keyword&quot;&gt;class&lt;/span&gt; android.support.v7.widget.RecyclerView&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;at&lt;/span&gt; android.app.ActivityThread.performLaunchActivity(ActivityThread.&lt;span class=&quot;keyword&quot;&gt;java&lt;/span&gt;:&lt;span class=&quot;number&quot;&gt;2201&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;at&lt;/span&gt; android.app.ActivityThread.handleLaunchActivity(ActivityThread.&lt;span class=&quot;keyword&quot;&gt;java&lt;/span&gt;:&lt;span class=&quot;number&quot;&gt;2250&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;at&lt;/span&gt; android.app.ActivityThread.&lt;span class=&quot;keyword&quot;&gt;access&lt;/span&gt;$&lt;span class=&quot;number&quot;&gt;800&lt;/span&gt;(ActivityThread.&lt;span class=&quot;keyword&quot;&gt;java&lt;/span&gt;:&lt;span class=&quot;number&quot;&gt;141&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;at&lt;/span&gt; android.app.ActivityThread$H.handleMessage(ActivityThread.&lt;span class=&quot;keyword&quot;&gt;java&lt;/span&gt;:&lt;span class=&quot;number&quot;&gt;1213&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;at&lt;/span&gt; android.os.&lt;span class=&quot;keyword&quot;&gt;Handler&lt;/span&gt;.dispatchMessage(&lt;span class=&quot;keyword&quot;&gt;Handler&lt;/span&gt;.&lt;span class=&quot;keyword&quot;&gt;java&lt;/span&gt;:&lt;span class=&quot;number&quot;&gt;102&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;at&lt;/span&gt; android.os.Looper.&lt;span class=&quot;keyword&quot;&gt;loop&lt;/span&gt;(Looper.&lt;span class=&quot;keyword&quot;&gt;java&lt;/span&gt;:&lt;span class=&quot;number&quot;&gt;136&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;at&lt;/span&gt; android.app.ActivityThread.&lt;span class=&quot;keyword&quot;&gt;main&lt;/span&gt;(ActivityThread.&lt;span class=&quot;keyword&quot;&gt;java&lt;/span&gt;:&lt;span class=&quot;number&quot;&gt;5065&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;at&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;java&lt;/span&gt;.lang.reflect.Method.invokeNative(&lt;span class=&quot;keyword&quot;&gt;Native&lt;/span&gt; Method)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;at&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;java&lt;/span&gt;.lang.reflect.Method.invoke(Method.&lt;span class=&quot;keyword&quot;&gt;java&lt;/span&gt;:&lt;span class=&quot;number&quot;&gt;515&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;at&lt;/span&gt; com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.&lt;span class=&quot;keyword&quot;&gt;java&lt;/span&gt;:&lt;span class=&quot;number&quot;&gt;793&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;at&lt;/span&gt; com.android.internal.os.ZygoteInit.&lt;span class=&quot;keyword&quot;&gt;main&lt;/span&gt;(ZygoteInit.&lt;span class=&quot;keyword&quot;&gt;java&lt;/span&gt;:&lt;span class=&quot;number&quot;&gt;609&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;at&lt;/span&gt; dalvik.&lt;span class=&quot;keyword&quot;&gt;system&lt;/span&gt;.NativeStart.&lt;span class=&quot;keyword&quot;&gt;main&lt;/span&gt;(&lt;span class=&quot;keyword&quot;&gt;Native&lt;/span&gt; Method)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;Caused &lt;span class=&quot;keyword&quot;&gt;by&lt;/span&gt;: android.&lt;span class=&quot;keyword&quot;&gt;view&lt;/span&gt;.InflateException: &lt;span class=&quot;built_in&quot;&gt;Binary&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;XML&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;file&lt;/span&gt; line #&lt;span class=&quot;number&quot;&gt;77&lt;/span&gt;: &lt;span class=&quot;keyword&quot;&gt;Error&lt;/span&gt; inflating &lt;span class=&quot;keyword&quot;&gt;class&lt;/span&gt; android.support.v7.widget.RecyclerView&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;at&lt;/span&gt; android.&lt;span class=&quot;keyword&quot;&gt;view&lt;/span&gt;.LayoutInflater.createView(LayoutInflater.&lt;span class=&quot;keyword&quot;&gt;java&lt;/span&gt;:&lt;span class=&quot;number&quot;&gt;623&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;at&lt;/span&gt; android.&lt;span class=&quot;keyword&quot;&gt;view&lt;/span&gt;.LayoutInflater.createViewFromTag(LayoutInflater.&lt;span class=&quot;keyword&quot;&gt;java&lt;/span&gt;:&lt;span class=&quot;number&quot;&gt;699&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;at&lt;/span&gt; android.&lt;span class=&quot;keyword&quot;&gt;view&lt;/span&gt;.LayoutInflater.rInflate(LayoutInflater.&lt;span class=&quot;keyword&quot;&gt;java&lt;/span&gt;:&lt;span class=&quot;number&quot;&gt;758&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;at&lt;/span&gt; android.&lt;span class=&quot;keyword&quot;&gt;view&lt;/span&gt;.LayoutInflater.rInflate(LayoutInflater.&lt;span class=&quot;keyword&quot;&gt;java&lt;/span&gt;:&lt;span class=&quot;number&quot;&gt;761&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;at&lt;/span&gt; android.&lt;span class=&quot;keyword&quot;&gt;view&lt;/span&gt;.LayoutInflater.inflate(LayoutInflater.&lt;span class=&quot;keyword&quot;&gt;java&lt;/span&gt;:&lt;span class=&quot;number&quot;&gt;495&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;at&lt;/span&gt; android.&lt;span class=&quot;keyword&quot;&gt;view&lt;/span&gt;.LayoutInflater.inflate(LayoutInflater.&lt;span class=&quot;keyword&quot;&gt;java&lt;/span&gt;:&lt;span class=&quot;number&quot;&gt;400&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;at&lt;/span&gt; android.&lt;span class=&quot;keyword&quot;&gt;view&lt;/span&gt;.LayoutInflater.inflate(LayoutInflater.&lt;span class=&quot;keyword&quot;&gt;java&lt;/span&gt;:&lt;span class=&quot;number&quot;&gt;353&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;at&lt;/span&gt; android.support.v7.app.AppCompatDelegateImplV7.a(&lt;span class=&quot;keyword&quot;&gt;Unknown&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;Source&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;at&lt;/span&gt; android.support.v7.app.AppCompatActivity.setContentView(&lt;span class=&quot;keyword&quot;&gt;Unknown&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;Source&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;at&lt;/span&gt; com.coam.ui.menu.activity.CommonServiceCircleActivity.onCreate(&lt;span class=&quot;keyword&quot;&gt;Unknown&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;Source&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;at&lt;/span&gt; android.app.Activity.performCreate(Activity.&lt;span class=&quot;keyword&quot;&gt;java&lt;/span&gt;:&lt;span class=&quot;number&quot;&gt;5249&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;at&lt;/span&gt; android.app.Instrumentation.callActivityOnCreate(Instrumentation.&lt;span class=&quot;keyword&quot;&gt;java&lt;/span&gt;:&lt;span class=&quot;number&quot;&gt;1087&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;at&lt;/span&gt; android.app.ActivityThread.performLaunchActivity(ActivityThread.&lt;span class=&quot;keyword&quot;&gt;java&lt;/span&gt;:&lt;span class=&quot;number&quot;&gt;2165&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    ... &lt;span class=&quot;number&quot;&gt;11&lt;/span&gt; more&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;在 proguard-rules.pro 文件下添加如下代码解决错误:&lt;/p&gt;
&lt;figure class=&quot;highlight scala&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;-keep public &lt;span class=&quot;class&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;extends&lt;/span&gt;&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;android&lt;/span&gt;.&lt;span class=&quot;title&quot;&gt;support&lt;/span&gt;.&lt;span class=&quot;title&quot;&gt;v7&lt;/span&gt;.&lt;span class=&quot;title&quot;&gt;widget&lt;/span&gt;.&lt;span class=&quot;title&quot;&gt;RecyclerView$LayoutManager&lt;/span&gt; &amp;#123;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    public &amp;lt;init&amp;gt;(...);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;参考 &lt;a href=&quot;https://code.google.com/p/android/issues/detail?id=190250&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;Error inflating class android.support.design.widget.NavigationView in v23.1.0 if I use Proguard&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;注意,使用GSON. fastjson等JSON解析框架所生成的对象类,加入下面的混淆规则即可.假设com.coam.bean包下所有的类都是 JSON 解析生成对象的类&lt;/p&gt;
&lt;figure class=&quot;highlight actionscript&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;-keep &lt;span class=&quot;class&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;com&lt;/span&gt;.&lt;span class=&quot;title&quot;&gt;coam&lt;/span&gt;.&lt;span class=&quot;title&quot;&gt;bean&lt;/span&gt;.**&lt;/span&gt;&amp;#123;*;&amp;#125;&lt;span class=&quot;comment&quot;&gt;//不混淆所有的com.clock.bean包下的类和这些类的所有成员变量&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;-keep &lt;span class=&quot;class&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;com&lt;/span&gt;.&lt;span class=&quot;title&quot;&gt;coam&lt;/span&gt;.&lt;span class=&quot;title&quot;&gt;bean&lt;/span&gt;.&lt;span class=&quot;title&quot;&gt;CloudUploadState&lt;/span&gt;&lt;/span&gt;&amp;#123;*;&amp;#125; &lt;span class=&quot;comment&quot;&gt;// 在其他类中继承的类对象 CloudStorageUploadState 也要禁止代码混淆,否则解析数据失败&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;-keep &lt;span class=&quot;class&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;com&lt;/span&gt;.&lt;span class=&quot;title&quot;&gt;coam&lt;/span&gt;.&lt;span class=&quot;title&quot;&gt;api&lt;/span&gt;.&lt;span class=&quot;title&quot;&gt;bean&lt;/span&gt;.**&lt;/span&gt;&amp;#123;*;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;-keep &lt;span class=&quot;class&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;com&lt;/span&gt;.&lt;span class=&quot;title&quot;&gt;coam&lt;/span&gt;.&lt;span class=&quot;title&quot;&gt;api&lt;/span&gt;.&lt;span class=&quot;title&quot;&gt;model&lt;/span&gt;.**&lt;/span&gt;&amp;#123;*;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
</content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;a href=&quot;http://yuluoding.com/2016/01/14/Gradle-for-Android%E7%B3%BB%E5%88%97/&quot;&gt;关于Android Studio的Gradle 系列文章&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;https://github.com/shwenzhang/AndResGuard/blob/master/README.zh-cn.md&quot;&gt;shwenzhang/AndResGuard&lt;/a&gt;&lt;br&gt;&lt;a href=&quot;http://www.salton123.com/2016/01/28/android%E6%B7%B7%E6%B7%86%E6%89%93%E5%8C%85%E6%94%BB%E7%95%A5%EF%BC%8C%E5%90%8C%E5%BE%AE%E4%BF%A1%E7%BA%A7%E5%88%AB%E6%93%8D%E4%BD%9C/&quot;&gt;Android混淆打包攻略,同微信级别操作&lt;/a&gt;&lt;/p&gt;
    
    </summary>
    
    
  </entry>
  
</feed>
